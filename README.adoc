= Tulip
:sectnums:
:toc:

== Dependencies

Install Git and JDK21 before building Tulip from source.

=== Linux

Install SDKMAN from bash (https://sdkman.io)
----
$ curl -s "https://get.sdkman.io" | bash
----

----
$ source "$HOME/.sdkman/bin/sdkman-init.sh"
----

----
$ sdk version
----

Install `w3m` (Debian, Ubuntu) to display reports
----
$ sudo apt install w3m
----

=== MacOS

Install SDKMAN from zsh or bash (https://sdkman.io)
----
$ curl -s "https://get.sdkman.io" | bash
----

----
$ source "$HOME/.sdkman/bin/sdkman-init.sh"
----

----
$ sdk version
----

Install `w3m` (MacOS) to display reports
----
$ brew install w3m
----

=== Windows

Open a Windows PowerShell (PS) terminal (version 5.1 or later) and from the PS `C:\>` prompt, run:

.Step 1 - run Set-ExecutionPolicy
----
PS C:\> Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
----
.Step 2 - answer 'Y' when prompted to change the execution policy.
----
Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"): Y
PS C:\>
----

.Step 3 - run Invoke-RestMethod
----
PS C:\> Invoke-RestMethod -Uri https://get.scoop.sh | Invoke-Expression
----

.Step 4 - wait for the installation to finish
----
Initializing...
Downloading...
Extracting...
Creating shim...
Adding ~\scoop\shims to your path.
Scoop was installed successfully!
Type 'scoop help' for instructions.
PS C:\>
----

Install Git and Git-Bash

[source,cmd]
----
scoop install git
----

Install MS Java 21 (OpenJDK)
----
scoop bucket add java
----

----
scoop install microsoft21-jdk
----

(Optionally) Install WinGetUI (aka UniGetUI) to apply future updates to the installed applications
----
scoop bucket add extras
----
----
scoop install extras/wingetui
----

== Build from Source

=== Linux

----
git clone https://github.com/wfouche/Tulip.git
cd  Tulip
sdk env install
./go_bench.sh
----

=== MacOS

----
git clone https://github.com/wfouche/Tulip.git
cd  Tulip
sdk env install
go_bench.sh
----

=== Windows

----
git clone https://github.com/wfouche/Tulip.git
cd  Tulip
go_bench.cmd
----

== Example Benchmark Reports

=== HTTP API calls (fast remote system)

[source,text,options=nowrap]
----
Benchmark Report / Micro-benchmarks / 2024-08-30 09:03:24.045

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Init
    (u:16 t:2)  0                 0.049    32        0  653.061     0.0 ms   0.211 ms   0.9 ms 0.0 ms   5.3 ms   5.3 ms   30 09:03:23 1   1.0 34.4 ms 1.2 ms 0.0  12.2
                [0.start]         0:00:00  16        0  326.531     0.0 ms   0.369 ms   1.3 ms 0.1 ms   5.3 ms   5.3 ms   30 09:03:23 1   1.0 34.4 ms 1.2 ms 0.0  12.2
                [8.login]         0:00:00  16        0  326.531     0.0 ms   0.053 ms   0.1 ms 0.0 ms   0.4 ms   0.4 ms   30 09:03:23 1   1.0 34.4 ms 1.2 ms 0.0  12.2
                                  0:00:00  32        0  653.061     0.0 ms   0.211 ms   0.9 ms 0.0 ms   5.3 ms   5.3 ms   30 09:03:23 1   1.0 34.4 ms 1.2 ms 0.0  12.2

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Max TPS-a
    (u:16 t:2)  0                 30.0     40090177  0  1336339.233 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.3 ms   30 09:04:36 11  3.6 1.3 ms  0.0 ms 66.5 35.8
                1                 30.0     40128743  0  1337624.767 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:04:44 11  3.6 1.7 ms  0.0 ms 65.2 35.8
                2                 30.0     39625088  0  1320836.267 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:05:43 11  3.5 2.5 ms  0.0 ms 65.1 35.8
                [9.noop]          0:01:30  119844008 0  1331600.089 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.3 ms   30 09:04:36 11  3.6 2.5 ms  0.0 ms 66.5 35.8
                                  0:01:30  119844008 0  1331600.089 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.3 ms   30 09:04:36 11  3.6 2.5 ms  0.0 ms 66.5 35.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Max TPS-b
    (u:16 t:2)  0                 30.0     29999999  0  999999.967  0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:07:00 11  2.7 1.2 ms  0.0 ms 65.7 35.8
                1                 30.0     29999697  0  999989.900  0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:07:22 11  2.7 1.3 ms  0.0 ms 63.7 35.8
                2                 30.0     30000000  0  1000000.000 0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:07:36 11  2.7 2.1 ms  0.0 ms 63.4 35.8
                [9.noop]          0:01:30  89999696  0  999996.622  0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:07:22 11  2.7 2.1 ms  0.0 ms 65.7 35.8
                                  0:01:30  89999696  0  999996.622  0.0 ms   0.000 ms   0.0 ms 0.0 ms   0.0 ms   0.1 ms   30 09:07:22 11  2.7 2.1 ms  0.0 ms 65.7 35.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Fixed TPS-a
    (u:16 t:2)  0                 30.0     3001      0  100.033     0.0 ms   12.252 ms  8.3 ms 24.3 ms  28.2 ms  28.4 ms  30 09:08:57 3   1.2 62.5 ms 7.2 ms 61.7 19.8
                1                 30.0     3000      0  100.000     0.0 ms   12.030 ms  8.2 ms 24.2 ms  28.2 ms  28.2 ms  30 09:09:17 3   1.2 72.4 ms 6.4 ms 3.1  19.8
                2                 30.0     3001      0  100.033     0.0 ms   12.056 ms  8.3 ms 25.1 ms  28.2 ms  28.3 ms  30 09:09:58 3   1.2 65.5 ms 6.3 ms 3.1  19.4
                3                 30.0     3001      0  100.033     0.0 ms   12.126 ms  8.1 ms 24.2 ms  28.2 ms  28.2 ms  30 09:10:31 3   1.2 58.0 ms 5.4 ms 2.7  19.0
                [1.DELAY-6ms]     0:02:00  2991      0  24.925      0.0 ms   6.224 ms   3.8 ms 11.2 ms  12.2 ms  12.3 ms  30 09:08:45 3   1.2 72.4 ms 7.2 ms 61.7 19.8
                [2.DELAY-14ms]    0:02:00  9012      0  75.100      0.0 ms   14.072 ms  8.3 ms 25.2 ms  28.2 ms  28.4 ms  30 09:08:57 3   1.2 72.4 ms 7.2 ms 61.7 19.8
                                  0:02:00  12003     0  100.025     0.0 ms   12.116 ms  8.2 ms 24.2 ms  28.2 ms  28.4 ms  30 09:08:57 3   1.2 72.4 ms 7.2 ms 61.7 19.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Fixed TPS-b
    (u:16 t:2)  0                 30.0     3001      0  100.033     10.1 ms  10.165 ms  0.0 ms 10.2 ms  10.3 ms  10.4 ms  30 09:11:16 1   0.9 2.2 ms  0.3 ms 4.9  14.8
                1                 30.0     3001      0  100.033     10.1 ms  10.162 ms  0.0 ms 10.2 ms  10.2 ms  10.3 ms  30 09:11:45 1   1.0 2.3 ms  0.3 ms 4.1  14.8
                2                 30.0     3001      0  100.033     10.1 ms  10.162 ms  0.0 ms 10.2 ms  10.2 ms  10.3 ms  30 09:12:30 1   1.0 2.3 ms  0.3 ms 2.6  14.5
                3                 30.0     3000      0  100.000     10.1 ms  10.162 ms  0.0 ms 10.2 ms  10.2 ms  10.3 ms  30 09:12:55 1   1.0 2.4 ms  0.3 ms 2.5  3.9
                [10.DELAY-10ms]   0:02:00  12003     0  100.025     10.1 ms  10.163 ms  0.0 ms 10.2 ms  10.2 ms  10.4 ms  30 09:11:16 1   1.0 2.4 ms  0.3 ms 4.9  14.8
                                  0:02:00  12003     0  100.025     10.1 ms  10.163 ms  0.0 ms 10.2 ms  10.2 ms  10.4 ms  30 09:11:16 1   1.0 2.4 ms  0.3 ms 4.9  14.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   HTTP-a
    (u:16 t:2)  0                 30.0     311691    0  10389.700   0.1 ms   0.182 ms   0.0 ms 0.2 ms   0.3 ms   2.6 ms   30 09:13:50 11  8.4 6.0 ms  1.6 ms 96.6 93.8
                1                 30.0     307592    0  10253.067   0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   3.8 ms   30 09:14:28 11  8.4 6.5 ms  1.6 ms 72.9 93.8
                2                 30.0     304906    0  10163.533   0.1 ms   0.187 ms   0.0 ms 0.2 ms   0.3 ms   2.5 ms   30 09:14:58 11  8.4 7.1 ms  1.6 ms 76.1 93.8
                [3.HTTP-posts]    0:01:30  184833    0  2053.700    0.1 ms   0.184 ms   0.0 ms 0.2 ms   0.3 ms   2.6 ms   30 09:14:10 11  8.4 7.1 ms  1.6 ms 96.6 93.8
                [4.HTTP-comments] 0:01:30  184842    0  2053.800    0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   3.5 ms   30 09:14:28 11  8.4 7.1 ms  1.6 ms 96.6 93.8
                [5.HTTP-albums]   0:01:30  184840    0  2053.778    0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   1.9 ms   30 09:14:43 11  8.4 7.1 ms  1.6 ms 96.6 93.8
                [6.HTTP-photos]   0:01:30  184838    0  2053.756    0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   3.8 ms   30 09:14:28 11  8.4 7.1 ms  1.6 ms 96.6 93.8
                [7.HTTP-todos]    0:01:30  184836    0  2053.733    0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   2.6 ms   30 09:13:50 11  8.4 7.1 ms  1.6 ms 96.6 93.8
                                  0:01:30  924189    0  10268.767   0.1 ms   0.185 ms   0.0 ms 0.2 ms   0.3 ms   3.8 ms   30 09:14:28 11  8.4 7.1 ms  1.6 ms 96.6 93.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   HTTP-b
    (u:16 t:2)  0                 30.0     37500     0  1250.000    0.2 ms   0.614 ms   0.2 ms 0.8 ms   0.9 ms   3.4 ms   30 09:16:17 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                1                 30.0     37500     0  1250.000    0.2 ms   0.630 ms   0.1 ms 0.8 ms   0.9 ms   3.0 ms   30 09:16:40 3   1.1 2.9 ms  0.1 ms 34.9 93.8
                2                 30.0     37501     0  1250.033    0.2 ms   0.620 ms   0.1 ms 0.8 ms   0.9 ms   3.0 ms   30 09:17:02 3   1.1 1.9 ms  0.1 ms 34.4 93.8
                [3.HTTP-posts]    0:01:30  22499     0  249.989     0.2 ms   0.619 ms   0.1 ms 0.8 ms   0.9 ms   2.9 ms   30 09:17:14 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                [4.HTTP-comments] 0:01:30  22500     0  250.000     0.2 ms   0.620 ms   0.1 ms 0.8 ms   0.9 ms   2.9 ms   30 09:16:28 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                [5.HTTP-albums]   0:01:30  22501     0  250.011     0.2 ms   0.621 ms   0.1 ms 0.8 ms   0.9 ms   3.4 ms   30 09:16:17 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                [6.HTTP-photos]   0:01:30  22502     0  250.022     0.2 ms   0.622 ms   0.1 ms 0.8 ms   0.9 ms   2.5 ms   30 09:16:17 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                [7.HTTP-todos]    0:01:30  22499     0  249.989     0.2 ms   0.623 ms   0.1 ms 0.8 ms   0.9 ms   3.0 ms   30 09:16:17 3   1.1 4.3 ms  0.1 ms 67.6 93.8
                                  0:01:30  112501    0  1250.011    0.2 ms   0.621 ms   0.1 ms 0.8 ms   0.9 ms   3.4 ms   30 09:16:17 3   1.1 4.3 ms  0.1 ms 67.6 93.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT   Stdev   90p RT   99p RT   Max RT    Max RTT   MQS AQS Max WT  Avg WT CPU  JMM
0   Shutdown
    (u:16 t:2)  0                 1.608    16        0  9.950       100.2 ms 100.348 ms 0.2 ms 100.4 ms 101.3 ms 101.3 ms 30 09:17:29 1   1.0 0.1 ms  0.1 ms 32.3 93.8
                [99]              0:00:01  16        0  9.950       100.2 ms 100.348 ms 0.2 ms 100.4 ms 101.3 ms 101.3 ms 30 09:17:29 1   1.0 0.1 ms  0.1 ms 32.3 93.8
                                  0:00:01  16        0  9.950       100.2 ms 100.348 ms 0.2 ms 100.4 ms 101.3 ms 101.3 ms 30 09:17:29 1   1.0 0.1 ms  0.1 ms 32.3 93.8
----

=== HTTP API calls (slow remote system)

[source,text,options=nowrap]
----
Benchmark Report / Micro-benchmarks / 2024-08-30 10:07:34.309

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Init
    (u:16 t:2)  0                 0.05     32        0  640.000     0.0 ms   0.315 ms   1.4 ms  0.1 ms   7.9 ms   7.9 ms    30 10:07:34 1   0.8 30.4 ms   1.2 ms   0.0  12.2
                [0.start]         0:00:00  16        0  320.000     0.0 ms   0.538 ms   1.9 ms  0.1 ms   7.9 ms   7.9 ms    30 10:07:34 1   0.8 30.4 ms   1.2 ms   0.0  12.2
                [8.login]         0:00:00  16        0  320.000     0.0 ms   0.092 ms   0.2 ms  0.4 ms   0.7 ms   0.7 ms    30 10:07:34 1   0.8 30.4 ms   1.2 ms   0.0  12.2
                                  0:00:00  32        0  640.000     0.0 ms   0.315 ms   1.4 ms  0.1 ms   7.9 ms   7.9 ms    30 10:07:34 1   0.8 30.4 ms   1.2 ms   0.0  12.2

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Max TPS-a
    (u:16 t:2)  0                 30.0     40388319  0  1346277.300 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:08:25 11  3.7 1.1 ms    0.0 ms   66.2 38.7
                1                 30.0     39546481  0  1318216.033 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.2 ms    30 10:09:01 11  3.6 1.2 ms    0.0 ms   64.4 38.7
                2                 30.0     39870607  0  1329020.233 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:09:48 11  3.6 1.5 ms    0.0 ms   64.7 38.7
                [9.noop]          0:01:30  119805407 0  1331171.189 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.2 ms    30 10:09:01 11  3.7 1.5 ms    0.0 ms   66.2 38.7
                                  0:01:30  119805407 0  1331171.189 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.2 ms    30 10:09:01 11  3.7 1.5 ms    0.0 ms   66.2 38.7

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Max TPS-b
    (u:16 t:2)  0                 30.0     29999997  0  999999.900  0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:11:09 11  2.7 1.7 ms    0.0 ms   65.4 38.7
                1                 30.0     30000000  0  1000000.000 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:11:22 11  2.7 1.0 ms    0.0 ms   63.4 38.7
                2                 30.0     30000000  0  1000000.000 0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:11:53 11  2.7 1.6 ms    0.0 ms   64.0 38.7
                [9.noop]          0:01:30  89999997  0  999999.967  0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:11:53 11  2.7 1.7 ms    0.0 ms   65.4 38.7
                                  0:01:30  89999997  0  999999.967  0.0 ms   0.000 ms   0.0 ms  0.0 ms   0.0 ms   0.1 ms    30 10:11:53 11  2.7 1.7 ms    0.0 ms   65.4 38.7

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Fixed TPS-a
    (u:16 t:2)  0                 30.0     3001      0  100.033     0.0 ms   12.319 ms  8.3 ms  25.2 ms  28.2 ms  28.2 ms   30 10:13:02 3   1.2 74.5 ms   6.8 ms   59.8 19.8
                1                 30.0     3001      0  100.033     0.0 ms   12.153 ms  8.1 ms  24.2 ms  28.2 ms  28.2 ms   30 10:13:34 3   1.2 64.7 ms   6.0 ms   3.5  18.4
                2                 30.0     3001      0  100.033     0.0 ms   12.093 ms  8.2 ms  25.2 ms  28.2 ms  28.2 ms   30 10:13:53 3   1.2 58.6 ms   6.1 ms   4.2  18.4
                3                 30.0     3000      0  100.000     0.0 ms   12.187 ms  8.3 ms  25.2 ms  28.2 ms  28.2 ms   30 10:14:34 3   1.2 68.2 ms   7.0 ms   3.1  18.4
                [1.DELAY-6ms]     0:02:00  3014      0  25.117      0.0 ms   6.205 ms   3.8 ms  11.2 ms  12.2 ms  12.3 ms   30 10:14:45 3   1.2 74.5 ms   7.0 ms   59.8 19.8
                [2.DELAY-14ms]    0:02:00  8989      0  74.908      0.0 ms   14.194 ms  8.3 ms  26.2 ms  28.2 ms  28.2 ms   30 10:13:02 3   1.2 74.5 ms   7.0 ms   59.8 19.8
                                  0:02:00  12003     0  100.025     0.0 ms   12.188 ms  8.2 ms  25.2 ms  28.2 ms  28.2 ms   30 10:13:02 3   1.2 74.5 ms   7.0 ms   59.8 19.8

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Fixed TPS-b
    (u:16 t:2)  0                 30.0     3001      0  100.033     10.1 ms  10.166 ms  0.0 ms  10.2 ms  10.2 ms  10.4 ms   30 10:15:24 1   1.0 2.6 ms    0.3 ms   3.7  15.1
                1                 30.0     3001      0  100.033     10.0 ms  10.164 ms  0.0 ms  10.2 ms  10.2 ms  10.3 ms   30 10:16:23 1   1.0 3.1 ms    0.3 ms   4.2  15.1
                2                 30.0     3001      0  100.033     10.1 ms  10.164 ms  0.0 ms  10.2 ms  10.3 ms  10.5 ms   30 10:16:35 1   1.0 2.2 ms    0.3 ms   2.5  14.4
                3                 30.0     3001      0  100.033     10.1 ms  10.161 ms  0.0 ms  10.2 ms  10.2 ms  10.4 ms   30 10:17:04 1   1.0 4.0 ms    0.3 ms   2.6  9.9
                [10.DELAY-10ms]   0:02:00  12004     0  100.033     10.0 ms  10.164 ms  0.0 ms  10.2 ms  10.2 ms  10.5 ms   30 10:16:35 1   1.0 4.0 ms    0.3 ms   4.2  15.1
                                  0:02:00  12004     0  100.033     10.0 ms  10.164 ms  0.0 ms  10.2 ms  10.2 ms  10.5 ms   30 10:16:35 1   1.0 4.0 ms    0.3 ms   4.2  15.1

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   HTTP-a
    (u:16 t:2)  0                 30.0     1507      0  50.233      29.6 ms  38.762 ms  6.7 ms  44.7 ms  53.6 ms  210.4 ms  30 10:18:00 11  8.7 640.0 ms  341.1 ms 33.1 11.4
                1                 30.0     1464      0  48.800      30.8 ms  38.757 ms  5.5 ms  44.9 ms  58.8 ms  87.1 ms   30 10:18:47 11  8.1 529.4 ms  322.8 ms 8.5  13.7
                2                 30.0     1478      0  49.267      30.4 ms  39.179 ms  12.7 ms 45.2 ms  64.5 ms  471.9 ms  30 10:19:28 11  8.6 876.0 ms  341.4 ms 6.3  13.7
                [3.HTTP-posts]    0:01:30  888       0  9.867       30.4 ms  38.879 ms  7.7 ms  44.7 ms  54.7 ms  210.4 ms  30 10:18:00 11  8.7 876.0 ms  341.4 ms 33.1 13.7
                [4.HTTP-comments] 0:01:30  890       0  9.889       30.5 ms  38.795 ms  5.1 ms  44.9 ms  57.5 ms  75.0 ms   30 10:18:15 11  8.7 876.0 ms  341.4 ms 33.1 13.7
                [5.HTTP-albums]   0:01:30  891       0  9.900       29.6 ms  39.297 ms  15.6 ms 45.6 ms  59.1 ms  471.9 ms  30 10:19:28 11  8.7 876.0 ms  341.4 ms 33.1 13.7
                [6.HTTP-photos]   0:01:30  890       0  9.889       29.8 ms  38.815 ms  5.6 ms  44.6 ms  58.5 ms  83.6 ms   30 10:19:19 11  8.7 876.0 ms  341.4 ms 33.1 13.7
                [7.HTTP-todos]    0:01:30  890       0  9.889       30.8 ms  38.707 ms  5.8 ms  45.0 ms  62.8 ms  79.9 ms   30 10:18:38 11  8.7 876.0 ms  341.4 ms 33.1 13.7
                                  0:01:30  4449      0  49.433      29.6 ms  38.899 ms  8.9 ms  44.9 ms  58.5 ms  471.9 ms  30 10:19:28 11  8.7 876.0 ms  341.4 ms 33.1 13.7

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   HTTP-b
    (u:16 t:2)  0                 30.0     1332      0  44.400      29.9 ms  38.552 ms  6.1 ms  44.3 ms  58.6 ms  102.2 ms  30 10:20:10 3   1.7 167.4 ms  51.6 ms  9.9  13.7
                1                 30.0     1256      0  41.867      29.8 ms  42.254 ms  72.7 ms 44.1 ms  147.6 ms 1825.8 ms 30 10:20:45 3   1.7 1861.6 ms 53.3 ms  9.3  13.7
                2                 30.0     1322      2  44.067      29.5 ms  39.537 ms  27.3 ms 45.0 ms  60.2 ms  938.0 ms  30 10:21:08 3   1.6 956.4 ms  51.3 ms  11.9 13.7
                [3.HTTP-posts]    0:01:30  781       2  8.678       30.3 ms  40.519 ms  64.4 ms 44.0 ms  57.7 ms  1825.8 ms 30 10:20:45 3   1.7 1861.6 ms 53.3 ms  11.9 13.7
                [4.HTTP-comments] 0:01:30  783       0  8.700       30.4 ms  39.022 ms  8.8 ms  44.8 ms  62.2 ms  155.2 ms  30 10:20:54 3   1.7 1861.6 ms 53.3 ms  11.9 13.7
                [5.HTTP-albums]   0:01:30  780       0  8.667       29.5 ms  39.984 ms  33.7 ms 44.6 ms  77.6 ms  938.0 ms  30 10:21:08 3   1.7 1861.6 ms 53.3 ms  11.9 13.7
                [6.HTTP-photos]   0:01:30  781       0  8.678       30.3 ms  39.846 ms  17.2 ms 44.7 ms  102.2 ms 388.5 ms  30 10:21:13 3   1.7 1861.6 ms 53.3 ms  11.9 13.7
                [7.HTTP-todos]    0:01:30  785       0  8.722       29.9 ms  40.997 ms  64.4 ms 44.6 ms  79.6 ms  1823.8 ms 30 10:20:45 3   1.7 1861.6 ms 53.3 ms  11.9 13.7
                                  0:01:30  3910      2  43.444      29.5 ms  40.074 ms  44.3 ms 44.4 ms  68.4 ms  1825.8 ms 30 10:20:45 3   1.7 1861.6 ms 53.3 ms  11.9 13.7

SID    Name            RID        Duration    #N     #F   Avg TPS    Min RT    Avg RT    Stdev   90p RT   99p RT   Max RT     Max RTT   MQS AQS  Max WT    Avg WT  CPU  JMM
0   Shutdown
    (u:16 t:2)  0                 1.608    16        0  9.950       100.2 ms 100.324 ms 0.1 ms  100.4 ms 100.9 ms 100.9 ms  30 10:21:40 1   1.0 0.1 ms    0.1 ms   2.6  13.7
                [99]              0:00:01  16        0  9.950       100.2 ms 100.324 ms 0.1 ms  100.4 ms 100.9 ms 100.9 ms  30 10:21:40 1   1.0 0.1 ms    0.1 ms   2.6  13.7
                                  0:00:01  16        0  9.950       100.2 ms 100.324 ms 0.1 ms  100.4 ms 100.9 ms 100.9 ms  30 10:21:40 1   1.0 0.1 ms    0.1 ms   2.6  13.7
----

== Example Benchmark Configuration

=== Default Test Configuration

[source,json]
----
{
     "static": {
        "description": "Micro-benchmarks",
        "output_filename": "benchmark_output.json",
        "report_filename": "benchmark_report.html",
        "user_class": "user.http.HttpUser",
        "user_params": {
            "url": "https://jsonplaceholder.typicode.com",
            "urlx": "http://localhost:7070"
        },
        "user_actions": {
            "0": "start",
            "1": "DELAY-6ms",
            "2": "DELAY-14ms",
            "3": "HTTP-posts",
            "4": "HTTP-comments",
            "5": "HTTP-albums",
            "6": "HTTP-photos",
            "7": "HTTP-todos",
            "8": "login",
            "9": "noop",
            "10": "DELAY-10ms",
            "99": "stop"
        }
    },
    "contexts": [
        {
            "name": "Scenario-1",
            "enabled": true,
            "num_users": 16,
            "num_threads": 2
        },
        {
            "name": "Scenario-2",
            "enabled": false,
            "num_users": 32,
            "num_threads": 4
        }
    ],
    "benchmarks": [
        {
            "name": "Init",
            "enabled": true,
            "time": {
                "prewarmup_duration": 0,
                "warmup_duration": 0,
                "benchmark_duration": 0,
                "benchmark_duration_repeat_count": 1
            },
            "throughput_rate": 0.0,
            "work_in_progress": 1,
            "actions": [
                {
                    "id": 0
                },
                {
                    "id": 8
                }
            ]
        },
        {
            "name": "Max TPS-a",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 30,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 3
            },
            "throughput_rate": 0.0,
            "work_in_progress": -1,
            "actions": [
                {
                    "id": 9
                }
            ]
        },
        {
            "name": "Max TPS-b",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 30,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 3
            },
            "throughput_rate": 1000000.0,
            "work_in_progress": -1,
            "actions": [
                {
                    "id": 9
                }
            ]
        },
        {
            "name": "Fixed TPS-a",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 15,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 4
            },
            "throughput_rate": 100.0,
            "work_in_progress": 0,
            "actions": [
                {
                    "id": 1,
                    "weight": 25
                },
                {
                    "id": 2,
                    "weight": 75
                }
            ]
        },
        {
            "name": "Fixed TPS-b",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 15,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 4
            },
            "throughput_rate": 100.0,
            "work_in_progress": 0,
            "actions": [
                {
                    "id": 10
                }
            ]
        },
        {
            "name": "HTTP-a",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 15,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 3
            },
            "throughput_rate": 0.0,
            "work_in_progress": -1,
            "actions": [
                {
                    "id": 3
                },
                {
                    "id": 4
                },
                {
                    "id": 5
                },
                {
                    "id": 6
                },
                {
                    "id": 7
                }
            ]
        },
        {
            "name": "HTTP-b",
            "enabled": true,
            "time": {
                "prewarmup_duration": 15,
                "warmup_duration": 15,
                "benchmark_duration": 30,
                "benchmark_duration_repeat_count": 3
            },
            "throughput_rate": 1250.0,
            "work_in_progress": 0,
            "actions": [
                {
                    "id": 3
                },
                {
                    "id": 4
                },
                {
                    "id": 5
                },
                {
                    "id": 6
                },
                {
                    "id": 7
                }
            ]
        },
        {
            "name": "Shutdown",
            "enabled": true,
            "time": {
                "prewarmup_duration": 0,
                "warmup_duration": 0,
                "benchmark_duration": 0,
                "benchmark_duration_repeat_count": 1
            },
            "throughput_rate": 0.0,
            "work_in_progress": 1,
            "actions": [
                {
                    "id": 99
                }
            ]
        }
    ]
}
----

== Running Standalone Benchmarks

=== Publish Tulip Runtime

Build the Tulip runtime (tulip-runtime-jvm.jar) and publish it to the local Maven ~/.m2 folder.

.Linux
----
$ ./publish.sh
----

.Command output
----
~/.m2/repository/org/tulip/tulip-runtime-jvm/2.0.0-SNAPSHOT/tulip-runtime-jvm-2.0.0-SNAPSHOT-sources.jar
~/.m2/repository/org/tulip/tulip-runtime-jvm/2.0.0-SNAPSHOT/tulip-runtime-jvm-2.0.0-SNAPSHOT.jar
----

=== Standalone Gradle / Kotlin benchmark

This benchmark retrieves the tulip-runtime-jvm.jar file from the local Maven cache.

----
$ cd tulip-standalone/gradle
$ ./go_bench.sh
----

== Appendix

=== Coordinated Omission

Tulip compensates for back-pressure from the system under test and adjusts the measured service times accordingly:

* https://redhatperf.github.io/post/coordinated-omission/

=== Kotlin Books

* https://www.manning.com/books/kotlin-in-action[Kotlin in Action, 1st Edition]
* https://www.manning.com/books/kotlin-in-action-second-edition[Kotlin in Action, 2nd Edition]
* https://typealias.com/start/[Kotlin: An Illustrated Guide]

=== Performance Engineering

* "Stop Rate Limiting! Capacity Management Done Right" by Jon Moore
** https://www.youtube.com/watch?v=m64SWl9bfvk

== License

[source,text]
----
Copyright 2024 Werner Fouch√©

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
----
