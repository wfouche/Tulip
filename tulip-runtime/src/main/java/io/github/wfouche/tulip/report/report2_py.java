package io.github.wfouche.tulip.report;

///usr/bin/env jbang "$0" "$@" ; exit $?

//DEPS org.python:jython-standalone:2.7.4
//DEPS com.google.code.gson:gson:2.11.0
//DEPS org.hdrhistogram:HdrHistogram:2.2.2
//DEPS org.python:jython-standalone:2.7.4
//JAVA 21

import java.util.Base64;
import org.python.util.PythonInterpreter;

public class report2_py {

  public static String mainScriptTextBase64 =
      "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBwcmludF9mdW5jdGlvbgppbXBvcnQganNvbgppbXBvcnQgc3lzCmltcG9ydCBjb20uZ29vZ2xlLmdzb24uSnNvblBhcnNlciBhcyBKc29uUGFyc2VyCmltcG9ydCBvcwpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdAoKIyNERVBTIG9yZy5weXRob246anl0aG9uLXN0YW5kYWxvbmU6Mi43LjQKIyNERVBTIGNvbS5nb29nbGUuY29kZS5nc29uOmdzb246Mi4xMS4wCiMjREVQUyBvcmcuaGRyaGlzdG9ncmFtOkhkckhpc3RvZ3JhbToyLjIuMgojI0pBVkEgMjEKCmhlYWRlciA9ICcnJz0gX19ERVNDUklQVElPTl9fCjp0b2M6IGxlZnQKOnNlY3RudW1zOgo6ZGlhZ3JhbS1zZXJ2ZXItdXJsOiBodHRwczovL2tyb2tpLmlvLwo6ZGlhZ3JhbS1zZXJ2ZXItdHlwZToga3Jva2lfaW8KCkZpbGVuYW1lOjoKICBfX0NPTkZJR19GSUxFTkFNRV9fCgo9PSBBY3Rpb25zCgpbJWhlYWRlcixjb2xzPSIxYSwyYSJdCnw9PT0KfCBpZCB8IHZhbHVlCicnJwoKZGVmIGNyZWF0ZVJlcG9ydChmaWxlbmFtZSk6CgogICAgZGVmIHByaW50ZihzKToKICAgICAgICByZXBvcnRfZmgud3JpdGUocykKCiAgICBkZWYgZ2VuZXJhdGVfdGFibGUoZSk6CiAgICAgICAgcHJpbnRmKCJ8ICoiICsgZSArICIqXG4iKQogICAgICAgIHByaW50ZigifFxuIikKICAgICAgICBwcmludGYoJ1slaGVhZGVyLGNvbHM9IjFhLDJhIl1cbicpCiAgICAgICAgcHJpbnRmKCchPT09XG4nKQogICAgICAgIHByaW50ZignISBpZCAhIHZhbHVlIFxuJykKICAgICAgICBmb3IgayBpbiBqYlsnYWN0aW9ucyddW2VdLmtleXMoKToKICAgICAgICAgICAgcHJpbnRmKCchIConICsgayArICcqICcpCiAgICAgICAgICAgIHByaW50ZignISAnICsgc3RyKGpiWydhY3Rpb25zJ11bZV1ba10pICsgJ1xuJykKICAgICAgICBwcmludGYoJyE9PT1cbicpCgogICAgZGVmIGdlbmVyYXRlX3dvcmtmbG93KCk6CiAgICAgICAgZGlhZ0lkID0gLTEKICAgICAgICBkZWYgbmFtZV90b19pZChzKToKICAgICAgICAgICAgaWYgcyBpbiAnLSc6CiAgICAgICAgICAgICAgICByZXR1cm4gMAogICAgICAgICAgICByZXR1cm4gaW50KHMpCiAgICAgICAgZGVmIGFjdGlvbl9uYW1lKHMpOgogICAgICAgICAgICBpZiBzIGluIGpiWydhY3Rpb25zJ11bJ3VzZXJfYWN0aW9ucyddLmtleXMoKToKICAgICAgICAgICAgICAgIHJldHVybiBqYlsnYWN0aW9ucyddWyd1c2VyX2FjdGlvbnMnXVtzXQogICAgICAgICAgICByZXR1cm4gJzx1bmtub3duPicKCiAgICAgICAgI3ByaW50KGpiLmtleXMoKSkKICAgICAgICAjcHJpbnQoamJbIndvcmtmbG93cyJdLmtleXMoKSkKICAgICAgICBmb3Igd24gaW4gamJbIndvcmtmbG93cyJdLmtleXMoKToKICAgICAgICAgICAgZGlhZ0lkICs9IDEKICAgICAgICAgICAgcHJpbnRmKCJcbiIpCiAgICAgICAgICAgIHByaW50ZigiW1slc11dXG4iJSh3bikpCiAgICAgICAgICAgIHByaW50ZigiPT09ICIgKyAiJXNcbiIlKHduKSkKICAgICAgICAgICAgcHJpbnRmKCJcbiIpCiAgICAgICAgICAgIHByaW50ZignWyVoZWFkZXIsY29scz0iMWEsMWEiXVxuJykKICAgICAgICAgICAgcHJpbnRmKCd8PT09XG4nKQogICAgICAgICAgICBwcmludGYoJ3wgV29ya2Zsb3cgRGlhZ3JhbSB8IFNwZWNpZmljYXRpb25cbicpCiAgICAgICAgICAgIHByaW50ZignfCcpCiAgICAgICAgICAgIHByaW50ZigiW3BsYW50dW1sLHdmZCVkLHN2Z10iJShkaWFnSWQpICsgJ1xuJykKICAgICAgICAgICAgcHJpbnRmKCctLS0tXG4nKQogICAgICAgICAgICBwcmludGYoJ0BzdGFydHVtbFxuJykKICAgICAgICAgICAgI3ByaW50ZigndGl0bGUgJXNcbiclKHduKSkKICAgICAgICAgICAgZm9yIHNuYW1lIGluIGpiWyd3b3JrZmxvd3MnXVt3bl0ua2V5cygpOgogICAgICAgICAgICAgICAgaWYgc25hbWUgaW4gWyctJ106CiAgICAgICAgICAgICAgICAgICAgcHJpbnRmKCdzdGF0ZSAiLSIgYXMgQTBcbicpCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIHNpZCA9IGludChzbmFtZSkKICAgICAgICAgICAgICAgIHByaW50Zignc3RhdGUgIkFjdGlvbiAlZCIgYXMgQSVkXG4nJShzaWQsc2lkKSkKICAgICAgICAgICAgICAgIHByaW50ZignQSVkOiA8JXM+XG4nJShzaWQsYWN0aW9uX25hbWUoc25hbWUpKSkKICAgICAgICAgICAgICAgIHByaW50ZignXG4nKQogICAgICAgICAgICBmb3Igc25hbWUgaW4gamJbJ3dvcmtmbG93cyddW3duXS5rZXlzKCk6CiAgICAgICAgICAgICAgICBpZiBzbmFtZSBpbiBbJyonXToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgaWYgc25hbWUgaW4gWyctJ106CiAgICAgICAgICAgICAgICAgICAgbWlkID0gMAogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBtaWQgPSBpbnQoc25hbWUpCiAgICAgICAgICAgICAgICBmb3IgayBpbiBqYlsnd29ya2Zsb3dzJ11bd25dW3NuYW1lXS5rZXlzKCk6CiAgICAgICAgICAgICAgICAgICAgbmlkID0gbmFtZV90b19pZChrKQogICAgICAgICAgICAgICAgICAgIGZ2ID0gamJbJ3dvcmtmbG93cyddW3duXVtzbmFtZV1ba10KICAgICAgICAgICAgICAgICAgICBwcmludGYoJ0ElZCAtLT4gQSVkOiAlLjNmXG4nJShtaWQsbmlkLGZ2KSkKICAgICAgICAgICAgcHJpbnRmKCdAZW5kdW1sXG4nKQogICAgICAgICAgICBwcmludGYoJy0tLS1cbicpCiAgICAgICAgICAgIHByaW50ZignfCBcbicpCiAgICAgICAgICAgIHByaW50ZignW3NvdXJjZSxqc29uXVxuJykKICAgICAgICAgICAgcHJpbnRmKCctLS0tXG4nKQogICAgICAgICAgICBwcmludGYoJyVzXG4nJShqc29uLmR1bXBzKGpiWyd3b3JrZmxvd3MnXVt3bl0sIGluZGVudD00KSkpCiAgICAgICAgICAgIHByaW50ZignLS0tLVxuJykKICAgICAgICAgICAgcHJpbnRmKCd8PT09XG4nKQoKICAgICNwcmludCgiXG5Db25maWcgZmlsZW5hbWUgPSAiICsgZmlsZW5hbWUpCgogICAgIyAuanNvbmMgLT4gLmFkb2MKICAgIGZfZXh0ID0gb3MucGF0aC5zcGxpdGV4dChmaWxlbmFtZSlbMV0KICAgIHJlcG9ydF9mbiA9IGZpbGVuYW1lWzotbGVuKGZfZXh0KV0rIi5hZG9jIgogICAgcmVwb3J0X2ZoID0gb3BlbihyZXBvcnRfZm4sICJ3KyIpCgogICAgIyBSZW1vdmUgYWxsIEpTT05DIGNvbW1lbnRzIGZyb20gdGhlIEpTT04KICAgIHNmID0gb3BlbihmaWxlbmFtZSwncicpLnJlYWQoKQogICAgZ3Nvbkpzb25UcmVlID0gSnNvblBhcnNlci5wYXJzZVN0cmluZyhzZikKICAgIGpzb25XaXRob3V0Q29tbWVudHMgPSBnc29uSnNvblRyZWUudG9TdHJpbmcoKQogICAgZ3Nvbkpzb25UcmVlID0gTm9uZQoKICAgICMgUmVzdG9yZSBKU09OIGZyb20gU3RyaW5nCiAgICBqYiA9IGpzb24ubG9hZHMoanNvbldpdGhvdXRDb21tZW50cywgb2JqZWN0X3BhaXJzX2hvb2s9T3JkZXJlZERpY3QpCiAgICBqc29uV2l0aG91dENvbW1lbnRzID0gTm9uZQoKICAgICMgcHJpbnQgaGVhZGVyCiAgICBwcmludGYoaGVhZGVyLnJlcGxhY2UoIl9fQ09ORklHX0ZJTEVOQU1FX18iLCBmaWxlbmFtZSkucmVwbGFjZSgiX19ERVNDUklQVElPTl9fIiwgamJbJ2FjdGlvbnMnXVsnZGVzY3JpcHRpb24nXSkpCgogICAgIyBBY3Rpb25zCiAgICBmb3IgZSBpbiBqYlsnYWN0aW9ucyddLmtleXMoKToKICAgICAgICBpZiBlIGluIFsndXNlcl9wYXJhbXMnLCAndXNlcl9hY3Rpb25zJ106CiAgICAgICAgICAgIGdlbmVyYXRlX3RhYmxlKGUpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgIyB8ICpkZXNjcmlwdGlvbioKICAgICAgICAjIHwgTWljcm8tYmVuY2htYXJrcwogICAgICAgIHByaW50ZigifCAqIiArIGUgKyAnKlxuJykKICAgICAgICBwcmludGYoInwgIiArIGpiWydhY3Rpb25zJ11bZV0gKyAnXG4nKQogICAgcHJpbnRmKCJ8PT09IiArICdcbicpCgogICAgIyBXb3JrZmxvd3MKICAgIGlmICJ3b3JrZmxvd3MiIGluIGpiLmtleXMoKToKICAgICAgICBwcmludGYoIlxuIikKICAgICAgICBwcmludGYoIj09IFdvcmtmbG93cyBcbiIpCiAgICAgICAgZ2VuZXJhdGVfd29ya2Zsb3coKQoKICAgICMgQmVuY2htYXJrcyBEYXRhCiAgICBwcmludGYoIlxuIikKICAgIHByaW50ZigiPT0gQmVuY2htYXJrc1xuIikKICAgIGZvciBrIGluIGpiWydiZW5jaG1hcmtzJ10ua2V5cygpOgogICAgICAgIGIgPSBqYlsnYmVuY2htYXJrcyddW2tdCiAgICAgICAgcHJpbnRmKCJcbiIpCiAgICAgICAgcHJpbnRmKCc9PT0gJXMnJShrKSArICdcbicpCiAgICAgICAgcHJpbnRmKCJcbiIpCiAgICAgICAgcHJpbnRmKCdbJWhlYWRlcixjb2xzPSIxYSwyYSJdXG4nKQogICAgICAgIHByaW50ZigifD09PVxuIikKICAgICAgICBwcmludGYoInwgaWQgfCB2YWx1ZVxuIikKICAgICAgICAjIGVuYWJsZWQKICAgICAgICBpZiAiZW5hYmxlZCIgaW4gYi5rZXlzKCk6CiAgICAgICAgICAgIHByaW50ZignfCAqZW5hYmxlZCogfCAlc1xuJyUoYlsiZW5hYmxlZCJdKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludGYoJ3wgKmVuYWJsZWQqIHwgVHJ1ZVxuJykKICAgICAgICAjIGFwc19yYXRlCiAgICAgICAgaWYgImFwc19yYXRlIiBpbiBiLmtleXMoKToKICAgICAgICAgICAgcHJpbnRmKCd8ICphcHNfcmF0ZSogfCAlLjFmXG4nJShiWyJhcHNfcmF0ZSJdKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludGYoJ3wgKmFwc19yYXRlKiB8IDAuMFxuJykKICAgICAgICAjIHdvcmtlcl90aHJlYWRfcXVldWVfc2l6ZQogICAgICAgIGlmICJ3b3JrZXJfdGhyZWFkX3F1ZXVlX3NpemUiIGluIGIua2V5cygpOgogICAgICAgICAgICBwcmludGYoJ3wgKndvcmtlcl90aHJlYWRfcXVldWVfc2l6ZSogfCAlZFxuJyUoYlsid29ya2VyX3RocmVhZF9xdWV1ZV9zaXplIl0pKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50ZignfCAqd29ya2VyX3RocmVhZF9xdWV1ZV9zaXplKiB8IDBcbicpCiAgICAgICAgIyB3b3JrZmxvdwogICAgICAgIGlmICJzY2VuYXJpb193b3JrZmxvdyIgaW4gYi5rZXlzKCk6CiAgICAgICAgICAgIHdvcmtmbG93X2lzX2RlZmluZWQgPSBiWyJzY2VuYXJpb193b3JrZmxvdyJdIGluIGpiWyJ3b3JrZmxvd3MiXS5rZXlzKCkKICAgICAgICAgICAgaWYgd29ya2Zsb3dfaXNfZGVmaW5lZDoKICAgICAgICAgICAgICAgIHByaW50ZignfCAqc2NlbmFyaW9fd29ya2Zsb3cqIHwgPDwlcz4+XG4nJShiWyJzY2VuYXJpb193b3JrZmxvdyJdKSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50ZignfCAqc2NlbmFyaW9fd29ya2Zsb3cqIHwgRXJyb3IsIHNjZW5hcmlvX3dvcmtmbG93IColcyogaXMgbm90IGRlZmluZWRcbiclKGJbInNjZW5hcmlvX3dvcmtmbG93Il0pKQogICAgICAgIGVsaWYgInNjZW5hcmlvX2FjdGlvbnMiIGluIGIua2V5cygpOgogICAgICAgICAgICBwcmludGYoJ3wgKnNjZW5hcmlvX2FjdGlvbnMqIFxuJykKICAgICAgICAgICAgcHJpbnRmKCd8IFxuJykKICAgICAgICAgICAgcHJpbnRmKCdbJWhlYWRlcixjb2xzPSIxYSwyYSJdXG4nKQogICAgICAgICAgICBwcmludGYoJyE9PT1cbicpCiAgICAgICAgICAgIHByaW50ZignISBpZCAhIHdlaWdodCBcbicpCiAgICAgICAgICAgIGZvciBhIGluIGJbInNjZW5hcmlvX2FjdGlvbnMiXToKICAgICAgICAgICAgICAgIHByaW50ZignISAlZFxuJyUoYVsiaWQiXSkpCiAgICAgICAgICAgICAgICBpZiAid2VpZ2h0IiBpbiBhLmtleXMoKToKICAgICAgICAgICAgICAgICAgICBwcmludGYoJyEgJWQgXG4nJShhWyJ3ZWlnaHQiXSkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50ZignISAtIFxuJykKICAgICAgICAgICAgcHJpbnRmKCchPT09XG4nKQogICAgICAgICMgdGltZQogICAgICAgIGlmICJ0aW1lIiBpbiBiLmtleXMoKToKICAgICAgICAgICAgcHJpbnRmKCd8ICp0aW1lKiBcbicpCiAgICAgICAgICAgIHByaW50ZignfCBcbicpCiAgICAgICAgICAgIHByaW50ZignWyVub2hlYWRlcixjb2xzPSIyYSwxYSJdXG4nKQogICAgICAgICAgICBwcmludGYoJyE9PT1cbicpCiAgICAgICAgICAgICNwcmludGYoJyEgaWQgISB2YWx1ZSBcbicpCiAgICAgICAgICAgIGZvciBrIGluIGJbInRpbWUiXS5rZXlzKCk6CiAgICAgICAgICAgICAgICBwcmludGYoJyEgKiVzKlxuJyUoaykpCiAgICAgICAgICAgICAgICBwcmludGYoJyEgJWQgc2Vjb25kc1xuJyUoYlsidGltZSJdW2tdKSkKICAgICAgICAgICAgcHJpbnRmKCchPT09XG4nKQoKICAgICAgICBwcmludGYoInw9PT1cbiIpCgogICAgIyBDb250ZXh0IERhdGEKICAgIHByaW50ZigiXG4iKQogICAgcHJpbnRmKCI9PSBDb250ZXh0c1xuIikKICAgIHByaW50ZigiXG4iKQoKICAgIGZvciBrIGluIGpiWydjb250ZXh0cyddLmtleXMoKToKICAgICAgICBjID0gamJbJ2NvbnRleHRzJ11ba10KICAgICAgICBwcmludGYoJz09PSAlcyclKGspICsgJ1xuJykKICAgICAgICBwcmludGYoJ1xuJykKICAgICAgICBwcmludGYoJ1slaGVhZGVyLGNvbHM9IjFhLDJhIl1cbicpCiAgICAgICAgcHJpbnRmKCd8PT09XG4nKQogICAgICAgIHByaW50ZignfCBpZCB8IHZhbHVlIFxuJykKICAgICAgICBpZiAiZW5hYmxlZCIgaW4gYy5rZXlzKCk6CiAgICAgICAgICAgIHByaW50ZignfCAqZW5hYmxlZCogfCAlc1xuJyUoY1siZW5hYmxlZCJdKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludGYoJ3wgKmVuYWJsZWQqIHwgVHJ1ZVxuJykKICAgICAgICBwcmludGYoJ3wgKm51bV91c2VycyogICB8ICVkXG4nJShjWyJudW1fdXNlcnMiXSkpCiAgICAgICAgcHJpbnRmKCd8ICpudW1fdGhyZWFkcyogfCAlZFxuJyUoY1sibnVtX3RocmVhZHMiXSkpCiAgICAgICAgcHJpbnRmKCJ8PT09XG4iKQoKICAgIHJlcG9ydF9maC5jbG9zZSgpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgaWYgbGVuKHN5cy5hcmd2KSA+PSAyOgogICAgICAgIGZpbGVuYW1lID0gc3lzLmFyZ3ZbMV0KICAgICAgICBjcmVhdGVSZXBvcnQoZmlsZW5hbWUpCg==";

  public static void main(String... args) {
    String mainScriptFilename = "report2.py";
    String mainScript = "";
    String jythonArgsScript = "";
    for (String arg : args) {
      // System.out.println("Java: " + arg);
      if (jythonArgsScript.length() == 0) {
        if (!arg.equals(mainScriptFilename)) {
          jythonArgsScript += "'" + mainScriptFilename + "', ";
        }
      } else {
        jythonArgsScript += ", ";
      }
      jythonArgsScript += "'" + arg + "'";
    }
    if (jythonArgsScript.length() == 0) {
      jythonArgsScript = "'" + mainScriptFilename + "'";
    }
    jythonArgsScript = "import sys; sys.argv = [" + jythonArgsScript + "]";
    {
      byte[] decodedBytes = Base64.getDecoder().decode(mainScriptTextBase64);
      String text = new String(decodedBytes);
      // System.out.println("===");
      // System.out.println(text);
      // System.out.println("===");
      mainScript = text;
    }
    // System.out.println("args --> " + jythonArgsScript);
    {
      // run script
      PythonInterpreter pyInterp = new PythonInterpreter();
      // initialize args
      pyInterp.exec(jythonArgsScript);
      // run script
      // pyInterp.exec("__name__=""");
      pyInterp.exec(mainScript);
    }
    // jython.main(args);
  }
}
