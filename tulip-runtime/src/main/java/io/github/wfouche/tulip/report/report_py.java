package io.github.wfouche.tulip.report;

/// usr/bin/env jbang "$0" "$@" ; exit $?

// spotless:off
// DEPS com.google.code.gson:gson:2.13.1
// DEPS org.hdrhistogram:HdrHistogram:2.2.2
// DEPS org.python:jython-slim:2.7.4
// JAVA 21
// spotless:on

import java.util.Base64;
import org.python.util.PythonInterpreter;

public class report_py {

    public static String mainScriptTextBase64 =
            "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBwcmludF9mdW5jdGlvbgppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGpzb24KaW1wb3J0IHN5cwppbXBvcnQgb3JnLkhkckhpc3RvZ3JhbS5IaXN0b2dyYW0gYXMgSGlzdG9ncmFtCmltcG9ydCBvcwpmcm9tIGNvbGxlY3Rpb25zIGltcG9ydCBPcmRlcmVkRGljdAppbXBvcnQgamF2YS5pby5QcmludFN0cmVhbSBhcyBQcmludFN0cmVhbQppbXBvcnQgamF2YS5pby5CeXRlQXJyYXlPdXRwdXRTdHJlYW0gYXMgQnl0ZUFycmF5T3V0cHV0U3RyZWFtCgojIC8vLyBqYmFuZwojIHJlcXVpcmVzLWp5dGhvbiA9ICI9PTIuNy40IgojIHJlcXVpcmVzLWphdmEgPSAiPj0yMSIKIyBkZXBlbmRlbmNpZXMgPSBbCiMgICAiY29tLmdvb2dsZS5jb2RlLmdzb246Z3NvbjoyLjEzLjEiLAojICAgIm9yZy5oZHJoaXN0b2dyYW06SGRySGlzdG9ncmFtOjIuMi4yIgojIF0KIyBbcHl0aG9uLWp2bV0KIyAgIGRlYnVnID0gZmFsc2UKIyAvLy8KCnN1bW1hcnlfaHRtbF8xID0gJycnPCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KPG1ldGEgY2hhcnNldD0iVVRGLTgiPgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgZGl2Lmhpc3RvIHsKICAgICAgICB2aXNpYmlsaXR5OiBoaWRkZW4KICAgIH0KPC9zdHlsZT4KCjwhLS1Mb2FkIHRoZSBBSkFYIEFQSS0tPgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwczovL3d3dy5nb29nbGUuY29tL2pzYXBpIj48L3NjcmlwdD4KCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KCiAgICBpZiAod2luZG93LkZpbGUgJiYgd2luZG93LkZpbGVSZWFkZXIgJiYgd2luZG93LkZpbGVMaXN0ICYmIHdpbmRvdy5CbG9iKSB7CiAgICAgICAgLy8gR3JlYXQgc3VjY2VzcyEgQWxsIHRoZSBGaWxlIEFQSXMgYXJlIHN1cHBvcnRlZC4KICAgIH0gZWxzZSB7CiAgICAgICAgYWxlcnQoJ1RoZSBGaWxlIEFQSXMgYXJlIG5vdCBmdWxseSBzdXBwb3J0ZWQgaW4gdGhpcyBicm93c2VyLicpOwogICAgfQoKICAgIC8vIExvYWQgdGhlIFZpc3VhbGl6YXRpb24gQVBJIGFuZCB0aGUgY29yZWNoYXJ0IHBhY2thZ2UuCiAgICBnb29nbGUubG9hZCgndmlzdWFsaXphdGlvbicsICcxLjAnLCB7J3BhY2thZ2VzJzpbJ2NvcmVjaGFydCddfSk7CgogICAgLy8gU2V0IGEgY2FsbGJhY2sgdG8gcnVuIHdoZW4gdGhlIEdvb2dsZSBWaXN1YWxpemF0aW9uIEFQSSBpcyBsb2FkZWQuCiAgICBnb29nbGUuc2V0T25Mb2FkQ2FsbGJhY2soZHJhd0luaXRpYWxDaGFydCk7CgogICAgdmFyIGNoYXJ0RGF0YSA9IG51bGw7CiAgICB2YXIgY2hhcnQgPSBudWxsOwoKICAgIGZ1bmN0aW9uIHNldENoYXJ0RGF0YShuYW1lcywgaGlzdG9zKSB7CiAgICAgICAgd2hpbGUgKG5hbWVzLmxlbmd0aCA8IGhpc3Rvcy5sZW5ndGgpIHsKICAgICAgICAgICAgbmFtZXMucHVzaCgnVW5rbm93bicpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNlcmllcyA9IFtdOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaGlzdG9zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHNlcmllcyA9IGFwcGVuZERhdGFTZXJpZXMoaGlzdG9zW2ldLCBuYW1lc1tpXSwgc2VyaWVzKTsKICAgICAgICB9CgogICAgICAgIGNoYXJ0RGF0YSA9IGdvb2dsZS52aXN1YWxpemF0aW9uLmFycmF5VG9EYXRhVGFibGUoc2VyaWVzKTsKICAgIH0KCicnJwoKdGV4dF9ibG9ja18xID0gJycnCiAgICBmdW5jdGlvbiBkcmF3SW5pdGlhbENoYXJ0KCkgewogICAgICAgIC8vIENvbm5lY3QgdGhlIGNob29zZSBmaWxlcyBidXR0b246CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVNlbGVjdCwgZmFsc2UpOwoKICAgICAgICAvLyBMb2FkIHNvbWUgc3RhdGljIGV4YW1wbGUgZGF0YToKICAgICAgICB2YXIgZGF0YTFTdHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJkaXYjZGF0YV8xIikuaW5uZXJIVE1MLnRyaW0oKTsKICAgICAgICB2YXIgZGF0YTJTdHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJkaXYjZGF0YV8yIikuaW5uZXJIVE1MLnRyaW0oKTsKICAgICAgICB2YXIgZGF0YTNTdHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJkaXYjZGF0YV8zIikuaW5uZXJIVE1MLnRyaW0oKTsKICAgICAgICB2YXIgaGlzdG9zID0gW2RhdGEzU3RyLCBkYXRhMlN0ciwgZGF0YTFTdHJdOwogICAgICAgIHZhciBuYW1lcyA9IFsnQScsICdCJywgJ0MnXTsKCiAgICAgICAgc2V0Q2hhcnREYXRhKG5hbWVzLCBoaXN0b3MpOwogICAgICAgIGRyYXdDaGFydCgpOwogICAgfQonJycKCnN1bW1hcnlfaHRtbF8yID0gJycnCiAgICB2YXIgbWF4UGVyY2VudGlsZSA9IDEwMDAwMDA7CgogICAgZnVuY3Rpb24gZHJhd0NoYXJ0KCkgewoKICAgICAgICB2YXIgdGlja3MgPQogICAgICAgICAgICAgICAgW3t2OjEsZjonMCUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMCxmOic5MCUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMDAsZjonOTklJ30sCiAgICAgICAgICAgICAgICAgICAge3Y6MTAwMCxmOic5OS45JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAwLGY6Jzk5Ljk5JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAwMCxmOic5OS45OTklJ30sCiAgICAgICAgICAgICAgICAgICAge3Y6MTAwMDAwMCxmOic5OS45OTk5JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAwMDAwLGY6Jzk5Ljk5OTk5JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAwMDAwMCxmOic5OS45OTk5OTklJ31dOwoKICAgICAgICB2YXIgdW5pdFNlbGVjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0aW1lVW5pdFNlbGVjdGlvbiIpOwogICAgICAgIHZhciB1bml0U2VsSW5kZXggPSB1bml0U2VsZWN0aW9uLnNlbGVjdGVkSW5kZXg7CiAgICAgICAgdmFyIHVuaXRUZXh0ID0gdW5pdFNlbGVjdGlvbi5vcHRpb25zW3VuaXRTZWxJbmRleF0uaW5uZXJIVE1MOwoKICAgICAgICB2YXIgb3B0aW9ucyA9IHsKLy8gICAgICAgICAgICB0aXRsZTogJ1BlcmNlbnRpbGUgUmVzcG9uc2UgVGltZSBEaXN0cmlidXRpb24nLAogICAgICAgICAgICBoZWlnaHQ6IDQ4MCwKLy8gICAgICAgICAgICBoQXhpczoge3RpdGxlOiAnUGVyY2VudGlsZScsIG1pblZhbHVlOiAwLCBsb2dTY2FsZTogdHJ1ZSwgdGlja3M6dGlja3MgfSwKICAgICAgICAgICAgaEF4aXM6IHsKICAgICAgICAgICAgICAgIHRpdGxlOiAiUGVyY2VudGlsZSIsCiAgICAgICAgICAgICAgICBtaW5WYWx1ZTogMSwgbG9nU2NhbGU6IHRydWUsIHRpY2tzOnRpY2tzLAogICAgICAgICAgICAgICAgdmlld1dpbmRvd01vZGU6J2V4cGxpY2l0JywKICAgICAgICAgICAgICAgIHZpZXdXaW5kb3c6ewogICAgICAgICAgICAgICAgICAgIG1heDptYXhQZXJjZW50aWxlLAogICAgICAgICAgICAgICAgICAgIG1pbjoxCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHZBeGlzOiB7dGl0bGU6ICdMYXRlbmN5ICgnICsgdW5pdFRleHQgKyAnKScsIG1pblZhbHVlOiAwIH0sCiAgICAgICAgICAgIGxlZ2VuZDoge3Bvc2l0aW9uOiAnYm90dG9tJ30KICAgICAgICB9OwoKCiAgICAgICAgLy8gYWRkIHRvb2x0aXBzIHdpdGggY29ycmVjdCBwZXJjZW50aWxlIHRleHQgdG8gZGF0YToKICAgICAgICB2YXIgY29sdW1ucyA9IFswXTsKICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGNoYXJ0RGF0YS5nZXROdW1iZXJPZkNvbHVtbnMoKTsgaSsrKSB7CiAgICAgICAgICAgIGNvbHVtbnMucHVzaChpKTsKICAgICAgICAgICAgY29sdW1ucy5wdXNoKHsKICAgICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgICAgICAgIHJvbGU6ICd0b29sdGlwJwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGNhbGM6IChmdW5jdGlvbiAoaikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZHQsIHJvdykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGVyY2VudGlsZSA9IDEwMC4wIC0gKDEwMC4wL2R0LmdldFZhbHVlKHJvdywgMCkpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZHQuZ2V0Q29sdW1uTGFiZWwoaikgKyAnOiAnICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJjZW50aWxlLnRvUHJlY2lzaW9uKDcpICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXCVcXCdpbGUgPSAnICsgZHQuZ2V0VmFsdWUocm93LCBqKSArICcgJyArIHVuaXRUZXh0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkoaSkKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHZhciB2aWV3ID0gbmV3IGdvb2dsZS52aXN1YWxpemF0aW9uLkRhdGFWaWV3KGNoYXJ0RGF0YSk7CiAgICAgICAgdmlldy5zZXRDb2x1bW5zKGNvbHVtbnMpOwoKICAgICAgICBjaGFydCA9IG5ldyBnb29nbGUudmlzdWFsaXphdGlvbi5MaW5lQ2hhcnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NoYXJ0X2RpdicpKTsKICAgICAgICBjaGFydC5kcmF3KHZpZXcsIG9wdGlvbnMpOwoKICAgICAgICBnb29nbGUudmlzdWFsaXphdGlvbi5ldmVudHMuYWRkTGlzdGVuZXIoY2hhcnQsICdyZWFkeScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY2hhcnRfZGl2LmlubmVySFRNTCA9ICc8aW1nIHNyYz0iJyArIGNoYXJ0LmdldEltYWdlVVJJKCkgKyAnIj4nOwogICAgICAgIH0pOwoKICAgIH0KPC9zY3JpcHQ+CjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgIGZ1bmN0aW9uIGFwcGVuZERhdGFTZXJpZXMoaGlzdG8sIG5hbWUsIGRhdGFTZXJpZXMpIHsKICAgICAgICB2YXIgc2VyaWVzOwogICAgICAgIHZhciBzZXJpZXNDb3VudDsKICAgICAgICBpZiAoZGF0YVNlcmllcy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBzZXJpZXMgPSBbIFsnWCcsIG5hbWVdIF07CiAgICAgICAgICAgIHNlcmllc0NvdW50ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXJpZXMgPSBkYXRhU2VyaWVzOwogICAgICAgICAgICBzZXJpZXNbMF0ucHVzaChuYW1lKTsKICAgICAgICAgICAgc2VyaWVzQ291bnQgPSBzZXJpZXNbMF0ubGVuZ3RoIC0gMTsKICAgICAgICB9CgogICAgICAgIHZhciBsaW5lcyA9IGhpc3RvLnNwbGl0KCJcXG4iKTsKCiAgICAgICAgdmFyIHNlcmllc0luZGV4ID0gMTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHZhciBsaW5lID0gbGluZXNbaV0udHJpbSgpOwogICAgICAgICAgICB2YXIgdmFsdWVzID0gbGluZS50cmltKCkuc3BsaXQoL1sgXSsvKTsKCiAgICAgICAgICAgIGlmIChsaW5lWzBdICE9ICcjJyAmJiB2YWx1ZXMubGVuZ3RoID09IDQpIHsKCiAgICAgICAgICAgICAgICB2YXIgeSA9IHBhcnNlRmxvYXQodmFsdWVzWzBdKTsKICAgICAgICAgICAgICAgIHZhciB4ID0gcGFyc2VGbG9hdCh2YWx1ZXNbM10pOwoKICAgICAgICAgICAgICAgIGlmICghaXNOYU4oeCkgJiYgIWlzTmFOKHkpKSB7CgogICAgICAgICAgICAgICAgICAgIGlmIChzZXJpZXNJbmRleCA+PSBzZXJpZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlcmllcy5wdXNoKFt4XSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoc2VyaWVzW3Nlcmllc0luZGV4XS5sZW5ndGggPCBzZXJpZXNDb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXJpZXNbc2VyaWVzSW5kZXhdLnB1c2gobnVsbCk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBzZXJpZXNbc2VyaWVzSW5kZXhdLnB1c2goeSk7CiAgICAgICAgICAgICAgICAgICAgc2VyaWVzSW5kZXgrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgd2hpbGUgKHNlcmllc0luZGV4IDwgc2VyaWVzLmxlbmd0aCkgewogICAgICAgICAgICBzZXJpZXNbc2VyaWVzSW5kZXhdLnB1c2gobnVsbCk7CiAgICAgICAgICAgIHNlcmllc0luZGV4Kys7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gc2VyaWVzOwogICAgfQo8L3NjcmlwdD4KPHNjcmlwdD4KICAgIGZ1bmN0aW9uIHRpbWVVbml0c1NlbGVjdGVkKGV2dCkgewogICAgICAgIGRyYXdDaGFydCgpOwogICAgICAgIHJldHVybiB7dHlwZWQ6ICcnfTsKICAgIH0KCiAgICBmdW5jdGlvbiBkb0V4cG9ydChldmVudCkgewogICAgICAgIHNhdmVTdmdBc1BuZyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdzdmcnKSwgJ0hpc3RvZ3JhbScsIDIuMCk7CiAgICAgICAgcmV0dXJuIHt0eXBlZDogJyd9OwogICAgfQo8L3NjcmlwdD4KCjxzY3JpcHQ+CiAgICBmdW5jdGlvbiBoYW5kbGVGaWxlU2VsZWN0KGV2dCkgewogICAgICAgIHZhciBmaWxlcyA9IGV2dC50YXJnZXQuZmlsZXM7IC8vIEZpbGVMaXN0IG9iamVjdAogICAgICAgIHZhciBmaWxlRGlzcGxheUFyZWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZURpc3BsYXlBcmVhJyk7CgogICAgICAgIHZhciBuYW1lcyA9IFtdOwogICAgICAgIHZhciBoaXN0b3MgPSBbXTsKCiAgICAgICAgZmlsZURpc3BsYXlBcmVhLmlubmVyVGV4dCA9ICJmaWxlIHNlbGVjdGVkLi4uXFxuIjsKCiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIHRoZSBGaWxlTGlzdCBhbmQgcmVuZGVyIGltYWdlIGZpbGVzIGFzIHRodW1ibmFpbHMuCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGY7IGYgPSBmaWxlc1tpXTsgaSsrKSB7CiAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwoKICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbih0aGVGaWxlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgICAgIGhpc3Rvcy5wdXNoKGUudGFyZ2V0LnJlc3VsdCk7CiAgICAgICAgICAgICAgICAgICAgbmFtZXMucHVzaChlc2NhcGUodGhlRmlsZS5uYW1lKSk7CiAgICAgICAgICAgICAgICAgICAgZmlsZURpc3BsYXlBcmVhLmlubmVyVGV4dCA9ICIgUGxvdHRpbmcgaW5wdXQgZnJvbTogIiArIG5hbWVzICsgIlxcbiI7CiAgICAgICAgICAgICAgICAgICAgc2V0Q2hhcnREYXRhKG5hbWVzLCBoaXN0b3MpOwogICAgICAgICAgICAgICAgICAgIGRyYXdDaGFydCgpOwogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkoZik7CgogICAgICAgICAgICAvLyBSZWFkIGluIHRoZSBpbWFnZSBmaWxlIGFzIGEgZGF0YSBVUkwuCiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGYpOwogICAgICAgIH0KCiAgICB9Cgo8L3NjcmlwdD4KCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgIChmdW5jdGlvbigpIHsKICAgICAgICB2YXIgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpczsKCiAgICAgICAgdmFyIGRvY3R5cGUgPSAnPD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+JzsKCiAgICAgICAgZnVuY3Rpb24gaW5saW5lSW1hZ2VzKGNhbGxiYWNrKSB7CiAgICAgICAgICAgIHZhciBpbWFnZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdzdmcgaW1hZ2UnKTsKICAgICAgICAgICAgdmFyIGxlZnQgPSBpbWFnZXMubGVuZ3RoOwogICAgICAgICAgICBpZiAobGVmdCA9PSAwKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW1hZ2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAoZnVuY3Rpb24oaW1hZ2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhyZWYgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoJ3hsaW5rOmhyZWYnKS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC9eaHR0cC8udGVzdChocmVmKSAmJiAhKG5ldyBSZWdFeHAoJ14nICsgd2luZG93LmxvY2F0aW9uLmhvc3QpLnRlc3QoaHJlZikpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkNhbm5vdCByZW5kZXIgZW1iZWRkZWQgaW1hZ2VzIGxpbmtpbmcgdG8gZXh0ZXJuYWwgaG9zdHMuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpOwogICAgICAgICAgICAgICAgICAgIHZhciBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgaW1nLnNyYyA9IGltYWdlLmdldEF0dHJpYnV0ZSgneGxpbms6aHJlZicpOwogICAgICAgICAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gaW1nLndpZHRoOwogICAgICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaW1nLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWcsIDAsIDApOwogICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ3hsaW5rOmhyZWYnLCBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxlZnQtLTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnQgPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKGltYWdlc1tpXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIHN0eWxlcyhkb20pIHsKICAgICAgICAgICAgdmFyIGNzcyA9ICIiOwogICAgICAgICAgICB2YXIgc2hlZXRzID0gZG9jdW1lbnQuc3R5bGVTaGVldHM7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hlZXRzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoc2hlZXRzW2ldLmhhc093blByb3BlcnR5KCdjc3NSdWxlcycpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJ1bGVzID0gc2hlZXRzW2ldLmNzc1J1bGVzOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgcnVsZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJ1bGUgPSBydWxlc1tqXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZihydWxlLnN0eWxlKSAhPSAidW5kZWZpbmVkIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY3NzICs9IHJ1bGUuc2VsZWN0b3JUZXh0ICsgIiB7ICIgKyBydWxlLnN0eWxlLmNzc1RleHQgKyAiIH1cXG4iOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgICAgIHMuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RleHQvY3NzJyk7CiAgICAgICAgICAgIHMuaW5uZXJIVE1MID0gIjwhW0NEQVRBW1xcbiIgKyBjc3MgKyAiXFxuXV0+IjsKCiAgICAgICAgICAgIHZhciBkZWZzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGVmcycpOwogICAgICAgICAgICBkZWZzLmFwcGVuZENoaWxkKHMpOwogICAgICAgICAgICByZXR1cm4gZGVmczsKICAgICAgICB9CgogICAgICAgIG91dCQuc3ZnQXNEYXRhVXJpID0gZnVuY3Rpb24oZWwsIHNjYWxlRmFjdG9yLCBjYikgewogICAgICAgICAgICBzY2FsZUZhY3RvciA9IHNjYWxlRmFjdG9yIHx8IDE7CgogICAgICAgICAgICBpbmxpbmVJbWFnZXMoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgb3V0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgICAgIHZhciBjbG9uZSA9IGVsLmNsb25lTm9kZSh0cnVlKTsKICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IHBhcnNlSW50KAogICAgICAgICAgICAgICAgICAgICAgICBjbG9uZS5nZXRBdHRyaWJ1dGUoJ3dpZHRoJykKICAgICAgICAgICAgICAgICAgICAgICAgfHwgY2xvbmUuc3R5bGUud2lkdGgKICAgICAgICAgICAgICAgICAgICAgICAgfHwgb3V0JC5nZXRDb21wdXRlZFN0eWxlKGVsKS5nZXRQcm9wZXJ0eVZhbHVlKCd3aWR0aCcpCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgdmFyIGhlaWdodCA9IHBhcnNlSW50KAogICAgICAgICAgICAgICAgICAgICAgICBjbG9uZS5nZXRBdHRyaWJ1dGUoJ2hlaWdodCcpCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGNsb25lLnN0eWxlLmhlaWdodAogICAgICAgICAgICAgICAgICAgICAgICB8fCBvdXQkLmdldENvbXB1dGVkU3R5bGUoZWwpLmdldFByb3BlcnR5VmFsdWUoJ2hlaWdodCcpCiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgIHZhciB4bWxucyA9ICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3htbG5zLyI7CgogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlKCJ2ZXJzaW9uIiwgIjEuMSIpOwogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlTlMoeG1sbnMsICJ4bWxucyIsICJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIpOwogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlTlMoeG1sbnMsICJ4bWxuczp4bGluayIsICJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIik7CiAgICAgICAgICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoIndpZHRoIiwgd2lkdGggKiBzY2FsZUZhY3Rvcik7CiAgICAgICAgICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIGhlaWdodCAqIHNjYWxlRmFjdG9yKTsKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZSgidmlld0JveCIsICIwIDAgIiArIHdpZHRoICsgIiAiICsgaGVpZ2h0KTsKICAgICAgICAgICAgICAgIG91dGVyLmFwcGVuZENoaWxkKGNsb25lKTsKCiAgICAgICAgICAgICAgICBjbG9uZS5pbnNlcnRCZWZvcmUoc3R5bGVzKGNsb25lKSwgY2xvbmUuZmlyc3RDaGlsZCk7CgogICAgICAgICAgICAgICAgdmFyIHN2ZyA9IGRvY3R5cGUgKyBvdXRlci5pbm5lckhUTUw7CiAgICAgICAgICAgICAgICB2YXIgdXJpID0gJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsJyArIHdpbmRvdy5idG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChzdmcpKSk7CiAgICAgICAgICAgICAgICBpZiAoY2IpIHsKICAgICAgICAgICAgICAgICAgICBjYih1cmkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIG91dCQuc2F2ZVN2Z0FzUG5nID0gZnVuY3Rpb24oZWwsIG5hbWUsIHNjYWxlRmFjdG9yKSB7CiAgICAgICAgICAgIG91dCQuc3ZnQXNEYXRhVXJpKGVsLCBzY2FsZUZhY3RvciwgZnVuY3Rpb24odXJpKSB7CiAgICAgICAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTsKICAgICAgICAgICAgICAgIGltYWdlLnNyYyA9IHVyaTsKICAgICAgICAgICAgICAgIGltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDApOwoKICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgICAgICAgICAgICAgICBhLmRvd25sb2FkID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICBhLmhyZWYgPSBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOwogICAgICAgICAgICAgICAgICAgIGEuY2xpY2soKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfSkoKTsKPC9zY3JpcHQ+Cgo8c3R5bGU+CiAgICAuc2xpZGVyLXdpZHRoNTAwCiAgICB7CiAgICAgICAgd2lkdGg6IDUwMHB4OwogICAgfQo8L3N0eWxlPgoKPC9oZWFkPgoKPGJvZHk+CgpfX0NIQVJUU19URVhUX18KCjxoMj5QZXJjZW50aWxlIFJlc3BvbnNlIFRpbWUgRGlzdHJpYnV0aW9uPC9oMj4KCjxpbnB1dCB0eXBlPSJmaWxlIiBpZD0iZmlsZXMiIG5hbWU9ImZpbGVzW10iIG11bHRpcGxlIC8+Cgo8cHJlIGlkPSJmaWxlRGlzcGxheUFyZWEiPlBsZWFzZSBzZWxlY3QgZmlsZShzKSBhYm92ZS48L3ByZT4KCjwhLS1EaXYgdGhhdCB3aWxsIGhvbGQgdGhlIGNoYXJ0LS0+CjxkaXYgaWQ9ImNoYXJ0X2RpdiI+Tm9uZSBMb2FkZWQ8L2Rpdj4KCkxhdGVuY3kgdGltZSB1bml0czoKPHNlbGVjdCBuYW1lPSJ1bml0cyIgc2l6ZT0iMSIgaWQ9InRpbWVVbml0U2VsZWN0aW9uIiBvbkNoYW5nZT0idGltZVVuaXRzU2VsZWN0ZWQoKSI+CiAgICA8b3B0aW9uIHZhbHVlPSJMYXRlbmN5IChzZWNvbmRzKSI+c2Vjb25kczwvb3B0aW9uPgogICAgPG9wdGlvbiBzZWxlY3RlZCB2YWx1ZT0iTGF0ZW5jeSAobWlsbGlzZWNvbmRzKSI+bWlsbGlzZWNvbmRzPC9vcHRpb24+CiAgICA8b3B0aW9uIHZhbHVlPSJMYXRlbmN5IChxcykiPm1pY3Jvc2Vjb25kczwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0iTGF0ZW5jeSAobmFub3NlY29uZHMpIj5uYW5vc2Vjb25kczwvb3B0aW9uPgo8L3NlbGVjdD4KPGJ1dHRvbiB0eXBlPSdidXR0b24nIG9uY2xpY2s9J2RvRXhwb3J0KGV2ZW50KSc+RXhwb3J0IEltYWdlPC9idXR0b24+CgombmJzcDsgJm5ic3A7ICZuYnNwOyAmbmJzcDsKPHA+ClBlcmNlbnRpbGUgcmFuZ2U6Cgo8aW5wdXQgdHlwZT0icmFuZ2UiIGNsYXNzPSJzbGlkZXItd2lkdGg1MDAiCiAgICAgICBtaW49IjEiIG1heD0iOCIgdmFsdWU9IjciIHN0ZXA9IjEiCiAgICAgICB3aWR0aD0iMzAwcHgiCiAgICAgICBvbmNoYW5nZT0ic2hvd1ZhbHVlKHRoaXMudmFsdWUpIiAvPgo8c3BhbiBpZD0icGVyY2VudGlsZVJhbmdlIj45OS45OTk5OSU8L3NwYW4+CjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4KICAgIGZ1bmN0aW9uIHNob3dWYWx1ZShuZXdWYWx1ZSkgewogICAgICAgIHZhciB4ID0gTWF0aC5wb3coMTAsIG5ld1ZhbHVlKTsKICAgICAgICB2YXIgcGVyY2VudGlsZSA9IDEwMC4wIC0gKDEwMC4wIC8geCk7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBlcmNlbnRpbGVSYW5nZSIpLmlubmVySFRNTD1wZXJjZW50aWxlICsgIiUiOwogICAgICAgIG1heFBlcmNlbnRpbGUgPSB4OwogICAgICAgIGRyYXdDaGFydCgpOwogICAgICAgIHJldHVybiB7dHlwZWQ6ICcnfTsKICAgIH0KPC9zY3JpcHQ+CjwvcD4KPHA+CiAgICA8YnI+CioqKiBOb3RlOiBJbnB1dCBmaWxlcyBhcmUgZXhwZWN0ZWQgdG8gYmUgaW4gdGhlIC5oZ3JtIGZvcm1hdCBwcm9kdWNlZCBieQpIaXN0b2dyYW1Mb2dQcm9jZXNzb3IsIG9yIHRoZSBwZXJjZW50aWxlIG91dHB1dCBmb3JtYXQgZm9yIEhkckhpc3RvZ3JhbS4KU2VlIGV4YW1wbGUgZmlsZSBmb3JtYXQKICAgIDxhIGhyZWY9Imh0dHBzOi8vZ2l0aHViLmNvbS9IZHJIaXN0b2dyYW0vSGRySGlzdG9ncmFtL2Jsb2IvbWFzdGVyL0dvb2dsZUNoYXJ0c0V4YW1wbGUvZXhhbXBsZTEudHh0Ij5oZXJlPC9hPgo8L3A+CjwhLS08aDQ+RXhwZWN0ZWQgU2VydmljZSBMZXZlbDo8L2g0Pi0tPgo8IS0tPGlucHV0IHR5cGU9ImNoZWNrYm94IiBuYW1lPSJFU0wiIHZhbHVlPSJFU0wiPlBsb3QgRXhwZWN0ZWQgU2VydmljZSBMZXZlbDxicj4tLT4KPCEtLVBlcmNlbnRpbGU6LS0+CjwhLS08aW5wdXQgdHlwZT0idGV4dCIgaWQ9IkVTTFBlcmNlbnRpbGUwIiBuYW1lPSJFU0xQZXJjZW50aWxlMCIgc2l6ZT0iNiIgdmFsdWUgPSA5MCAvPi0tPgo8IS0tJSAmbmJzcCAmbmJzcCAmbmJzcCBMaW1pdDotLT4KPCEtLTxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iRVNMTGltaXQwIiBuYW1lPSJFU0xMaW1pdDAiIHNpemU9IjEyIi8+LS0+CjwhLS08YnI+LS0+CjwhLS1QZXJjZW50aWxlOi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xQZXJjZW50aWxlMSIgbmFtZT0iRVNMUGVyY2VudGlsZTEiIHNpemU9IjYiIHZhbHVlID0gOTkgLz4tLT4KPCEtLSUgJm5ic3AgJm5ic3AgJm5ic3AgTGltaXQ6LS0+CjwhLS08aW5wdXQgdHlwZT0idGV4dCIgaWQ9IkVTTExpbWl0MSIgbmFtZT0iRVNMTGltaXQxIiBzaXplPSIxMiIvPi0tPgo8IS0tPGJyPi0tPgo8IS0tUGVyY2VudGlsZTotLT4KPCEtLTxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iRVNMUGVyY2VudGlsZTIiIG5hbWU9IkVTTFBlcmNlbnRpbGUyIiBzaXplPSI2IiB2YWx1ZSA9IDk5Ljk5IC8+LS0+CjwhLS0lICZuYnNwICZuYnNwICZuYnNwIExpbWl0Oi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xMaW1pdDIiIG5hbWU9IkVTTExpbWl0MiIgc2l6ZT0iMTIiLz4tLT4KPCEtLTxicj4tLT4KPCEtLVBlcmNlbnRpbGU6LS0+CjwhLS08aW5wdXQgdHlwZT0idGV4dCIgaWQ9IkVTTFBlcmNlbnRpbGUzIiBuYW1lPSJFU0xQZXJjZW50aWxlMiIgc2l6ZT0iNiIgdmFsdWU9IjEwMC4wIiByZWFkb25seS8+LS0+CjwhLS0lICZuYnNwICZuYnNwICZuYnNwIExpbWl0Oi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xMaW1pdDMiIG5hbWU9IkVTTExpbWl0MiIgc2l6ZT0iMTIiLz4tLT4KCicnJwoKc3VtbWFyeV9odG1sXzMgPSAnJyc8L2JvZHk+CjwvaHRtbD4KJycnCgojIDxoMj48YSBocmVmPSJodHRwczovL3dmb3VjaGUuZ2l0aHViLmlvL1R1bGlwLWRvY3MiPl9fREVTQzFfXzwvYT4gLyBfX0RFU0MyX188L2gyPgojIDxoMj5fX0RFU0MxX18gLyBfX0RFU0MyX188L2gyPgoKaGVhZGVyID0gJycnPCFET0NUWVBFIGh0bWw+CjxodG1sPgoKPHN0eWxlPgp0YWJsZSwgdGgsIHRkIHsKICBib3JkZXI6MXB4IHNvbGlkIGJsYWNrOyBmb250LXNpemU6MTZweDsgdGV4dC1hbGlnbjogY2VudGVyOwp9CnRoOm50aC1jaGlsZChuKzE0KSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTVFNEUyOwp9CnRkOm50aC1jaGlsZChuKzE0KSB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRTVFNEUyOwp9Cjwvc3R5bGU+Cgo8Ym9keT4KCjxoMj48YSBocmVmPSJodHRwczovL3dmb3VjaGUuZ2l0aHViLmlvL1R1bGlwLWRvY3MiPl9fREVTQzFfXzwvYT4gLyBfX0RFU0MyX188L2gyPgoKPHRhYmxlIHN0eWxlPSJ3aWR0aDoxMDAlIj4KICA8dHI+CiAgICA8dGg+QmVuY2htYXJrPC90aD4KICAgIDx0aD5SdW4gSWQ8L3RoPgogICAgPHRoPiNOPC90aD4KICAgIDx0aD4jRjwvdGg+CiAgICA8dGg+RHVyYXRpb248L3RoPgogICAgPHRoPkFwczwvdGg+CiAgICA8dGg+QXZnX1J0PC90aD4KICAgIDx0aD5TdGRldjwvdGg+CiAgICA8dGg+TWluX1J0PC90aD4KICAgIDx0aD45MHBfUnQ8L3RoPgogICAgPHRoPjk5cF9SdDwvdGg+CiAgICA8dGg+TWF4X1J0PC90aD4KICAgIDx0aD5NYXhfUnR0PC90aD4KICAgIDx0aD5BUVM8L3RoPgogICAgPHRoPk1RUzwvdGg+CiAgICA8dGg+QVdUPC90aD4KICAgIDx0aD5NV1Q8L3RoPgogICAgPHRoPkNQVV9UPC90aD4KICAgIDx0aD5DUFU8L3RoPgogICAgPHRoPk1FTTwvdGg+CiAgPC90cj4KJycnCgpiZW5jaG1hcmtfY29sdW1ucyA9ICcnJwogIDx0cj4KICAgIDx0aD5CZW5jaG1hcms8L3RoPgogICAgPHRoPlJ1biBJZDwvdGg+CiAgICA8dGg+I048L3RoPgogICAgPHRoPiNGPC90aD4KICAgIDx0aD5EdXJhdGlvbjwvdGg+CiAgICA8dGg+QXBzPC90aD4KICAgIDx0aD5BdmdfUnQ8L3RoPgogICAgPHRoPlN0ZGV2PC90aD4KICAgIDx0aD5NaW5fUnQ8L3RoPgogICAgPHRoPjkwcF9SdDwvdGg+CiAgICA8dGg+OTlwX1J0PC90aD4KICAgIDx0aD5NYXhfUnQ8L3RoPgogICAgPHRoPk1heF9SdHQ8L3RoPgogICAgPHRoPkFRUzwvdGg+CiAgICA8dGg+TVFTPC90aD4KICAgIDx0aD5BV1Q8L3RoPgogICAgPHRoPk1XVDwvdGg+CiAgICA8dGg+Q1BVX1Q8L3RoPgogICAgPHRoPkNQVTwvdGg+CiAgICA8dGg+TUVNPC90aD4KICA8L3RyPgonJycKCmJlbmNobWFya19oZWFkZXIgPSAnJycKICA8dHI+CiAgICA8dGQ+JXM8L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgPC90cj4KJycnCgpiZW5jaG1hcmtfZW1wdHlfcm93ID0gJycnCiAgPHRyPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICA8L3RyPgonJycKCmJlbmNobWFya19kZXRhaWxfcm93ID0gJycnCiAgPHRyPgogICAgPHRkPiVzPC90ZD4KICAgIDx0ZD4lZDwvdGQ+CiAgICA8dGQ+JWQ8L3RkPgogICAgPHRkPiVkPC90ZD4KICAgIDx0ZD4lczwvdGQ+CiAgICA8dGQ+JS4zZjwvdGQ+CiAgICA8dGQ+JS4zZiBtczwvdGQ+CiAgICA8dGQ+JS4xZiBtczwvdGQ+CiAgICA8dGQ+JS4xZiBtczwvdGQ+CiAgICA8dGQ+JS4xZiBtczwvdGQ+CiAgICA8dGQ+JS4xZiBtczwvdGQ+CiAgICA8dGQ+JS4xZiBtczwvdGQ+CiAgICA8dGQ+JXM8L3RkPgogICAgPHRkPiUuMWY8L3RkPgogICAgPHRkPiVkPC90ZD4KICAgIDx0ZD4lLjFmPC90ZD4KICAgIDx0ZD4lLjFmPC90ZD4KICAgIDx0ZD4lczwvdGQ+CiAgICA8dGQ+JS4xZjwvdGQ+CiAgICA8dGQ+JS4xZjwvdGQ+CiAgPC90cj4KJycnCgpiZW5jaG1hcmtfc3VtbWFyeV9yb3cgPSAnJycKICA8dHI+CiAgICA8dGQ+JXM8L3RkPgogICAgPHRkPiVzPC90ZD4KICAgIDx0ZD48Yj4lZDwvYj48L3RkPgogICAgPHRkPjxiPjx0YWcxPiVkPC90YWcxPjwvYj48L3RkPgogICAgPHRkPjxiPiVzPC9iPjwvdGQ+CiAgICA8dGQ+PGI+PHRhZzI+JS4zZjwvdGFnMj48L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjNmIG1zPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZiBtczwvYj48L3RkPgogICAgPHRkPjxiPiUuMWYgbXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmIG1zPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZiBtczwvYj48L3RkPgogICAgPHRkPjxiPiUuMWYgbXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lczwvYj48L3RkPgogICAgPHRkPjxiPiUuMWY8L2I+PC90ZD4KICAgIDx0ZD48Yj4lZDwvYj48L3RkPgogICAgPHRkPjxiPiUuMWY8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZjwvYj48L3RkPgogIDwvdHI+CicnJwoKdHJhaWxlciA9ICcnJwo8L3RhYmxlPgo8L2JvZHk+CjwvaHRtbD4KJycnCgpjaGFydHNfaHRtbCA9ICcnJwo8aDI+QWN0aW9ucyBwZXIgU2Vjb25kPC9oMj4KICA8ZGl2IGlkPSJtYWluIiBzdHlsZT0id2lkdGg6IDEwMCU7aGVpZ2h0OjQwMHB4OyI+PC9kaXY+CiAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2VjaGFydHMvNS42LjAvZWNoYXJ0cy5taW4uanMiPjwvc2NyaXB0PgogIDxzY3JpcHQgc3JjPSJfX0pTX1RfQ0hBUlRfXyI+PC9zY3JpcHQ+CjxoMj5SZXNwb25zZSBUaW1lcyAobXMpPC9oMj4KICA8ZGl2IGlkPSJtYWluX3AiIHN0eWxlPSJ3aWR0aDogMTAwJTtoZWlnaHQ6NDAwcHg7Ij48L2Rpdj4KICA8c2NyaXB0IHNyYz0iX19KU19QX0NIQVJUX18iPjwvc2NyaXB0PgonJycKCmNoYXJ0X3RfaHRtbCA9ICcnJwp2YXIgbXlDaGFydDEgPSBlY2hhcnRzLmluaXQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21haW4nKSk7Cgp2YXIgZGF0YSA9ICBfX0RBVEFfXzsKCnZhciBvcHRpb24gPSB7CiAgbGVnZW5kOiB7fSwKICB0b29sdGlwOiB7CiAgICB0cmlnZ2VyOiAnYXhpcycsCiAgfSwKICBkYXRhc2V0OiB7CiAgICBzb3VyY2U6ZGF0YSwKICAgIGRpbWVuc2lvbnM6IFsndGltZXN0YW1wJywgJ3NlbnNvcjEnLCAnc2Vuc29yMiddLAogIH0sCiAgeEF4aXM6IHsgdHlwZTogJ3RpbWUnIH0sCiAgeUF4aXM6IHsgfSwKICBzZXJpZXM6IFsKICB7CiAgICAgbmFtZTogJ0FjdGlvbnMvcycsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjEnIC8vIHJlZmVyIHNlbnNvciAxIHZhbHVlIAogICAgIH0KICB9LHsKICAgICBuYW1lOiAnRmFpbHVyZXMvcycsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjInCiAgfQp9XQp9OwpteUNoYXJ0MS5zZXRPcHRpb24ob3B0aW9uKTsKJycnCgpjaGFydF9wX2h0bWwgPSAnJycKdmFyIG15Q2hhcnQyID0gZWNoYXJ0cy5pbml0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluX3AnKSk7Cgp2YXIgZGF0YSA9ICBfX0RBVEFfXzsKCnZhciBvcHRpb24gPSB7CiAgbGVnZW5kOiB7fSwKICB0b29sdGlwOiB7CiAgICB0cmlnZ2VyOiAnYXhpcycsCiAgfSwKICBkYXRhc2V0OiB7CiAgICBzb3VyY2U6ZGF0YSwKICAgIGRpbWVuc2lvbnM6IFsndGltZXN0YW1wJywgJ3NlbnNvcjEnLCAnc2Vuc29yMicsICdzZW5zb3IzJywgJ3NlbnNvcjQnLCAnc2Vuc29yNScsICdzZW5zb3I2J10sCiAgfSwKICB4QXhpczogeyB0eXBlOiAndGltZScgfSwKICB5QXhpczogeyB9LAogIHNlcmllczogWwogIHsKICAgICBuYW1lOiAnTWF4JywKICAgICB0eXBlOiAnbGluZScsCiAgICAgc21vb3RoOiB0cnVlLAogICAgIGVuY29kZTogewogICAgICAgeDogJ3RpbWVzdGFtcCcsCiAgICAgICB5OiAnc2Vuc29yNicgLy8gcmVmZXIgc2Vuc29yIDEgdmFsdWUKICAgICB9CiAgfSx7CiAgICAgbmFtZTogJ3A5OScsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjUnIC8vIHJlZmVyIHNlbnNvciAxIHZhbHVlCiAgICAgfQogIH0sewogICAgIG5hbWU6ICdwOTUnLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3I0JyAvLyByZWZlciBzZW5zb3IgMSB2YWx1ZQogICAgIH0KCiAgfSx7CiAgICAgbmFtZTogJ3A5MCcsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjMnIC8vIHJlZmVyIHNlbnNvciAxIHZhbHVlCiAgICAgfQoKICB9LHsKICAgICBuYW1lOiAnQXZnJywKICAgICB0eXBlOiAnbGluZScsCiAgICAgc21vb3RoOiB0cnVlLAogICAgIGVuY29kZTogewogICAgICAgeDogJ3RpbWVzdGFtcCcsCiAgICAgICB5OiAnc2Vuc29yMicKICAgICB9CiAgfSx7CiAgICAgbmFtZTogJ01pbicsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjEnCiAgfQp9XQp9OwpteUNoYXJ0Mi5zZXRPcHRpb24ob3B0aW9uKTsKCndpbmRvdy5vbnJlc2l6ZSA9IGZ1bmN0aW9uKCkgewogIG15Q2hhcnQxLnJlc2l6ZSgpOwogIG15Q2hhcnQyLnJlc2l6ZSgpOwp9OwonJycKCmNsYXNzIFN1bW1hcnk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5udW1fYWN0aW9ucyA9IDAKICAgICAgICBzZWxmLm51bV9mYWlsZWQgPSAwCiAgICAgICAgc2VsZi5kdXJhdGlvbiA9IDAuMAogICAgICAgIHNlbGYubWluX3J0ID0gMTAwMDAwMDAwMC4wCiAgICAgICAgc2VsZi5tYXhfcnQgPSAwLjAKICAgICAgICBzZWxmLm1heF9ydF90cyA9ICIiCiAgICAgICAgc2VsZi5tZW0gPSAwLjAKICAgICAgICBzZWxmLmNwdSA9IDAuMAogICAgICAgIHNlbGYubWF4X2F3dCA9IDAuMAogICAgICAgIHNlbGYubWF4X3d0ID0gMC4wCiAgICAgICAgc2VsZi5hdmdfcXMgPSAwLjAKICAgICAgICBzZWxmLm1heF9xcyA9IDAKICAgICAgICBzZWxmLm5hbWUgPSAiIgogICAgICAgIHNlbGYuY3B1X3RpbWVfbnMgPSAwCiAgICAgICAgc2VsZi5jaGFydF90X2xpc3QgPSBbXSAgICMgWycyMDE4LTA0LTEwVDIwOjQwOjMzLjEwMCcsIDExMDAsIDBdCiAgICAgICAgc2VsZi5jaGFydF9wX2xpc3QgPSBbXSAgICMgWycyMDE4LTA0LTEwVDIwOjQwOjMzWicsIDEsIDUsIDEwLCAyMCwgMjUsIDMwXQoKZGVmIGNyZWF0ZVJlcG9ydChmaWxlbmFtZSwgdGV4dCk6CgogICAgY3dkID0gb3MuZ2V0Y3dkKCkKICAgIGlmIG9zLnBhdGguaXNkaXIoImJ1aWxkL3JlcG9ydHMvdHVsaXAiKToKICAgICAgICBvcy5jaGRpcigiYnVpbGQvcmVwb3J0cy90dWxpcCIpCgogICAgcHJpbnQoIlxuT3V0cHV0IGZpbGVuYW1lID0gIiArIGZpbGVuYW1lKQoKICAgIGlmIHRleHRbMF0gPT0gJ3snOgogICAgICAgIGNvbmZpZ19maWxlbmFtZSA9ICIiCiAgICBlbHNlOgogICAgICAgIGNvbmZpZ19maWxlbmFtZSA9IHRleHQKCiAgICBqaGggPSB7fQogICAganNzID0ge30KCiAgICBwcmludF9kZXRhaWxfcm93cyA9IFRydWUKCiAgICBnbG9iYWwgbmFtZTJzCiAgICBnbG9iYWwgbmFtZTJzX2xpc3QKICAgIGdsb2JhbCBiZW5jaG1hcmtfaWQKICAgIG5hbWUycyA9ICIiCiAgICBuYW1lMnNfbGlzdCA9IFtdCiAgICBiZW5jaG1hcmtfaWQgPSAwCgogICAgc20gPSBOb25lCiAgICBqaCA9IEhpc3RvZ3JhbSgxLCAzNjAwKjEwMDAqMTAwMCwgMykKICAgIGZpbGVPYmogPSBvcGVuKGZpbGVuYW1lKQogICAgamIgPSBqc29uLmxvYWQoZmlsZU9iaiwgb2JqZWN0X3BhaXJzX2hvb2s9T3JkZXJlZERpY3QpCiAgICB2ZXJzaW9uID0gamJbJ3ZlcnNpb24nXQogICAgZGVzYzEgPSAnVHVsaXAgJyArIHZlcnNpb24KICAgIHJiID0gamJbInJlc3VsdHMiXQoKICAgIHJlcG9ydF9mbiA9IGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJyZXBvcnRfZmlsZW5hbWUiXQogICAgcmVwb3J0X2ZoID0gb3BlbihyZXBvcnRfZm4sICJ3KyIpCgogICAgZ2xvYmFsIHJlcG9ydF9kbgogICAgcmVwb3J0X2RuID0gb3MucGF0aC5zcGxpdGV4dChyZXBvcnRfZm4pWzBdCiAgICB0cnk6CiAgICAgICAgb3MubWFrZWRpcnMocmVwb3J0X2RuKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKCiAgICBkZWYgb2RpcihmaWxlbmFtZSk6CiAgICAgICAgZ2xvYmFsIHJlcG9ydF9kbgogICAgICAgIHJldHVybiBvcy5wYXRoLmpvaW4ob3MuZ2V0Y3dkKCksIHJlcG9ydF9kbiwgZmlsZW5hbWUpCgogICAgZGVmIG9kaXJIdG1sKGZpbGVuYW1lKToKICAgICAgICBnbG9iYWwgcmVwb3J0X2RuCiAgICAgICAgcmV0dXJuIHJlcG9ydF9kbiArICIvIiArIGZpbGVuYW1lCgogICAgZGVmIG5hbWVfdG9faHJlZihuYW1lKToKICAgICAgICBocmVmID0gIl8iICsgbmFtZS5sb3dlcigpLnJlcGxhY2UoIiAiLCAiXyIpCiAgICAgICAgaGZpbGUgPSBvcy5wYXRoLnNwbGl0ZXh0KGNvbmZpZ19maWxlbmFtZSlbMF0gKyAiLmh0bWwiCiAgICAgICAgcmV0dXJuICI8YSBocmVmPSclcyMlcyc+IiUoaGZpbGUsIGhyZWYpICsgbmFtZSArICI8L2E+IgoKICAgIGlmIGxlbihjb25maWdfZmlsZW5hbWUpID4gMDoKICAgICAgICBkZXNjMiA9ICI8YSBocmVmPSclcyc+IiUob3MucGF0aC5zcGxpdGV4dChjb25maWdfZmlsZW5hbWUpWzBdICsgIi5odG1sIikKICAgIGVsc2U6CiAgICAgICAgZGVzYzIgPSAiIgoKICAgIGlmIGxlbihjb25maWdfZmlsZW5hbWUpID4gMDoKICAgICAgICBkZXNjMiArPSBqYlsiY29uZmlnIl1bImFjdGlvbnMiXVsiZGVzY3JpcHRpb24iXSArICI8L2E+IC8gIiArIGpiWyJ0aW1lc3RhbXAiXVs6LTNdCiAgICBlbHNlOgogICAgICAgIGRlc2MyICs9IGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJkZXNjcmlwdGlvbiJdICsgIiAvICIgKyBqYlsidGltZXN0YW1wIl1bOi0zXQoKICAgIHByaW50KCJSZXBvcnQgZmlsZW5hbWUgPSAiICsgcmVwb3J0X2ZuKQoKICAgIGRlZiBwcmludGYocyk6CiAgICAgICAgcmVwb3J0X2ZoLndyaXRlKHMpCgogICAgZGVmIGFjdGlvbk5hbWUocyk6CiAgICAgICAgcmV0dXJuIHMuc3BsaXQoIiwiKVswXS5zdHJpcCgpCgogICAgZGVmIGFjdGlvbkRlc2Mocyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gcy5zcGxpdCgiLCIpWzFdLnN0cmlwKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiAiIgoKICAgIGRlZiBzdHJfZnJvbV9jcHVfdGltZV9ucyh2X25zKToKICAgICAgICByID0gc3RyKGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPXZfbnMvMTAwMDAwMDAwMC4wKSkgICNbOi01XQogICAgICAgIGlmICcuJyBpbiByOgogICAgICAgICAgICByID0gcls6LTVdCiAgICAgICAgcmV0dXJuIHIKCiAgICBkZWYgcHJpbnRfZ2xvYmFsX3N1bW1hcnkoKToKICAgICAgICBnbG9iYWwgbmFtZTJzCiAgICAgICAgZ2xvYmFsIG5hbWUyc19saXN0CiAgICAgICAgZ2xvYmFsIGJlbmNobWFya19pZAoKICAgICAgICBhdmdfYXBzID0gMC4wIGlmIHNtLm5hbWUgaW4gWyJvblN0YXJ0IiwgIm9uU3RvcCJdIGVsc2Ugc20ubnVtX2FjdGlvbnMvc20uZHVyYXRpb24KICAgICAgICBpZiBzbS5uYW1lIGluIFsib25TdGFydCIsICJvblN0b3AiXToKICAgICAgICAgICAgY3B1X3QgPSAiMDowMDowMCIKICAgICAgICAgICAgc20uY3B1ID0gMC4wCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3B1X3QgPSBzdHJfZnJvbV9jcHVfdGltZV9ucyhzbS5jcHVfdGltZV9ucykKCiAgICAgICAgc3RhdHNGaWxlbmFtZSA9ICclc18lZC5odG1sJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHN0YXRzRmlsZW5hbWVIdG1sID0gJyVzXyVkLmh0bWwnJShvZGlySHRtbChyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHRleHQgPSAiPGEgaHJlZj0nJXMnPiVzPC9hPiIlKHN0YXRzRmlsZW5hbWVIdG1sLCJbU3VtbWFyeV0iKQogICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0oc3RhdHNGaWxlbmFtZSkKICAgICAgICBwcmludFN0cmVhbS5wcmludChzdW1tYXJ5X2h0bWxfMSkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIGZ1bmN0aW9uIGRyYXdJbml0aWFsQ2hhcnQoKSB7JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgICAgICAvLyBDb25uZWN0IHRoZSBjaG9vc2UgZmlsZXMgYnV0dG9uOicpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoIiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVNlbGVjdCwgZmFsc2UpOyIpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICAgICAgLy8gTG9hZCBzb21lIHN0YXRpYyBleGFtcGxlIGRhdGE6JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBpZHggPSAwCiAgICAgICAgYWN0aW9uc1N0cmluZyA9ICIiCiAgICAgICAgaGlzdG9zU3RyaW5nID0gIiIKICAgICAgICBmb3Iga2V5IGluIGpzcy5rZXlzKCk6CiAgICAgICAgICAgIGlkeCArPSAxCiAgICAgICAgICAgIHNteCA9IGpzc1trZXldCiAgICAgICAgICAgIGpoeCA9IGpoaFtrZXldCiAgICAgICAgICAgIGlmIGxlbihhY3Rpb25zU3RyaW5nKSA+IDA6CiAgICAgICAgICAgICAgICBhY3Rpb25zU3RyaW5nICs9ICcsICcKICAgICAgICAgICAgICAgIGhpc3Rvc1N0cmluZyArPSAnLCAnCiAgICAgICAgICAgIGFjdGlvbnNTdHJpbmcgKz0gIidBJXMnIiUoa2V5KQogICAgICAgICAgICBoaXN0b3NTdHJpbmcgKz0gImRhdGElZFN0ciIlKGlkeCkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB2YXIgZGF0YSVkU3RyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2I2RhdGFfJWQiKS5pbm5lckhUTUwudHJpbSgpOyclKGlkeCxpZHgpKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBpZiBpZHggPiAxOgogICAgICAgICAgICBhY3Rpb25zU3RyaW5nICs9ICcsICcgKyAiJ1MnIgogICAgICAgICAgICBoaXN0b3NTdHJpbmcgKz0gJywgJyArICJkYXRhJWRTdHIiJSgwKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIHZhciBkYXRhJWRTdHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJkaXYjZGF0YV8lZCIpLmlubmVySFRNTC50cmltKCk7JyUoMCwwKSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB2YXIgaGlzdG9zID0gWyVzXTsnJShoaXN0b3NTdHJpbmcpKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIHByaW50U3RyZWFtLnByaW50KCcgICAgdmFyIG5hbWVzID0gWyVzXTsnJShhY3Rpb25zU3RyaW5nKSkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICBzZXRDaGFydERhdGEobmFtZXMsIGhpc3Rvcyk7JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIGRyYXdDaGFydCgpOycpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB9JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICB0Q2hhcnRGaWxlbmFtZSA9ICclc18lZF90LmpzJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHRDaGFydEZpbGVuYW1lSHRtbCA9ICclc18lZF90LmpzJyUob2Rpckh0bWwocmVwb3J0X2ZuLnNwbGl0KCcuJylbMF0pLGJlbmNobWFya19pZCkKICAgICAgICBwQ2hhcnRGaWxlbmFtZSA9ICclc18lZF9wLmpzJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHBDaGFydEZpbGVuYW1lSHRtbCA9ICclc18lZF9wLmpzJyUob2Rpckh0bWwocmVwb3J0X2ZuLnNwbGl0KCcuJylbMF0pLGJlbmNobWFya19pZCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgKICAgICAgICAgICAgc3VtbWFyeV9odG1sXzIKICAgICAgICAgICAgICAgIC5yZXBsYWNlKCJfX0NIQVJUU19URVhUX18iLAogICAgICAgICAgICAgICAgICAgIGNoYXJ0c19odG1sCiAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgiX19KU19UX0NIQVJUX18iLG9zLnBhdGguYmFzZW5hbWUodENoYXJ0RmlsZW5hbWVIdG1sKSkKICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCJfX0pTX1BfQ0hBUlRfXyIsb3MucGF0aC5iYXNlbmFtZShwQ2hhcnRGaWxlbmFtZUh0bWwpKSkKICAgICAgICAgICAgICAgICkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgaWR4ID0gMAogICAgICAgIGZvciBrZXkgaW4ganNzLmtleXMoKToKICAgICAgICAgICAgaWR4ICs9IDEKICAgICAgICAgICAgc214ID0ganNzW2tleV0KICAgICAgICAgICAgamh4ID0gamhoW2tleV0KICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJzxkaXYgaWQ9ImRhdGFfJWQiIGNsYXNzPSJoaXN0byI+JyUoaWR4KSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgICAgIGpoeC5vdXRwdXRQZXJjZW50aWxlRGlzdHJpYnV0aW9uKHByaW50U3RyZWFtLCAxMDAwLjApCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50KCc8L2Rpdj4nKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJzxkaXYgaWQ9ImRhdGFfMCIgY2xhc3M9Imhpc3RvIj4nKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIGpoLm91dHB1dFBlcmNlbnRpbGVEaXN0cmlidXRpb24ocHJpbnRTdHJlYW0sIDEwMDAuMCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnPC9kaXY+JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoc3VtbWFyeV9odG1sXzMpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgIHByaW50U3RyZWFtLmNsb3NlKCkKCiAgICAgICAgIyBBY3Rpb25zL3MgY2hhcnQKICAgICAgICAjY2hhcnRfdF9saXN0ID0gWwogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQwOjMzLjEwMCcsIDExMDAsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQwOjUzLjIwMCcsIDEwMDIsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQxOjAzLjMwMCcsIDExMDQsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQ0OjAzLjQwMCcsIDEyMDUuNSwgMF0sCiAgICAgICAgIyAgICBbJzIwMTgtMDQtMTBUMjA6NDU6MDMuNTAwJywgMTMwNiwgMF0KICAgICAgICAjXQogICAgICAgIGNoYXJ0X3BfbGlzdCA9IFsKICAgICAgICAgICAgWycyMDE4LTA0LTEwVDIwOjQwOjMzWicsIDEsIDUsIDEwLCAyMCwgMjUsIDMwIF0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0MDo1M1onLCAyLCA2LCAxNSwgMjUsIDMwLCAzNV0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0MTowM1onLCAyLCA1LCAyMCwgMzAsIDM1LCA0MF0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0NDowM1onLCAzLCA3LCAxMiwgMjIsIDMwLCAzMl0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0NTowM1onLCAyLCAxMCwgMTMsIDIzLCAzMCwgMzNdCiAgICAgICAgXQogICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0odENoYXJ0RmlsZW5hbWUpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoY2hhcnRfdF9odG1sLnJlcGxhY2UoIl9fREFUQV9fIiwoIiVzIiUoc20uY2hhcnRfdF9saXN0KSkucmVwbGFjZSgidSciLCInIikpKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIHByaW50U3RyZWFtLmZsdXNoKCkKICAgICAgICBwcmludFN0cmVhbS5jbG9zZSgpCgogICAgICAgICMgUmVzcG9uc2UgVGltZSAobXMpIGNoYXJ0CiAgICAgICAgcHJpbnRTdHJlYW0gPSBQcmludFN0cmVhbShwQ2hhcnRGaWxlbmFtZSkKICAgICAgICBwcmludFN0cmVhbS5wcmludChjaGFydF9wX2h0bWwucmVwbGFjZSgiX19EQVRBX18iLCgiJXMiJShzbS5jaGFydF9wX2xpc3QpKS5yZXBsYWNlKCJ1JyIsIiciKSkpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgIHByaW50U3RyZWFtLmNsb3NlKCkKCiAgICAgICAgaHRtbCA9IGJlbmNobWFya19zdW1tYXJ5X3JvdyUobmFtZTJzLHRleHQsc20ubnVtX2FjdGlvbnMsc20ubnVtX2ZhaWxlZCxzdHIoZGF0ZXRpbWUudGltZWRlbHRhKHNlY29uZHM9aW50KHNtLmR1cmF0aW9uKSkpLGF2Z19hcHMsamguZ2V0TWVhbigpLzEwMDAuMCxqaC5nZXRTdGREZXZpYXRpb24oKS8xMDAwLjAsc20ubWluX3J0LGpoLmdldFZhbHVlQXRQZXJjZW50aWxlKDkwLjApLzEwMDAuMCxqaC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5OS4wKS8xMDAwLjAsc20ubWF4X3J0LHNtLm1heF9ydF90c1s4Ol0sc20uYXZnX3FzLHNtLm1heF9xcyxzbS5tYXhfYXd0LHNtLm1heF93dCxjcHVfdCxzbS5jcHUsc20ubWVtKQogICAgICAgIGlmIG5vdCBwcmludF9kZXRhaWxfcm93czoKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPGI+IiwiIikKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC9iPiIsIiIpCiAgICAgICAgIyBWYWxpZGF0aW9uOiAjRgogICAgICAgIGlmIHNtLm51bV9mYWlsZWQgPiAwOgogICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8dGFnMT4iLCI8bWFyaz4iKQogICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8L3RhZzE+IiwiPC9tYXJrPiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPHRhZzE+IiwiIikKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC90YWcxPiIsIiIpCiAgICAgICAgIyBWYWxpZGF0aW9uOiBBdmdfQVBTCiAgICAgICAgI3ByaW50KHNtLm5hbWUpCiAgICAgICAgaWYgImFwc19yYXRlIiBpbiBqYlsiY29uZmlnIl1bImJlbmNobWFya3MiXVtzbS5uYW1lXS5rZXlzKCk6CiAgICAgICAgICAgIHRhcmdldF9hcHMgPSBqYlsiY29uZmlnIl1bImJlbmNobWFya3MiXVtzbS5uYW1lXVsiYXBzX3JhdGUiXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhcmdldF9hcHMgPSAwLjAKICAgICAgICBhcHNfcmF0ZV9zdGVwX2NoYW5nZSA9IDAuMAogICAgICAgIGlmICJhcHNfcmF0ZV9zdGVwX2NoYW5nZSIgaW4gamJbImNvbmZpZyJdWyJiZW5jaG1hcmtzIl1bc20ubmFtZV0ua2V5cygpOgogICAgICAgICAgICBhcHNfcmF0ZV9zdGVwX2NoYW5nZSA9IGpiWyJjb25maWciXVsiYmVuY2htYXJrcyJdW3NtLm5hbWVdWyJhcHNfcmF0ZV9zdGVwX2NoYW5nZSJdCiAgICAgICAgaWYgYXBzX3JhdGVfc3RlcF9jaGFuZ2UgPT0gMC4wIGFuZCB0YXJnZXRfYXBzID4gMC4wOgogICAgICAgICAgICBkZWx0YV9wZXJjZW50YWdlX2FwcyA9IDEwMC4wKmFicyh0YXJnZXRfYXBzLWF2Z19hcHMpL3RhcmdldF9hcHMKICAgICAgICAgICAgaWYgZGVsdGFfcGVyY2VudGFnZV9hcHMgPiAxLjU6CiAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8dGFnMj4iLCI8bWFyaz4iKQogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC90YWcyPiIsIjwvbWFyaz4iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPHRhZzI+IiwiIikKICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcyPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQogICAgICAgIHByaW50ZihodG1sKQogICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICBuYW1lMnMgPSBuYW1lMnNfbGlzdFswXQogICAgICAgICAgICBkZWwgbmFtZTJzX2xpc3RbMF0KCiAgICBkZWYgcHJpbnRfYWN0aW9uX3N1bW1hcnkoKToKICAgICAgICBnbG9iYWwgbmFtZTJzCiAgICAgICAgZ2xvYmFsIG5hbWUyc19saXN0CiAgICAgICAgZ2xvYmFsIGJlbmNobWFya19pZAogICAgICAgIHBhZ2VfaWQgPSAwCiAgICAgICAgbnVtX2tleXMgPSBsZW4oanNzLmtleXMoKSkKICAgICAgICBmb3Iga2V5IGluIGpzcy5rZXlzKCk6CiAgICAgICAgICAgIHNteCA9IGpzc1trZXldCiAgICAgICAgICAgIGpoeCA9IGpoaFtrZXldCiAgICAgICAgICAgIGlmIGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJ1c2VyX2FjdGlvbnMiXS5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICB0ZXh0ID0gIlslcy4lc10iJShrZXksIGFjdGlvbk5hbWUoamJbImNvbmZpZyJdWyJhY3Rpb25zIl1bInVzZXJfYWN0aW9ucyJdW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGV4dCA9ICJbJXNdIiUoa2V5KQogICAgICAgICAgICBzdGF0c0ZpbGVuYW1lID0gJyVzXyVkXyVkLmh0bWwnJShvZGlyKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdKSxiZW5jaG1hcmtfaWQscGFnZV9pZCkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZUh0bWwgPSAnJXNfJWRfJWQuaHRtbCclKG9kaXJIdG1sKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdKSxiZW5jaG1hcmtfaWQscGFnZV9pZCkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZVByZXYgPSAnJXNfJWRfJWQuaHRtbCclKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdLGJlbmNobWFya19pZCxhYnMocGFnZV9pZC0xKSkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZU5leHQgPSAnJXNfJWRfJWQuaHRtbCclKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdLGJlbmNobWFya19pZCxwYWdlX2lkKzEpCiAgICAgICAgICAgIHRleHQgPSAiPGEgaHJlZj0nJXMnPiVzPC9hPiIlKHN0YXRzRmlsZW5hbWVIdG1sLHRleHQpCiAgICAgICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0oc3RhdHNGaWxlbmFtZSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGh0bWw+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPHN0eWxlPiIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oInRhYmxlLCB0aCwgdGQgeyIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIiAgYm9yZGVyOjFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjE2cHg7IHRleHQtYWxpZ246IGNlbnRlcjsiKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCJ9IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigibWFyayB7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiICBiYWNrZ3JvdW5kLWNvbG9yOiBMaWdodEdyYXk7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiICBjb2xvcjogYmxhY2s7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigifSIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIjwvc3R5bGU+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGJvZHk+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iLi4vJXMiPlVwPC9hPiclKHJlcG9ydF9mbikpCiAgICAgICAgICAgIGlmIChwYWdlX2lkID09IDApIGFuZCAobnVtX2tleXMgPT0gMSk6CiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCc8YSBocmVmPSIjIj5QcmV2PC9hPicpCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCc8YSBocmVmPSIjIj5OZXh0PC9hPicpCiAgICAgICAgICAgIGVsaWYgKHBhZ2VfaWQgPT0gMCkgYW5kIChudW1fa2V5cyA+IDEpOgogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iIyI+UHJldjwvYT4nKQogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iJXMiPk5leHQ8L2E+JyUoc3RhdHNGaWxlbmFtZU5leHQpKQogICAgICAgICAgICBlbGlmIHBhZ2VfaWQrMSA9PSBudW1fa2V5czoKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5QcmV2PC9hPiclKHN0YXRzRmlsZW5hbWVQcmV2KSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiMiPk5leHQ8L2E+JykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5QcmV2PC9hPiclKHN0YXRzRmlsZW5hbWVQcmV2KSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5OZXh0PC9hPiclKHN0YXRzRmlsZW5hbWVOZXh0KSkKCiAgICAgICAgICAgIGlmIGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJ1c2VyX2FjdGlvbnMiXS5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICBkZXNjID0gIlslcy4lc10iJShrZXksIGFjdGlvbk5hbWUoamJbImNvbmZpZyJdWyJhY3Rpb25zIl1bInVzZXJfYWN0aW9ucyJdW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZGVzYyA9ICJbQSVzXSIlKGtleSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGgyPiVzIFBlcmNlbnRpbGUgUmVzcG9uc2UgVGltZSBEaXN0cmlidXRpb248L2gyPiIlKGRlc2MpKQoKICAgICAgICAgICAgI3ByaW50U3RyZWFtLnByaW50bG4oIjxwcmU+IikKICAgICAgICAgICAgI2poeC5vdXRwdXRQZXJjZW50aWxlRGlzdHJpYnV0aW9uKHByaW50U3RyZWFtLCAxMDAwLjApCgogICAgICAgICAgICBib3MgPSBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKQogICAgICAgICAgICBveCA9IFByaW50U3RyZWFtKGJvcykKICAgICAgICAgICAgamh4Lm91dHB1dFBlcmNlbnRpbGVEaXN0cmlidXRpb24ob3gsIDEwMDAuMCkKICAgICAgICAgICAgb3guZmx1c2goKQogICAgICAgICAgICBveC5jbG9zZSgpCiAgICAgICAgICAgIHB0ZXh0ID0gYm9zLnRvU3RyaW5nKCkKICAgICAgICAgICAgbGluZXMgPSBwdGV4dC5zcGxpdCgnXG4nKQogICAgICAgICAgICB0Y291bnQgPSBqaHguZ2V0VG90YWxDb3VudCgpCiAgICAgICAgICAgIGhlYWRlciA9IFRydWUKICAgICAgICAgICAgcmxpc3QgPSBbXQogICAgICAgICAgICBmb3IgbGluZSBpbiBsaW5lczoKICAgICAgICAgICAgICBpZiBsZW4obGluZSkgPT0gMDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgaWYgbGluZVswXSAhPSAiIyI6CiAgICAgICAgICAgICAgICBlID0gbGluZS5zcGxpdCgpCiAgICAgICAgICAgICAgICBpZiBoZWFkZXI6CiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzx0YWJsZSBzdHlsZT0id2lkdGg6NjAwcHgiPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPHRyPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGg+JXM8L3RoPiclKGVbMF0pKQogICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRoPiVzPC90aD4nJShlWzFdKSkKICAgICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0aD4lczwvdGg+JyUoZVsyXSkpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGg+JXM8L3RoPiclKGVbM10pKQogICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRoPkFib3ZlQ291bnQ8L3RoPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPC90cj4nKQogICAgICAgICAgICAgICAgICBoZWFkZXIgPSBGYWxzZQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgaWYgbGVuKGUpID09IDM6CiAgICAgICAgICAgICAgICAgICAgZS5hcHBlbmQoJycpCiAgICAgICAgICAgICAgICAgIHJsaXN0LmFwcGVuZChlKQogICAgICAgICAgICBybGlzdC5yZXZlcnNlKCkKICAgICAgICAgICAgZm9yIGUgaW4gcmxpc3Q6CiAgICAgICAgICAgICAgICBtYXJrID0gRmFsc2UKICAgICAgICAgICAgICAgIGlmIGVbMV0uc3RhcnRzd2l0aCgiMC45OTkwIik6CiAgICAgICAgICAgICAgICAgICAgbWFyayA9IFRydWUKICAgICAgICAgICAgICAgIGlmIGVbMV0uc3RhcnRzd2l0aCgiMC45OTAiKToKICAgICAgICAgICAgICAgICAgICBtYXJrID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgZVsxXSA9PSAiMC45NTAwMDAwMDAwMDAiOgogICAgICAgICAgICAgICAgICAgIG1hcmsgPSBUcnVlCiAgICAgICAgICAgICAgICBpZiBlWzFdID09ICIwLjkwMDAwMDAwMDAwMCI6CiAgICAgICAgICAgICAgICAgICAgbWFyayA9IFRydWUKICAgICAgICAgICAgICAgIGlmIGVbMV0gPT0gIjAuODAwMDAwMDAwMDAwIjoKICAgICAgICAgICAgICAgICAgICBtYXJrID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgZVsxXSA9PSAiMC41MDAwMDAwMDAwMDAiOgogICAgICAgICAgICAgICAgICAgIG1hcmsgPSBUcnVlCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgIDx0cj4nKQogICAgICAgICAgICAgICAgaWYgbWFyazoKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPjxtYXJrPiVzPC9tYXJrPjwvdGQ+JyUoZVswXSkpCiAgICAgICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0ZD48bWFyaz4lczwvbWFyaz48L3RkPiclKGVbMV0pKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJShlWzBdKSkKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJShlWzFdKSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGQ+JXM8L3RkPiclKGVbMl0pKQogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0ZD4lczwvdGQ+JyUoZVszXSkpCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJSh0Y291bnQtaW50KGVbMl0pKSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPC90cj4nKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCI8L3RhYmxlPiIpCgogICAgICAgICAgICAjcHJpbnRTdHJlYW0ucHJpbnRsbigiPC9wcmU+IikKCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIjwvYm9keT4iKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCI8L2h0bWw+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgICAgICBwcmludFN0cmVhbS5jbG9zZSgpCiAgICAgICAgICAgIGF2Z19hcHMgPSAwLjAgaWYgc214Lm5hbWUgaW4gWyJvblN0YXJ0IiwgIm9uU3RvcCJdIGVsc2Ugc214Lm51bV9hY3Rpb25zL3NteC5kdXJhdGlvbgogICAgICAgICAgICBpZiBzbXgubmFtZSBpbiBbIm9uU3RhcnQiLCAib25TdG9wIl06CiAgICAgICAgICAgICAgICBjcHVfdCA9ICIwOjAwOjAwIgogICAgICAgICAgICAgICAgc214LmNwdSA9IDAuMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY3B1X3QgPSBzdHJfZnJvbV9jcHVfdGltZV9ucyhzbXguY3B1X3RpbWVfbnMpCiAgICAgICAgICAgIGh0bWwgPSBiZW5jaG1hcmtfc3VtbWFyeV9yb3clKG5hbWUycyx0ZXh0LHNteC5udW1fYWN0aW9ucyxzbXgubnVtX2ZhaWxlZCxzdHIoZGF0ZXRpbWUudGltZWRlbHRhKHNlY29uZHM9aW50KHNtLmR1cmF0aW9uKSkpLGF2Z19hcHMsamh4LmdldE1lYW4oKS8xMDAwLjAsamh4LmdldFN0ZERldmlhdGlvbigpLzEwMDAuMCxzbXgubWluX3J0LGpoeC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5MC4wKS8xMDAwLjAsamh4LmdldFZhbHVlQXRQZXJjZW50aWxlKDk5LjApLzEwMDAuMCxzbXgubWF4X3J0LHNteC5tYXhfcnRfdHNbODpdLHNteC5hdmdfcXMsc214Lm1heF9xcyxzbXgubWF4X2F3dCxzbXgubWF4X3d0LGNwdV90LHNteC5jcHUsc214Lm1lbSkKICAgICAgICAgICAgaWYgbm90IHByaW50X2RldGFpbF9yb3dzOgogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPGI+IiwiIikKICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvYj4iLCIiKQogICAgICAgICAgICAjIFJlbW92ZSB0YWcxCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcxPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMT4iLCIiKQogICAgICAgICAgICAjIFJlbW92ZSB0YWcyCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcyPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQoKICAgICAgICAgICAgcHJpbnRmKGh0bWwpCiAgICAgICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICAgICAgbmFtZTJzID0gbmFtZTJzX2xpc3RbMF0KICAgICAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQoKICAgICAgICAgICAgcGFnZV9pZCArPSAxCgogICAgcHJpbnRmKGhlYWRlci5yZXBsYWNlKCJfX0RFU0MxX18iLCBkZXNjMSkucmVwbGFjZSgiX19ERVNDMl9fIiwgZGVzYzIpKQoKICAgIHByZXZfcm93X2lkID0gMAogICAgZm9yIGUgaW4gcmI6CiAgICAgICAgY3VycmVudF9yb3dfaWQgPSBpbnQoZVsicm93X2lkIl0pCiAgICAgICAgaWYgY3VycmVudF9yb3dfaWQgPD0gcHJldl9yb3dfaWQ6CiAgICAgICAgICAgIGlmIHNtIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcHJpbnRfYWN0aW9uX3N1bW1hcnkoKQogICAgICAgICAgICAgICAgcHJpbnRfZ2xvYmFsX3N1bW1hcnkoKQogICAgICAgICAgICAgICAgcHJpbnRmKGJlbmNobWFya19lbXB0eV9yb3cpCiAgICAgICAgICAgICAgICBwcmludGYoYmVuY2htYXJrX2NvbHVtbnMpCiAgICAgICAgICAgIHNtID0gU3VtbWFyeSgpCiAgICAgICAgICAgIHNtLm5hbWUgPSBlWyJibV9uYW1lIl0KICAgICAgICAgICAgamgucmVzZXQoKQogICAgICAgICAgICBiZW5jaG1hcmtfaWQgKz0gMQogICAgICAgICAgICBqaGggPSB7fQogICAgICAgICAgICBqc3MgPSB7fQogICAgICAgICAgICBwcmludGYoYmVuY2htYXJrX2hlYWRlciUobmFtZV90b19ocmVmKGVbImJtX25hbWUiXSkpKQogICAgICAgICAgICBpZiBsZW4oZVsid29ya2Zsb3dfbmFtZSJdKSA+IDA6CiAgICAgICAgICAgICAgICBuYW1lMnNfbGlzdCA9IFsidTolZCwgdDolZCIlKGVbIm51bV91c2VycyJdLGVbIm51bV90aHJlYWRzIl0pLCAidzolcyIlKGVbIndvcmtmbG93X25hbWUiXSksICJjOiVkIiUoZVsiY29udGV4dF9pZCJdKSAsIiJdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lMnNfbGlzdCA9IFsidTolZCwgdDolZCIlKGVbIm51bV91c2VycyJdLGVbIm51bV90aHJlYWRzIl0pLCAiYzolZCIlKGVbImNvbnRleHRfaWQiXSksIiJdCiAgICAgICAgICAgIG5hbWUycyA9IG5hbWUyc19saXN0WzBdCiAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQogICAgICAgIGh0ID0gSGlzdG9ncmFtLmZyb21TdHJpbmcoZVsiaGlzdG9ncmFtX3J0Il0pCiAgICAgICAgamguYWRkKGh0KQogICAgICAgIHBfbWVtID0gMTAwLjAgKiBlWyJqdm1fbWVtb3J5X3VzZWQiXSAvIGVbImp2bV9tZW1vcnlfbWF4aW11bSJdCiAgICAgICAgcF9jcHUgPSBlWyJwcm9jZXNzX2NwdV91dGlsaXphdGlvbiJdCiAgICAgICAgaWYgZVsiYm1fbmFtZSJdIGluIFsib25TdGFydCIsICJvblN0b3AiXToKICAgICAgICAgICAgY3B1X3QgPSAiMDowMDowMCIKICAgICAgICAgICAgcF9jcHUgPSAwLjAKICAgICAgICBlbHNlOgogICAgICAgICAgICBjcHVfdCA9IHN0cl9mcm9tX2NwdV90aW1lX25zKGVbInByb2Nlc3NfY3B1X3RpbWVfbnMiXSkKICAgICAgICAgICAgcF9jcHUgPSBlWyJwcm9jZXNzX2NwdV91dGlsaXphdGlvbiJdCiAgICAgICAgaWYgcHJpbnRfZGV0YWlsX3Jvd3M6CiAgICAgICAgICAgIHByaW50ZihiZW5jaG1hcmtfZGV0YWlsX3JvdyUoIFwKICAgICAgICAgICAgICAgIG5hbWUycywKICAgICAgICAgICAgICAgIGVbInJvd19pZCJdKzEsCiAgICAgICAgICAgICAgICBlWyJudW1fYWN0aW9ucyJdLAogICAgICAgICAgICAgICAgZVsibnVtX2ZhaWxlZCJdLAogICAgICAgICAgICAgICAgc3RyKGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPWludChlWyJkdXJhdGlvbiJdKSkpLAogICAgICAgICAgICAgICAgMC4wIGlmIGVbImJtX25hbWUiXSBpbiBbIm9uU3RhcnQiLCAib25TdG9wIl0gZWxzZSBlWyJhdmdfYXBzIl0sCiAgICAgICAgICAgICAgICBlWyJhdmdfcnQiXSwKICAgICAgICAgICAgICAgIGh0LmdldFN0ZERldmlhdGlvbigpLzEwMDAuMCwKICAgICAgICAgICAgICAgIGVbIm1pbl9ydCJdLAogICAgICAgICAgICAgICAgZVsicGVyY2VudGlsZXNfcnQiXVsiOTAuMCJdLAogICAgICAgICAgICAgICAgZVsicGVyY2VudGlsZXNfcnQiXVsiOTkuMCJdLAogICAgICAgICAgICAgICAgZVsibWF4X3J0Il0sCiAgICAgICAgICAgICAgICBlWyJtYXhfcnRfdHMiXVs4Ol0sCiAgICAgICAgICAgICAgICBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdLAogICAgICAgICAgICAgICAgZVsibWF4X3d0aHJlYWRfcXNpemUiXSwKICAgICAgICAgICAgICAgIGVbImF2Z193dCJdLAogICAgICAgICAgICAgICAgZVsibWF4X3d0Il0sCiAgICAgICAgICAgICAgICBjcHVfdCwKICAgICAgICAgICAgICAgIHBfY3B1LAogICAgICAgICAgICAgICAgcF9tZW0KICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICAgICAgbmFtZTJzID0gbmFtZTJzX2xpc3RbMF0KICAgICAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQogICAgICAgIGlmIHNtLm1pbl9ydCA+IGVbIm1pbl9ydCJdOgogICAgICAgICAgICBzbS5taW5fcnQgPSBlWyJtaW5fcnQiXQogICAgICAgIGlmIHNtLm1heF9ydCA8IGVbIm1heF9ydCJdOgogICAgICAgICAgICBzbS5tYXhfcnQgPSBlWyJtYXhfcnQiXQogICAgICAgICAgICBzbS5tYXhfcnRfdHMgPSBlWyJtYXhfcnRfdHMiXQogICAgICAgIHNtLm51bV9hY3Rpb25zICs9IGVbIm51bV9hY3Rpb25zIl0KICAgICAgICBzbS5udW1fZmFpbGVkICs9IGVbIm51bV9mYWlsZWQiXQogICAgICAgIHNtLmR1cmF0aW9uICs9IGVbImR1cmF0aW9uIl0KICAgICAgICBpZiBzbS5hdmdfcXMgPCBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdOgogICAgICAgICAgICBzbS5hdmdfcXMgPSBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdCiAgICAgICAgaWYgc20ubWF4X3FzIDwgZVsibWF4X3d0aHJlYWRfcXNpemUiXToKICAgICAgICAgICAgc20ubWF4X3FzID0gZVsibWF4X3d0aHJlYWRfcXNpemUiXQogICAgICAgIGlmIHNtLm1heF9hd3QgPCBlWyJhdmdfd3QiXToKICAgICAgICAgICAgc20ubWF4X2F3dCA9IGVbImF2Z193dCJdCiAgICAgICAgaWYgc20ubWF4X3d0IDwgZVsibWF4X3d0Il06CiAgICAgICAgICAgIHNtLm1heF93dCA9IGVbIm1heF93dCJdCiAgICAgICAgaWYgc20ubWVtIDwgcF9tZW06CiAgICAgICAgICAgIHNtLm1lbSA9IHBfbWVtCiAgICAgICAgaWYgc20uY3B1IDwgcF9jcHU6CiAgICAgICAgICAgIHNtLmNwdSA9IHBfY3B1CiAgICAgICAgc20uY3B1X3RpbWVfbnMgKz0gZVsicHJvY2Vzc19jcHVfdGltZV9ucyJdCgogICAgICAgIGlmIGxlbihzbS5jaGFydF90X2xpc3QpID09IC0xOgogICAgICAgICAgICBzbS5jaGFydF90X2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2JlZ2luIl0ucmVwbGFjZSgiXyIsICJUIikpLAogICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShlWyJhdmdfYXBzIl0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjNmIiUoZVsibnVtX2ZhaWxlZCJdL2VbImR1cmF0aW9uIl0pKQogICAgICAgICAgICBdKQoKICAgICAgICBzbS5jaGFydF90X2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2VuZCJdLnJlcGxhY2UoIl8iLCAiVCIpKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsiYXZnX2FwcyJdKSksCiAgICAgICAgICAgICAgICBmbG9hdCgiJS4zZiIlKGVbIm51bV9mYWlsZWQiXS9lWyJkdXJhdGlvbiJdKSkKICAgICAgICAgICAgIF0pCgogICAgICAgICMgWycyMDE4LTA0LTEwVDIwOjQwOjMzWicsIDEsIDUsIDEwLCAyMCwgMjUsIDMwIF0KICAgICAgICBpZiBsZW4oc20uY2hhcnRfcF9saXN0KSA9PSAtMToKICAgICAgICAgICAgc20uY2hhcnRfcF9saXN0LmFwcGVuZCgKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2JlZ2luIl0ucmVwbGFjZSgiXyIsICJUIikpLAogICAgICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWluX3J0Il0pKSwKICAgICAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGVbImF2Z19ydCJdKSksCiAgICAgICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShodC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5MC4wKS8xMDAwLjApKSwKICAgICAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGh0LmdldFZhbHVlQXRQZXJjZW50aWxlKDk1LjApLzEwMDAuMCkpLAogICAgICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoaHQuZ2V0VmFsdWVBdFBlcmNlbnRpbGUoOTkuMCkvMTAwMC4wKSksCiAgICAgICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShlWyJtYXhfcnQiXSkpCiAgICAgICAgICAgICAgICBdKQoKICAgICAgICBzbS5jaGFydF9wX2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2VuZCJdLnJlcGxhY2UoIl8iLCAiVCIpKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWluX3J0Il0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsiYXZnX3J0Il0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoaHQuZ2V0VmFsdWVBdFBlcmNlbnRpbGUoOTAuMCkvMTAwMC4wKSksCiAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGh0LmdldFZhbHVlQXRQZXJjZW50aWxlKDk1LjApLzEwMDAuMCkpLAogICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShodC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5OS4wKS8xMDAwLjApKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWF4X3J0Il0pKQogICAgICAgICAgICBdKQoKICAgICAgICAjIGpoaCAuLi4KICAgICAgICBmb3Iga2V5IGluIGVbInVzZXJfYWN0aW9ucyJdLmtleXMoKToKICAgICAgICAgICAgYXIgPSBlWyJ1c2VyX2FjdGlvbnMiXVtrZXldCiAgICAgICAgICAgIGh0dCA9IEhpc3RvZ3JhbS5mcm9tU3RyaW5nKGFyWyJoaXN0b2dyYW1fcnQiXSkKICAgICAgICAgICAgI3ByaW50KGFyWyJuYW1lIl0gKyAiIC0gIiArICIlLjNmIiUoaHR0LmdldE1lYW4oKS8xMDAwLjApKQogICAgICAgICAgICBpZiBqaGguaGFzX2tleShrZXkpOgogICAgICAgICAgICAgICAgamhoW2tleV0uYWRkKGh0dCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGpoaFtrZXldID0gSGlzdG9ncmFtKDEsIDM2MDAqMTAwMCoxMDAwLCAzKQogICAgICAgICAgICAgICAgamhoW2tleV0uYWRkKGh0dCkKICAgICAgICAgICAgI3ByaW50KGFyWyJuYW1lIl0gKyAiIC0gIiArICIlLjNmIiUoamhoW2tleV0uZ2V0TWVhbigpLzEwMDAuMCkgKyAiIC0gJWQiJShqaGhba2V5XS5nZXRUb3RhbENvdW50KCkpKQoKICAgICAgICAjIGpzcyAuLi4KICAgICAgICBmb3Iga2V5IGluIGVbInVzZXJfYWN0aW9ucyJdLmtleXMoKToKICAgICAgICAgICAgYXIgPSBlWyJ1c2VyX2FjdGlvbnMiXVtrZXldCiAgICAgICAgICAgIGlmIGpzcy5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICBzbXggPSBqc3Nba2V5XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc214ID0ganNzW2tleV0gPSBTdW1tYXJ5KCkKICAgICAgICAgICAgICAgIHNteC5uYW1lID0gZVsiYm1fbmFtZSJdCgogICAgICAgICAgICBpZiBzbXgubWluX3J0ID4gYXJbIm1pbl9ydCJdOgogICAgICAgICAgICAgICAgc214Lm1pbl9ydCA9IGFyWyJtaW5fcnQiXQogICAgICAgICAgICBpZiBzbXgubWF4X3J0IDwgYXJbIm1heF9ydCJdOgogICAgICAgICAgICAgICAgc214Lm1heF9ydCA9IGFyWyJtYXhfcnQiXQogICAgICAgICAgICAgICAgc214Lm1heF9ydF90cyA9IGFyWyJtYXhfcnRfdHMiXQogICAgICAgICAgICBzbXgubnVtX2FjdGlvbnMgKz0gYXJbIm51bV9hY3Rpb25zIl0KICAgICAgICAgICAgc214Lm51bV9mYWlsZWQgKz0gYXJbIm51bV9mYWlsZWQiXQoKICAgICAgICAgICAgc214LmR1cmF0aW9uICs9IGVbImR1cmF0aW9uIl0KICAgICAgICAgICAgaWYgc214LmF2Z19xcyA8IGVbImF2Z193dGhyZWFkX3FzaXplIl06CiAgICAgICAgICAgICAgICBzbXguYXZnX3FzID0gZVsiYXZnX3d0aHJlYWRfcXNpemUiXQogICAgICAgICAgICBpZiBzbXgubWF4X3FzIDwgZVsibWF4X3d0aHJlYWRfcXNpemUiXToKICAgICAgICAgICAgICAgIHNteC5tYXhfcXMgPSBlWyJtYXhfd3RocmVhZF9xc2l6ZSJdCiAgICAgICAgICAgIGlmIHNteC5tYXhfYXd0IDwgZVsiYXZnX3d0Il06CiAgICAgICAgICAgICAgICBzbXgubWF4X2F3dCA9IGVbImF2Z193dCJdCiAgICAgICAgICAgIGlmIHNteC5tYXhfd3QgPCBlWyJtYXhfd3QiXToKICAgICAgICAgICAgICAgIHNteC5tYXhfd3QgPSBlWyJtYXhfd3QiXQogICAgICAgICAgICBpZiBzbXgubWVtIDwgcF9tZW06CiAgICAgICAgICAgICAgICBzbXgubWVtID0gcF9tZW0KICAgICAgICAgICAgaWYgc214LmNwdSA8IHBfY3B1OgogICAgICAgICAgICAgICAgc214LmNwdSA9IHBfY3B1CiAgICAgICAgICAgIHNteC5jcHVfdGltZV9ucyArPSBlWyJwcm9jZXNzX2NwdV90aW1lX25zIl0KCiAgICBwcmludF9hY3Rpb25fc3VtbWFyeSgpCiAgICBwcmludF9nbG9iYWxfc3VtbWFyeSgpCiAgICBwcmludGYodHJhaWxlcikKCiAgICByZXBvcnRfZmguY2xvc2UoKQoKICAgIG9zLmNoZGlyKGN3ZCkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpZiBsZW4oc3lzLmFyZ3YpID49IDM6CiAgICAgICAgZmlsZW5hbWUgPSBzeXMuYXJndlsxXQogICAgICAgIGNvbmZpZ0ZpbGVuYW1lID0gc3lzLmFyZ3ZbMl0KICAgICAgICBjcmVhdGVSZXBvcnQoZmlsZW5hbWUsIGNvbmZpZ0ZpbGVuYW1lKQo=";

    public static void main(String... args) {
        String mainScriptFilename = "report.py";
        String mainScript = "";
        String pythonArgsScript = "";
        for (String arg : args) {
            if (pythonArgsScript.length() == 0) {
                if (!arg.equals(mainScriptFilename)) {
                    pythonArgsScript += "'" + mainScriptFilename + "', ";
                }
            } else {
                pythonArgsScript += ", ";
            }
            pythonArgsScript += "'" + arg + "'";
        }
        if (pythonArgsScript.length() == 0) {
            pythonArgsScript = "'" + mainScriptFilename + "'";
        }
        pythonArgsScript = "import sys; sys.argv = [" + pythonArgsScript + "]";
        {
            byte[] decodedBytes = Base64.getDecoder().decode(mainScriptTextBase64);
            String text = new String(decodedBytes);
            mainScript = text;
        }
        {
            // create Python interpreter object
            PythonInterpreter pyInterp = new PythonInterpreter();
            // initialize command-line args
            pyInterp.exec(pythonArgsScript);
            // run script
            pyInterp.exec(mainScript);
        }
    }
}
