package io.github.wfouche.tulip.report;

/// usr/bin/env jbang "$0" "$@" ; exit $?

// spotless:off
// DEPS com.google.code.gson:gson:2.13.1
// DEPS org.hdrhistogram:HdrHistogram:2.2.2
// DEPS org.python:jython-slim:2.7.4
// JAVA 21
// spotless:on

import java.util.Base64;
import org.python.util.PythonInterpreter;

public class report_py {

    public static String mainScriptTextBase64 =
            "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBwcmludF9mdW5jdGlvbgppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGpzb24KaW1wb3J0IHJlCmltcG9ydCBzeXMKaW1wb3J0IG9yZy5IZHJIaXN0b2dyYW0uSGlzdG9ncmFtIGFzIEhpc3RvZ3JhbQppbXBvcnQgb3MKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgT3JkZXJlZERpY3QKaW1wb3J0IGphdmEuaW8uUHJpbnRTdHJlYW0gYXMgUHJpbnRTdHJlYW0KaW1wb3J0IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtIGFzIEJ5dGVBcnJheU91dHB1dFN0cmVhbQoKIyAvLy8gamJhbmcKIyByZXF1aXJlcy1qeXRob24gPSAiPT0yLjcuNCIKIyByZXF1aXJlcy1qYXZhID0gIj49MjEiCiMgZGVwZW5kZW5jaWVzID0gWwojICAgImNvbS5nb29nbGUuY29kZS5nc29uOmdzb246Mi4xMy4xIiwKIyAgICJvcmcuaGRyaGlzdG9ncmFtOkhkckhpc3RvZ3JhbToyLjIuMiIKIyBdCiMgW3B5dGhvbi1qdm1dCiMgICBkZWJ1ZyA9IGZhbHNlCiMgLy8vCgpzdW1tYXJ5X2h0bWxfMSA9ICcnJzwhRE9DVFlQRSBodG1sPgo8aHRtbD4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9IlVURi04Ij4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KICAgIGRpdi5oaXN0byB7CiAgICAgICAgdmlzaWJpbGl0eTogaGlkZGVuCiAgICB9Cjwvc3R5bGU+Cgo8IS0tTG9hZCB0aGUgQUpBWCBBUEktLT4KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9qc2FwaSI+PC9zY3JpcHQ+Cgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CgogICAgaWYgKHdpbmRvdy5GaWxlICYmIHdpbmRvdy5GaWxlUmVhZGVyICYmIHdpbmRvdy5GaWxlTGlzdCAmJiB3aW5kb3cuQmxvYikgewogICAgICAgIC8vIEdyZWF0IHN1Y2Nlc3MhIEFsbCB0aGUgRmlsZSBBUElzIGFyZSBzdXBwb3J0ZWQuCiAgICB9IGVsc2UgewogICAgICAgIGFsZXJ0KCdUaGUgRmlsZSBBUElzIGFyZSBub3QgZnVsbHkgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3Nlci4nKTsKICAgIH0KCiAgICAvLyBMb2FkIHRoZSBWaXN1YWxpemF0aW9uIEFQSSBhbmQgdGhlIGNvcmVjaGFydCBwYWNrYWdlLgogICAgZ29vZ2xlLmxvYWQoJ3Zpc3VhbGl6YXRpb24nLCAnMS4wJywgeydwYWNrYWdlcyc6Wydjb3JlY2hhcnQnXX0pOwoKICAgIC8vIFNldCBhIGNhbGxiYWNrIHRvIHJ1biB3aGVuIHRoZSBHb29nbGUgVmlzdWFsaXphdGlvbiBBUEkgaXMgbG9hZGVkLgogICAgZ29vZ2xlLnNldE9uTG9hZENhbGxiYWNrKGRyYXdJbml0aWFsQ2hhcnQpOwoKICAgIHZhciBjaGFydERhdGEgPSBudWxsOwogICAgdmFyIGNoYXJ0ID0gbnVsbDsKCiAgICBmdW5jdGlvbiBzZXRDaGFydERhdGEobmFtZXMsIGhpc3RvcykgewogICAgICAgIHdoaWxlIChuYW1lcy5sZW5ndGggPCBoaXN0b3MubGVuZ3RoKSB7CiAgICAgICAgICAgIG5hbWVzLnB1c2goJ1Vua25vd24nKTsKICAgICAgICB9CgogICAgICAgIHZhciBzZXJpZXMgPSBbXTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGhpc3Rvcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBzZXJpZXMgPSBhcHBlbmREYXRhU2VyaWVzKGhpc3Rvc1tpXSwgbmFtZXNbaV0sIHNlcmllcyk7CiAgICAgICAgfQoKICAgICAgICBjaGFydERhdGEgPSBnb29nbGUudmlzdWFsaXphdGlvbi5hcnJheVRvRGF0YVRhYmxlKHNlcmllcyk7CiAgICB9CgonJycKCnRleHRfYmxvY2tfMSA9ICcnJwogICAgZnVuY3Rpb24gZHJhd0luaXRpYWxDaGFydCgpIHsKICAgICAgICAvLyBDb25uZWN0IHRoZSBjaG9vc2UgZmlsZXMgYnV0dG9uOgogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlcycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGhhbmRsZUZpbGVTZWxlY3QsIGZhbHNlKTsKCiAgICAgICAgLy8gTG9hZCBzb21lIHN0YXRpYyBleGFtcGxlIGRhdGE6CiAgICAgICAgdmFyIGRhdGExU3RyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2I2RhdGFfMSIpLmlubmVySFRNTC50cmltKCk7CiAgICAgICAgdmFyIGRhdGEyU3RyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2I2RhdGFfMiIpLmlubmVySFRNTC50cmltKCk7CiAgICAgICAgdmFyIGRhdGEzU3RyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2I2RhdGFfMyIpLmlubmVySFRNTC50cmltKCk7CiAgICAgICAgdmFyIGhpc3RvcyA9IFtkYXRhM1N0ciwgZGF0YTJTdHIsIGRhdGExU3RyXTsKICAgICAgICB2YXIgbmFtZXMgPSBbJ0EnLCAnQicsICdDJ107CgogICAgICAgIHNldENoYXJ0RGF0YShuYW1lcywgaGlzdG9zKTsKICAgICAgICBkcmF3Q2hhcnQoKTsKICAgIH0KJycnCgpzdW1tYXJ5X2h0bWxfMiA9ICcnJwogICAgdmFyIG1heFBlcmNlbnRpbGUgPSAxMDAwMDAwOwoKICAgIGZ1bmN0aW9uIGRyYXdDaGFydCgpIHsKCiAgICAgICAgdmFyIHRpY2tzID0KICAgICAgICAgICAgICAgIFt7djoxLGY6JzAlJ30sCiAgICAgICAgICAgICAgICAgICAge3Y6MTAsZjonOTAlJ30sCiAgICAgICAgICAgICAgICAgICAge3Y6MTAwLGY6Jzk5JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAsZjonOTkuOSUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMDAwMCxmOic5OS45OSUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMDAwMDAsZjonOTkuOTk5JSd9LAogICAgICAgICAgICAgICAgICAgIHt2OjEwMDAwMDAsZjonOTkuOTk5OSUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMDAwMDAwMCxmOic5OS45OTk5OSUnfSwKICAgICAgICAgICAgICAgICAgICB7djoxMDAwMDAwMDAsZjonOTkuOTk5OTk5JSd9XTsKCiAgICAgICAgdmFyIHVuaXRTZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidGltZVVuaXRTZWxlY3Rpb24iKTsKICAgICAgICB2YXIgdW5pdFNlbEluZGV4ID0gdW5pdFNlbGVjdGlvbi5zZWxlY3RlZEluZGV4OwogICAgICAgIHZhciB1bml0VGV4dCA9IHVuaXRTZWxlY3Rpb24ub3B0aW9uc1t1bml0U2VsSW5kZXhdLmlubmVySFRNTDsKCiAgICAgICAgdmFyIG9wdGlvbnMgPSB7Ci8vICAgICAgICAgICAgdGl0bGU6ICdQZXJjZW50aWxlIFJlc3BvbnNlIFRpbWUgRGlzdHJpYnV0aW9uJywKICAgICAgICAgICAgaGVpZ2h0OiA0ODAsCi8vICAgICAgICAgICAgaEF4aXM6IHt0aXRsZTogJ1BlcmNlbnRpbGUnLCBtaW5WYWx1ZTogMCwgbG9nU2NhbGU6IHRydWUsIHRpY2tzOnRpY2tzIH0sCiAgICAgICAgICAgIGhBeGlzOiB7CiAgICAgICAgICAgICAgICB0aXRsZTogIlBlcmNlbnRpbGUiLAogICAgICAgICAgICAgICAgbWluVmFsdWU6IDEsIGxvZ1NjYWxlOiB0cnVlLCB0aWNrczp0aWNrcywKICAgICAgICAgICAgICAgIHZpZXdXaW5kb3dNb2RlOidleHBsaWNpdCcsCiAgICAgICAgICAgICAgICB2aWV3V2luZG93OnsKICAgICAgICAgICAgICAgICAgICBtYXg6bWF4UGVyY2VudGlsZSwKICAgICAgICAgICAgICAgICAgICBtaW46MQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICB2QXhpczoge3RpdGxlOiAnTGF0ZW5jeSAoJyArIHVuaXRUZXh0ICsgJyknLCBtaW5WYWx1ZTogMCB9LAogICAgICAgICAgICBsZWdlbmQ6IHtwb3NpdGlvbjogJ2JvdHRvbSd9CiAgICAgICAgfTsKCgogICAgICAgIC8vIGFkZCB0b29sdGlwcyB3aXRoIGNvcnJlY3QgcGVyY2VudGlsZSB0ZXh0IHRvIGRhdGE6CiAgICAgICAgdmFyIGNvbHVtbnMgPSBbMF07CiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBjaGFydERhdGEuZ2V0TnVtYmVyT2ZDb2x1bW5zKCk7IGkrKykgewogICAgICAgICAgICBjb2x1bW5zLnB1c2goaSk7CiAgICAgICAgICAgIGNvbHVtbnMucHVzaCh7CiAgICAgICAgICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgICAgICByb2xlOiAndG9vbHRpcCcKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjYWxjOiAoZnVuY3Rpb24gKGopIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGR0LCByb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBlcmNlbnRpbGUgPSAxMDAuMCAtICgxMDAuMC9kdC5nZXRWYWx1ZShyb3csIDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGR0LmdldENvbHVtbkxhYmVsKGopICsgJzogJyArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudGlsZS50b1ByZWNpc2lvbig3KSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1wlXFwnaWxlID0gJyArIGR0LmdldFZhbHVlKHJvdywgaikgKyAnICcgKyB1bml0VGV4dAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKGkpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB2YXIgdmlldyA9IG5ldyBnb29nbGUudmlzdWFsaXphdGlvbi5EYXRhVmlldyhjaGFydERhdGEpOwogICAgICAgIHZpZXcuc2V0Q29sdW1ucyhjb2x1bW5zKTsKCiAgICAgICAgY2hhcnQgPSBuZXcgZ29vZ2xlLnZpc3VhbGl6YXRpb24uTGluZUNoYXJ0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGFydF9kaXYnKSk7CiAgICAgICAgY2hhcnQuZHJhdyh2aWV3LCBvcHRpb25zKTsKCiAgICAgICAgZ29vZ2xlLnZpc3VhbGl6YXRpb24uZXZlbnRzLmFkZExpc3RlbmVyKGNoYXJ0LCAncmVhZHknLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGNoYXJ0X2Rpdi5pbm5lckhUTUwgPSAnPGltZyBzcmM9IicgKyBjaGFydC5nZXRJbWFnZVVSSSgpICsgJyI+JzsKICAgICAgICB9KTsKCiAgICB9Cjwvc2NyaXB0Pgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICBmdW5jdGlvbiBhcHBlbmREYXRhU2VyaWVzKGhpc3RvLCBuYW1lLCBkYXRhU2VyaWVzKSB7CiAgICAgICAgdmFyIHNlcmllczsKICAgICAgICB2YXIgc2VyaWVzQ291bnQ7CiAgICAgICAgaWYgKGRhdGFTZXJpZXMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgc2VyaWVzID0gWyBbJ1gnLCBuYW1lXSBdOwogICAgICAgICAgICBzZXJpZXNDb3VudCA9IDE7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2VyaWVzID0gZGF0YVNlcmllczsKICAgICAgICAgICAgc2VyaWVzWzBdLnB1c2gobmFtZSk7CiAgICAgICAgICAgIHNlcmllc0NvdW50ID0gc2VyaWVzWzBdLmxlbmd0aCAtIDE7CiAgICAgICAgfQoKICAgICAgICB2YXIgbGluZXMgPSBoaXN0by5zcGxpdCgiXFxuIik7CgogICAgICAgIHZhciBzZXJpZXNJbmRleCA9IDE7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTsKICAgICAgICAgICAgdmFyIHZhbHVlcyA9IGxpbmUudHJpbSgpLnNwbGl0KC9bIF0rLyk7CgogICAgICAgICAgICBpZiAobGluZVswXSAhPSAnIycgJiYgdmFsdWVzLmxlbmd0aCA9PSA0KSB7CgogICAgICAgICAgICAgICAgdmFyIHkgPSBwYXJzZUZsb2F0KHZhbHVlc1swXSk7CiAgICAgICAgICAgICAgICB2YXIgeCA9IHBhcnNlRmxvYXQodmFsdWVzWzNdKTsKCiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHgpICYmICFpc05hTih5KSkgewoKICAgICAgICAgICAgICAgICAgICBpZiAoc2VyaWVzSW5kZXggPj0gc2VyaWVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICBzZXJpZXMucHVzaChbeF0pOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHNlcmllc1tzZXJpZXNJbmRleF0ubGVuZ3RoIDwgc2VyaWVzQ291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VyaWVzW3Nlcmllc0luZGV4XS5wdXNoKG51bGwpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgc2VyaWVzW3Nlcmllc0luZGV4XS5wdXNoKHkpOwogICAgICAgICAgICAgICAgICAgIHNlcmllc0luZGV4Kys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHdoaWxlIChzZXJpZXNJbmRleCA8IHNlcmllcy5sZW5ndGgpIHsKICAgICAgICAgICAgc2VyaWVzW3Nlcmllc0luZGV4XS5wdXNoKG51bGwpOwogICAgICAgICAgICBzZXJpZXNJbmRleCsrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNlcmllczsKICAgIH0KPC9zY3JpcHQ+CjxzY3JpcHQ+CiAgICBmdW5jdGlvbiB0aW1lVW5pdHNTZWxlY3RlZChldnQpIHsKICAgICAgICBkcmF3Q2hhcnQoKTsKICAgICAgICByZXR1cm4ge3R5cGVkOiAnJ307CiAgICB9CgogICAgZnVuY3Rpb24gZG9FeHBvcnQoZXZlbnQpIHsKICAgICAgICBzYXZlU3ZnQXNQbmcoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc3ZnJyksICdIaXN0b2dyYW0nLCAyLjApOwogICAgICAgIHJldHVybiB7dHlwZWQ6ICcnfTsKICAgIH0KPC9zY3JpcHQ+Cgo8c2NyaXB0PgogICAgZnVuY3Rpb24gaGFuZGxlRmlsZVNlbGVjdChldnQpIHsKICAgICAgICB2YXIgZmlsZXMgPSBldnQudGFyZ2V0LmZpbGVzOyAvLyBGaWxlTGlzdCBvYmplY3QKICAgICAgICB2YXIgZmlsZURpc3BsYXlBcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVEaXNwbGF5QXJlYScpOwoKICAgICAgICB2YXIgbmFtZXMgPSBbXTsKICAgICAgICB2YXIgaGlzdG9zID0gW107CgogICAgICAgIGZpbGVEaXNwbGF5QXJlYS5pbm5lclRleHQgPSAiZmlsZSBzZWxlY3RlZC4uLlxcbiI7CgogICAgICAgIC8vIExvb3AgdGhyb3VnaCB0aGUgRmlsZUxpc3QgYW5kIHJlbmRlciBpbWFnZSBmaWxlcyBhcyB0aHVtYm5haWxzLgogICAgICAgIGZvciAodmFyIGkgPSAwLCBmOyBmID0gZmlsZXNbaV07IGkrKykgewogICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsKCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZnVuY3Rpb24odGhlRmlsZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICBoaXN0b3MucHVzaChlLnRhcmdldC5yZXN1bHQpOwogICAgICAgICAgICAgICAgICAgIG5hbWVzLnB1c2goZXNjYXBlKHRoZUZpbGUubmFtZSkpOwogICAgICAgICAgICAgICAgICAgIGZpbGVEaXNwbGF5QXJlYS5pbm5lclRleHQgPSAiIFBsb3R0aW5nIGlucHV0IGZyb206ICIgKyBuYW1lcyArICJcXG4iOwogICAgICAgICAgICAgICAgICAgIHNldENoYXJ0RGF0YShuYW1lcywgaGlzdG9zKTsKICAgICAgICAgICAgICAgICAgICBkcmF3Q2hhcnQoKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pKGYpOwoKICAgICAgICAgICAgLy8gUmVhZCBpbiB0aGUgaW1hZ2UgZmlsZSBhcyBhIGRhdGEgVVJMLgogICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmKTsKICAgICAgICB9CgogICAgfQoKPC9zY3JpcHQ+Cgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICAoZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7CgogICAgICAgIHZhciBkb2N0eXBlID0gJzw/eG1sIHZlcnNpb249IjEuMCIgc3RhbmRhbG9uZT0ibm8iPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPic7CgogICAgICAgIGZ1bmN0aW9uIGlubGluZUltYWdlcyhjYWxsYmFjaykgewogICAgICAgICAgICB2YXIgaW1hZ2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc3ZnIGltYWdlJyk7CiAgICAgICAgICAgIHZhciBsZWZ0ID0gaW1hZ2VzLmxlbmd0aDsKICAgICAgICAgICAgaWYgKGxlZnQgPT0gMCkgewogICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGltYWdlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgKGZ1bmN0aW9uKGltYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGltYWdlLmdldEF0dHJpYnV0ZSgneGxpbms6aHJlZicpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBocmVmID0gaW1hZ2UuZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykudmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgvXmh0dHAvLnRlc3QoaHJlZikgJiYgIShuZXcgUmVnRXhwKCdeJyArIHdpbmRvdy5sb2NhdGlvbi5ob3N0KS50ZXN0KGhyZWYpKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgcmVuZGVyIGVtYmVkZGVkIGltYWdlcyBsaW5raW5nIHRvIGV4dGVybmFsIGhvc3RzLiIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICAgICAgICAgICAgICAgICB2YXIgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBpbWFnZS5nZXRBdHRyaWJ1dGUoJ3hsaW5rOmhyZWYnKTsKICAgICAgICAgICAgICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGltZy53aWR0aDsKICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGltZy5oZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoaW1nLCAwLCAwKTsKICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2Uuc2V0QXR0cmlidXRlKCd4bGluazpocmVmJywgY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJykpOwogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0LS07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZWZ0ID09IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KShpbWFnZXNbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBzdHlsZXMoZG9tKSB7CiAgICAgICAgICAgIHZhciBjc3MgPSAiIjsKICAgICAgICAgICAgdmFyIHNoZWV0cyA9IGRvY3VtZW50LnN0eWxlU2hlZXRzOwogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNoZWV0cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHNoZWV0c1tpXS5oYXNPd25Qcm9wZXJ0eSgnY3NzUnVsZXMnKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBydWxlcyA9IHNoZWV0c1tpXS5jc3NSdWxlczsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHJ1bGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBydWxlID0gcnVsZXNbal07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YocnVsZS5zdHlsZSkgIT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzcyArPSBydWxlLnNlbGVjdG9yVGV4dCArICIgeyAiICsgcnVsZS5zdHlsZS5jc3NUZXh0ICsgIiB9XFxuIjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogICAgICAgICAgICBzLnNldEF0dHJpYnV0ZSgndHlwZScsICd0ZXh0L2NzcycpOwogICAgICAgICAgICBzLmlubmVySFRNTCA9ICI8IVtDREFUQVtcXG4iICsgY3NzICsgIlxcbl1dPiI7CgogICAgICAgICAgICB2YXIgZGVmcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RlZnMnKTsKICAgICAgICAgICAgZGVmcy5hcHBlbmRDaGlsZChzKTsKICAgICAgICAgICAgcmV0dXJuIGRlZnM7CiAgICAgICAgfQoKICAgICAgICBvdXQkLnN2Z0FzRGF0YVVyaSA9IGZ1bmN0aW9uKGVsLCBzY2FsZUZhY3RvciwgY2IpIHsKICAgICAgICAgICAgc2NhbGVGYWN0b3IgPSBzY2FsZUZhY3RvciB8fCAxOwoKICAgICAgICAgICAgaW5saW5lSW1hZ2VzKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIG91dGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICAgICAgICB2YXIgY2xvbmUgPSBlbC5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBwYXJzZUludCgKICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUuZ2V0QXR0cmlidXRlKCd3aWR0aCcpCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IGNsb25lLnN0eWxlLndpZHRoCiAgICAgICAgICAgICAgICAgICAgICAgIHx8IG91dCQuZ2V0Q29tcHV0ZWRTdHlsZShlbCkuZ2V0UHJvcGVydHlWYWx1ZSgnd2lkdGgnKQogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHZhciBoZWlnaHQgPSBwYXJzZUludCgKICAgICAgICAgICAgICAgICAgICAgICAgY2xvbmUuZ2V0QXR0cmlidXRlKCdoZWlnaHQnKQogICAgICAgICAgICAgICAgICAgICAgICB8fCBjbG9uZS5zdHlsZS5oZWlnaHQKICAgICAgICAgICAgICAgICAgICAgICAgfHwgb3V0JC5nZXRDb21wdXRlZFN0eWxlKGVsKS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKQogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICB2YXIgeG1sbnMgPSAiaHR0cDovL3d3dy53My5vcmcvMjAwMC94bWxucy8iOwoKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZSgidmVyc2lvbiIsICIxLjEiKTsKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZU5TKHhtbG5zLCAieG1sbnMiLCAiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciKTsKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZU5TKHhtbG5zLCAieG1sbnM6eGxpbmsiLCAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIpOwogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlKCJ3aWR0aCIsIHdpZHRoICogc2NhbGVGYWN0b3IpOwogICAgICAgICAgICAgICAgY2xvbmUuc2V0QXR0cmlidXRlKCJoZWlnaHQiLCBoZWlnaHQgKiBzY2FsZUZhY3Rvcik7CiAgICAgICAgICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoInZpZXdCb3giLCAiMCAwICIgKyB3aWR0aCArICIgIiArIGhlaWdodCk7CiAgICAgICAgICAgICAgICBvdXRlci5hcHBlbmRDaGlsZChjbG9uZSk7CgogICAgICAgICAgICAgICAgY2xvbmUuaW5zZXJ0QmVmb3JlKHN0eWxlcyhjbG9uZSksIGNsb25lLmZpcnN0Q2hpbGQpOwoKICAgICAgICAgICAgICAgIHZhciBzdmcgPSBkb2N0eXBlICsgb3V0ZXIuaW5uZXJIVE1MOwogICAgICAgICAgICAgICAgdmFyIHVyaSA9ICdkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LCcgKyB3aW5kb3cuYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3ZnKSkpOwogICAgICAgICAgICAgICAgaWYgKGNiKSB7CiAgICAgICAgICAgICAgICAgICAgY2IodXJpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBvdXQkLnNhdmVTdmdBc1BuZyA9IGZ1bmN0aW9uKGVsLCBuYW1lLCBzY2FsZUZhY3RvcikgewogICAgICAgICAgICBvdXQkLnN2Z0FzRGF0YVVyaShlbCwgc2NhbGVGYWN0b3IsIGZ1bmN0aW9uKHVyaSkgewogICAgICAgICAgICAgICAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7CiAgICAgICAgICAgICAgICBpbWFnZS5zcmMgPSB1cmk7CiAgICAgICAgICAgICAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZHJhd0ltYWdlKGltYWdlLCAwLCAwKTsKCiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICAgICAgICAgICAgYS5kb3dubG9hZCA9IG5hbWU7CiAgICAgICAgICAgICAgICAgICAgYS5ocmVmID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsKICAgICAgICAgICAgICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0pKCk7Cjwvc2NyaXB0PgoKPHN0eWxlPgogICAgLnNsaWRlci13aWR0aDUwMAogICAgewogICAgICAgIHdpZHRoOiA1MDBweDsKICAgIH0KPC9zdHlsZT4KCjwvaGVhZD4KCjxib2R5PgoKX19DSEFSVFNfVEVYVF9fCgo8aDI+UGVyY2VudGlsZSBSZXNwb25zZSBUaW1lIERpc3RyaWJ1dGlvbjwvaDI+Cgo8aW5wdXQgdHlwZT0iZmlsZSIgaWQ9ImZpbGVzIiBuYW1lPSJmaWxlc1tdIiBtdWx0aXBsZSAvPgoKPHByZSBpZD0iZmlsZURpc3BsYXlBcmVhIj5QbGVhc2Ugc2VsZWN0IGZpbGUocykgYWJvdmUuPC9wcmU+Cgo8IS0tRGl2IHRoYXQgd2lsbCBob2xkIHRoZSBjaGFydC0tPgo8ZGl2IGlkPSJjaGFydF9kaXYiPk5vbmUgTG9hZGVkPC9kaXY+CgpMYXRlbmN5IHRpbWUgdW5pdHM6CjxzZWxlY3QgbmFtZT0idW5pdHMiIHNpemU9IjEiIGlkPSJ0aW1lVW5pdFNlbGVjdGlvbiIgb25DaGFuZ2U9InRpbWVVbml0c1NlbGVjdGVkKCkiPgogICAgPG9wdGlvbiB2YWx1ZT0iTGF0ZW5jeSAoc2Vjb25kcykiPnNlY29uZHM8L29wdGlvbj4KICAgIDxvcHRpb24gc2VsZWN0ZWQgdmFsdWU9IkxhdGVuY3kgKG1pbGxpc2Vjb25kcykiPm1pbGxpc2Vjb25kczwvb3B0aW9uPgogICAgPG9wdGlvbiB2YWx1ZT0iTGF0ZW5jeSAocXMpIj5taWNyb3NlY29uZHM8L29wdGlvbj4KICAgIDxvcHRpb24gdmFsdWU9IkxhdGVuY3kgKG5hbm9zZWNvbmRzKSI+bmFub3NlY29uZHM8L29wdGlvbj4KPC9zZWxlY3Q+CjxidXR0b24gdHlwZT0nYnV0dG9uJyBvbmNsaWNrPSdkb0V4cG9ydChldmVudCknPkV4cG9ydCBJbWFnZTwvYnV0dG9uPgoKJm5ic3A7ICZuYnNwOyAmbmJzcDsgJm5ic3A7CjxwPgpQZXJjZW50aWxlIHJhbmdlOgoKPGlucHV0IHR5cGU9InJhbmdlIiBjbGFzcz0ic2xpZGVyLXdpZHRoNTAwIgogICAgICAgbWluPSIxIiBtYXg9IjgiIHZhbHVlPSI3IiBzdGVwPSIxIgogICAgICAgd2lkdGg9IjMwMHB4IgogICAgICAgb25jaGFuZ2U9InNob3dWYWx1ZSh0aGlzLnZhbHVlKSIgLz4KPHNwYW4gaWQ9InBlcmNlbnRpbGVSYW5nZSI+OTkuOTk5OTklPC9zcGFuPgo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCI+CiAgICBmdW5jdGlvbiBzaG93VmFsdWUobmV3VmFsdWUpIHsKICAgICAgICB2YXIgeCA9IE1hdGgucG93KDEwLCBuZXdWYWx1ZSk7CiAgICAgICAgdmFyIHBlcmNlbnRpbGUgPSAxMDAuMCAtICgxMDAuMCAvIHgpOwogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwZXJjZW50aWxlUmFuZ2UiKS5pbm5lckhUTUw9cGVyY2VudGlsZSArICIlIjsKICAgICAgICBtYXhQZXJjZW50aWxlID0geDsKICAgICAgICBkcmF3Q2hhcnQoKTsKICAgICAgICByZXR1cm4ge3R5cGVkOiAnJ307CiAgICB9Cjwvc2NyaXB0Pgo8L3A+CjxwPgogICAgPGJyPgoqKiogTm90ZTogSW5wdXQgZmlsZXMgYXJlIGV4cGVjdGVkIHRvIGJlIGluIHRoZSAuaGdybSBmb3JtYXQgcHJvZHVjZWQgYnkKSGlzdG9ncmFtTG9nUHJvY2Vzc29yLCBvciB0aGUgcGVyY2VudGlsZSBvdXRwdXQgZm9ybWF0IGZvciBIZHJIaXN0b2dyYW0uClNlZSBleGFtcGxlIGZpbGUgZm9ybWF0CiAgICA8YSBocmVmPSJodHRwczovL2dpdGh1Yi5jb20vSGRySGlzdG9ncmFtL0hkckhpc3RvZ3JhbS9ibG9iL21hc3Rlci9Hb29nbGVDaGFydHNFeGFtcGxlL2V4YW1wbGUxLnR4dCI+aGVyZTwvYT4KPC9wPgo8IS0tPGg0PkV4cGVjdGVkIFNlcnZpY2UgTGV2ZWw6PC9oND4tLT4KPCEtLTxpbnB1dCB0eXBlPSJjaGVja2JveCIgbmFtZT0iRVNMIiB2YWx1ZT0iRVNMIj5QbG90IEV4cGVjdGVkIFNlcnZpY2UgTGV2ZWw8YnI+LS0+CjwhLS1QZXJjZW50aWxlOi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xQZXJjZW50aWxlMCIgbmFtZT0iRVNMUGVyY2VudGlsZTAiIHNpemU9IjYiIHZhbHVlID0gOTAgLz4tLT4KPCEtLSUgJm5ic3AgJm5ic3AgJm5ic3AgTGltaXQ6LS0+CjwhLS08aW5wdXQgdHlwZT0idGV4dCIgaWQ9IkVTTExpbWl0MCIgbmFtZT0iRVNMTGltaXQwIiBzaXplPSIxMiIvPi0tPgo8IS0tPGJyPi0tPgo8IS0tUGVyY2VudGlsZTotLT4KPCEtLTxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iRVNMUGVyY2VudGlsZTEiIG5hbWU9IkVTTFBlcmNlbnRpbGUxIiBzaXplPSI2IiB2YWx1ZSA9IDk5IC8+LS0+CjwhLS0lICZuYnNwICZuYnNwICZuYnNwIExpbWl0Oi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xMaW1pdDEiIG5hbWU9IkVTTExpbWl0MSIgc2l6ZT0iMTIiLz4tLT4KPCEtLTxicj4tLT4KPCEtLVBlcmNlbnRpbGU6LS0+CjwhLS08aW5wdXQgdHlwZT0idGV4dCIgaWQ9IkVTTFBlcmNlbnRpbGUyIiBuYW1lPSJFU0xQZXJjZW50aWxlMiIgc2l6ZT0iNiIgdmFsdWUgPSA5OS45OSAvPi0tPgo8IS0tJSAmbmJzcCAmbmJzcCAmbmJzcCBMaW1pdDotLT4KPCEtLTxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iRVNMTGltaXQyIiBuYW1lPSJFU0xMaW1pdDIiIHNpemU9IjEyIi8+LS0+CjwhLS08YnI+LS0+CjwhLS1QZXJjZW50aWxlOi0tPgo8IS0tPGlucHV0IHR5cGU9InRleHQiIGlkPSJFU0xQZXJjZW50aWxlMyIgbmFtZT0iRVNMUGVyY2VudGlsZTIiIHNpemU9IjYiIHZhbHVlPSIxMDAuMCIgcmVhZG9ubHkvPi0tPgo8IS0tJSAmbmJzcCAmbmJzcCAmbmJzcCBMaW1pdDotLT4KPCEtLTxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iRVNMTGltaXQzIiBuYW1lPSJFU0xMaW1pdDIiIHNpemU9IjEyIi8+LS0+CgonJycKCnN1bW1hcnlfaHRtbF8zID0gJycnPC9ib2R5Pgo8L2h0bWw+CicnJwoKIyA8aDI+PGEgaHJlZj0iaHR0cHM6Ly93Zm91Y2hlLmdpdGh1Yi5pby9UdWxpcC1kb2NzIj5fX0RFU0MxX188L2E+IC8gX19ERVNDMl9fPC9oMj4KIyA8aDI+X19ERVNDMV9fIC8gX19ERVNDMl9fPC9oMj4KCmhlYWRlciA9ICcnJzwhRE9DVFlQRSBodG1sPgo8aHRtbD4KCjxzdHlsZT4KdGFibGUsIHRoLCB0ZCB7CiAgYm9yZGVyOjFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjE2cHg7IHRleHQtYWxpZ246IGNlbnRlcjsKfQp0aDpudGgtY2hpbGQobisxNCkgewogICAgYmFja2dyb3VuZC1jb2xvcjogI0U1RTRFMjsKfQp0ZDpudGgtY2hpbGQobisxNCkgewogICAgYmFja2dyb3VuZC1jb2xvcjogI0U1RTRFMjsKfQo8L3N0eWxlPgoKPGJvZHk+Cgo8aDI+PGEgaHJlZj0iaHR0cHM6Ly93Zm91Y2hlLmdpdGh1Yi5pby9UdWxpcC1kb2NzIj5fX0RFU0MxX188L2E+IC8gX19ERVNDMl9fPC9oMj4KCjx0YWJsZSBzdHlsZT0id2lkdGg6MTAwJSI+CiAgPHRyPgogICAgPHRoPkJlbmNobWFyazwvdGg+CiAgICA8dGg+UnVuIElkPC90aD4KICAgIDx0aD4jTjwvdGg+CiAgICA8dGg+I0Y8L3RoPgogICAgPHRoPkR1cmF0aW9uPC90aD4KICAgIDx0aD5BcHM8L3RoPgogICAgPHRoPkF2Z19SdDwvdGg+CiAgICA8dGg+U3RkZXY8L3RoPgogICAgPHRoPk1pbl9SdDwvdGg+CiAgICA8dGg+OTBwX1J0PC90aD4KICAgIDx0aD45OXBfUnQ8L3RoPgogICAgPHRoPk1heF9SdDwvdGg+CiAgICA8dGg+TWF4X1J0dDwvdGg+CiAgICA8dGg+QVFTPC90aD4KICAgIDx0aD5NUVM8L3RoPgogICAgPHRoPkFXVDwvdGg+CiAgICA8dGg+TVdUPC90aD4KICAgIDx0aD5DUFVfVDwvdGg+CiAgICA8dGg+Q1BVPC90aD4KICAgIDx0aD5NRU08L3RoPgogIDwvdHI+CicnJwoKYmVuY2htYXJrX2NvbHVtbnMgPSAnJycKICA8dHI+CiAgICA8dGg+QmVuY2htYXJrPC90aD4KICAgIDx0aD5SdW4gSWQ8L3RoPgogICAgPHRoPiNOPC90aD4KICAgIDx0aD4jRjwvdGg+CiAgICA8dGg+RHVyYXRpb248L3RoPgogICAgPHRoPkFwczwvdGg+CiAgICA8dGg+QXZnX1J0PC90aD4KICAgIDx0aD5TdGRldjwvdGg+CiAgICA8dGg+TWluX1J0PC90aD4KICAgIDx0aD45MHBfUnQ8L3RoPgogICAgPHRoPjk5cF9SdDwvdGg+CiAgICA8dGg+TWF4X1J0PC90aD4KICAgIDx0aD5NYXhfUnR0PC90aD4KICAgIDx0aD5BUVM8L3RoPgogICAgPHRoPk1RUzwvdGg+CiAgICA8dGg+QVdUPC90aD4KICAgIDx0aD5NV1Q8L3RoPgogICAgPHRoPkNQVV9UPC90aD4KICAgIDx0aD5DUFU8L3RoPgogICAgPHRoPk1FTTwvdGg+CiAgPC90cj4KJycnCgpiZW5jaG1hcmtfaGVhZGVyID0gJycnCiAgPHRyPgogICAgPHRkPiVzPC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogICAgPHRkPjwvdGQ+CiAgICA8dGQ+PC90ZD4KICAgIDx0ZD48L3RkPgogIDwvdHI+CicnJwoKYmVuY2htYXJrX2VtcHR5X3JvdyA9ICcnJwogIDx0cj4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgICA8dGQ+Jm5ic3A7PC90ZD4KICAgIDx0ZD4mbmJzcDs8L3RkPgogICAgPHRkPiZuYnNwOzwvdGQ+CiAgPC90cj4KJycnCgpiZW5jaG1hcmtfZGV0YWlsX3JvdyA9ICcnJwogIDx0cj4KICAgIDx0ZD4lczwvdGQ+CiAgICA8dGQ+JWQ8L3RkPgogICAgPHRkPiVkPC90ZD4KICAgIDx0ZD4lZDwvdGQ+CiAgICA8dGQ+JXM8L3RkPgogICAgPHRkPiUuM2Y8L3RkPgogICAgPHRkPiUuM2YgbXM8L3RkPgogICAgPHRkPiUuMWYgbXM8L3RkPgogICAgPHRkPiUuMWYgbXM8L3RkPgogICAgPHRkPiUuMWYgbXM8L3RkPgogICAgPHRkPiUuMWYgbXM8L3RkPgogICAgPHRkPiUuMWYgbXM8L3RkPgogICAgPHRkPiVzPC90ZD4KICAgIDx0ZD4lLjFmPC90ZD4KICAgIDx0ZD4lZDwvdGQ+CiAgICA8dGQ+JS4xZjwvdGQ+CiAgICA8dGQ+JS4xZjwvdGQ+CiAgICA8dGQ+JXM8L3RkPgogICAgPHRkPiUuMWY8L3RkPgogICAgPHRkPiUuMWY8L3RkPgogIDwvdHI+CicnJwoKYmVuY2htYXJrX3N1bW1hcnlfcm93ID0gJycnCiAgPHRyPgogICAgPHRkPiVzPC90ZD4KICAgIDx0ZD4lczwvdGQ+CiAgICA8dGQ+PGI+JWQ8L2I+PC90ZD4KICAgIDx0ZD48Yj48dGFnMT4lZDwvdGFnMT48L2I+PC90ZD4KICAgIDx0ZD48Yj4lczwvYj48L3RkPgogICAgPHRkPjxiPjx0YWcyPiUuM2Y8L3RhZzI+PC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4zZiBtczwvYj48L3RkPgogICAgPHRkPjxiPiUuMWYgbXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmIG1zPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZiBtczwvYj48L3RkPgogICAgPHRkPjxiPiUuMWYgbXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmIG1zPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JXM8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JWQ8L2I+PC90ZD4KICAgIDx0ZD48Yj4lLjFmPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZjwvYj48L3RkPgogICAgPHRkPjxiPiVzPC9iPjwvdGQ+CiAgICA8dGQ+PGI+JS4xZjwvYj48L3RkPgogICAgPHRkPjxiPiUuMWY8L2I+PC90ZD4KICA8L3RyPgonJycKCnRyYWlsZXIgPSAnJycKPC90YWJsZT4KPC9ib2R5Pgo8L2h0bWw+CicnJwoKY2hhcnRzX2h0bWwgPSAnJycKPGgyPkFjdGlvbnMgcGVyIFNlY29uZDwvaDI+CiAgPGRpdiBpZD0ibWFpbiIgc3R5bGU9IndpZHRoOiAxMDAlO2hlaWdodDo0MDBweDsiPjwvZGl2PgogIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9lY2hhcnRzLzUuNi4wL2VjaGFydHMubWluLmpzIj48L3NjcmlwdD4KICA8c2NyaXB0IHNyYz0iX19KU19UX0NIQVJUX18iPjwvc2NyaXB0Pgo8aDI+UmVzcG9uc2UgVGltZXMgKG1zKTwvaDI+CiAgPGRpdiBpZD0ibWFpbl9wIiBzdHlsZT0id2lkdGg6IDEwMCU7aGVpZ2h0OjQwMHB4OyI+PC9kaXY+CiAgPHNjcmlwdCBzcmM9Il9fSlNfUF9DSEFSVF9fIj48L3NjcmlwdD4KJycnCgpjaGFydF90X2h0bWwgPSAnJycKdmFyIG15Q2hhcnQxID0gZWNoYXJ0cy5pbml0KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWluJykpOwoKdmFyIGRhdGEgPSAgX19EQVRBX187Cgp2YXIgb3B0aW9uID0gewogIGxlZ2VuZDoge30sCiAgdG9vbHRpcDogewogICAgdHJpZ2dlcjogJ2F4aXMnLAogIH0sCiAgZGF0YXNldDogewogICAgc291cmNlOmRhdGEsCiAgICBkaW1lbnNpb25zOiBbJ3RpbWVzdGFtcCcsICdzZW5zb3IxJywgJ3NlbnNvcjInXSwKICB9LAogIHhBeGlzOiB7IHR5cGU6ICd0aW1lJyB9LAogIHlBeGlzOiB7IH0sCiAgc2VyaWVzOiBbCiAgewogICAgIG5hbWU6ICdBY3Rpb25zL3MnLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3IxJyAvLyByZWZlciBzZW5zb3IgMSB2YWx1ZSAKICAgICB9CiAgfSx7CiAgICAgbmFtZTogJ0ZhaWx1cmVzL3MnLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3IyJwogIH0KfV0KfTsKbXlDaGFydDEuc2V0T3B0aW9uKG9wdGlvbik7CicnJwoKY2hhcnRfcF9odG1sID0gJycnCnZhciBteUNoYXJ0MiA9IGVjaGFydHMuaW5pdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFpbl9wJykpOwoKdmFyIGRhdGEgPSAgX19EQVRBX187Cgp2YXIgb3B0aW9uID0gewogIGxlZ2VuZDoge30sCiAgdG9vbHRpcDogewogICAgdHJpZ2dlcjogJ2F4aXMnLAogIH0sCiAgZGF0YXNldDogewogICAgc291cmNlOmRhdGEsCiAgICBkaW1lbnNpb25zOiBbJ3RpbWVzdGFtcCcsICdzZW5zb3IxJywgJ3NlbnNvcjInLCAnc2Vuc29yMycsICdzZW5zb3I0JywgJ3NlbnNvcjUnLCAnc2Vuc29yNiddLAogIH0sCiAgeEF4aXM6IHsgdHlwZTogJ3RpbWUnIH0sCiAgeUF4aXM6IHsgfSwKICBzZXJpZXM6IFsKICB7CiAgICAgbmFtZTogJ01heCcsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjYnIC8vIHJlZmVyIHNlbnNvciAxIHZhbHVlCiAgICAgfQogIH0sewogICAgIG5hbWU6ICdwOTknLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3I1JyAvLyByZWZlciBzZW5zb3IgMSB2YWx1ZQogICAgIH0KICB9LHsKICAgICBuYW1lOiAncDk1JywKICAgICB0eXBlOiAnbGluZScsCiAgICAgc21vb3RoOiB0cnVlLAogICAgIGVuY29kZTogewogICAgICAgeDogJ3RpbWVzdGFtcCcsCiAgICAgICB5OiAnc2Vuc29yNCcgLy8gcmVmZXIgc2Vuc29yIDEgdmFsdWUKICAgICB9CgogIH0sewogICAgIG5hbWU6ICdwOTAnLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3IzJyAvLyByZWZlciBzZW5zb3IgMSB2YWx1ZQogICAgIH0KCiAgfSx7CiAgICAgbmFtZTogJ0F2ZycsCiAgICAgdHlwZTogJ2xpbmUnLAogICAgIHNtb290aDogdHJ1ZSwKICAgICBlbmNvZGU6IHsKICAgICAgIHg6ICd0aW1lc3RhbXAnLAogICAgICAgeTogJ3NlbnNvcjInCiAgICAgfQogIH0sewogICAgIG5hbWU6ICdNaW4nLAogICAgIHR5cGU6ICdsaW5lJywKICAgICBzbW9vdGg6IHRydWUsCiAgICAgZW5jb2RlOiB7CiAgICAgICB4OiAndGltZXN0YW1wJywKICAgICAgIHk6ICdzZW5zb3IxJwogIH0KfV0KfTsKbXlDaGFydDIuc2V0T3B0aW9uKG9wdGlvbik7Cgp3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbigpIHsKICBteUNoYXJ0MS5yZXNpemUoKTsKICBteUNoYXJ0Mi5yZXNpemUoKTsKfTsKJycnCgpjbGFzcyBTdW1tYXJ5OgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYubnVtX2FjdGlvbnMgPSAwCiAgICAgICAgc2VsZi5udW1fZmFpbGVkID0gMAogICAgICAgIHNlbGYuZHVyYXRpb24gPSAwLjAKICAgICAgICBzZWxmLm1pbl9ydCA9IDEwMDAwMDAwMDAuMAogICAgICAgIHNlbGYubWF4X3J0ID0gMC4wCiAgICAgICAgc2VsZi5tYXhfcnRfdHMgPSAiIgogICAgICAgIHNlbGYubWVtID0gMC4wCiAgICAgICAgc2VsZi5jcHUgPSAwLjAKICAgICAgICBzZWxmLm1heF9hd3QgPSAwLjAKICAgICAgICBzZWxmLm1heF93dCA9IDAuMAogICAgICAgIHNlbGYuYXZnX3FzID0gMC4wCiAgICAgICAgc2VsZi5tYXhfcXMgPSAwCiAgICAgICAgc2VsZi5uYW1lID0gIiIKICAgICAgICBzZWxmLmNwdV90aW1lX25zID0gMAogICAgICAgIHNlbGYuY2hhcnRfdF9saXN0ID0gW10gICAjIFsnMjAxOC0wNC0xMFQyMDo0MDozMy4xMDAnLCAxMTAwLCAwXQogICAgICAgIHNlbGYuY2hhcnRfcF9saXN0ID0gW10gICAjIFsnMjAxOC0wNC0xMFQyMDo0MDozM1onLCAxLCA1LCAxMCwgMjAsIDI1LCAzMF0KCmRlZiBjcmVhdGVSZXBvcnQoZmlsZW5hbWUsIHRleHQpOgoKICAgIGN3ZCA9IG9zLmdldGN3ZCgpCiAgICBpZiBvcy5wYXRoLmlzZGlyKCJidWlsZC9yZXBvcnRzL3R1bGlwIik6CiAgICAgICAgb3MuY2hkaXIoImJ1aWxkL3JlcG9ydHMvdHVsaXAiKQoKICAgIHByaW50KCJcbk91dHB1dCBmaWxlbmFtZSA9ICIgKyBmaWxlbmFtZSkKCiAgICBpZiB0ZXh0WzBdID09ICd7JzoKICAgICAgICBjb25maWdfZmlsZW5hbWUgPSAiIgogICAgZWxzZToKICAgICAgICBjb25maWdfZmlsZW5hbWUgPSB0ZXh0CgogICAgamhoID0ge30KICAgIGpzcyA9IHt9CgogICAgcHJpbnRfZGV0YWlsX3Jvd3MgPSBUcnVlCgogICAgZ2xvYmFsIG5hbWUycwogICAgZ2xvYmFsIG5hbWUyc19saXN0CiAgICBnbG9iYWwgYmVuY2htYXJrX2lkCiAgICBuYW1lMnMgPSAiIgogICAgbmFtZTJzX2xpc3QgPSBbXQogICAgYmVuY2htYXJrX2lkID0gMAoKICAgIHNtID0gTm9uZQogICAgamggPSBIaXN0b2dyYW0oMSwgMzYwMCoxMDAwKjEwMDAsIDMpCiAgICBmaWxlT2JqID0gb3BlbihmaWxlbmFtZSkKICAgIGpiID0ganNvbi5sb2FkKGZpbGVPYmosIG9iamVjdF9wYWlyc19ob29rPU9yZGVyZWREaWN0KQogICAgdmVyc2lvbiA9IGpiWyd2ZXJzaW9uJ10KICAgIGRlc2MxID0gJ1R1bGlwICcgKyB2ZXJzaW9uCiAgICByYiA9IGpiWyJyZXN1bHRzIl0KCiAgICByZXBvcnRfZm4gPSBqYlsiY29uZmlnIl1bImFjdGlvbnMiXVsicmVwb3J0X2ZpbGVuYW1lIl0KICAgIHJlcG9ydF9maCA9IG9wZW4ocmVwb3J0X2ZuLCAidysiKQoKICAgIGdsb2JhbCByZXBvcnRfZG4KICAgIHJlcG9ydF9kbiA9IG9zLnBhdGguc3BsaXRleHQocmVwb3J0X2ZuKVswXQogICAgdHJ5OgogICAgICAgIG9zLm1ha2VkaXJzKHJlcG9ydF9kbikKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCgogICAgZGVmIG9kaXIoZmlsZW5hbWUpOgogICAgICAgIGdsb2JhbCByZXBvcnRfZG4KICAgICAgICByZXR1cm4gb3MucGF0aC5qb2luKG9zLmdldGN3ZCgpLCByZXBvcnRfZG4sIGZpbGVuYW1lKQoKICAgIGRlZiBvZGlySHRtbChmaWxlbmFtZSk6CiAgICAgICAgZ2xvYmFsIHJlcG9ydF9kbgogICAgICAgIHJldHVybiByZXBvcnRfZG4gKyAiLyIgKyBmaWxlbmFtZQoKICAgIGRlZiBuYW1lX3RvX2hyZWYobmFtZSk6CiAgICAgICAgaHJlZiA9ICdfJyArIHJlLnN1YihyJ1xXJywgJ18nLCBuYW1lLmxvd2VyKCkpCiAgICAgICAgaGZpbGUgPSBvcy5wYXRoLnNwbGl0ZXh0KGNvbmZpZ19maWxlbmFtZSlbMF0gKyAiLmh0bWwiCiAgICAgICAgcmV0dXJuICI8YSBocmVmPSclcyMlcyc+IiUoaGZpbGUsIGhyZWYpICsgbmFtZSArICI8L2E+IgoKICAgIGlmIGxlbihjb25maWdfZmlsZW5hbWUpID4gMDoKICAgICAgICBkZXNjMiA9ICI8YSBocmVmPSclcyc+IiUob3MucGF0aC5zcGxpdGV4dChjb25maWdfZmlsZW5hbWUpWzBdICsgIi5odG1sIikKICAgIGVsc2U6CiAgICAgICAgZGVzYzIgPSAiIgoKICAgIGlmIGxlbihjb25maWdfZmlsZW5hbWUpID4gMDoKICAgICAgICBkZXNjMiArPSBqYlsiY29uZmlnIl1bImFjdGlvbnMiXVsiZGVzY3JpcHRpb24iXSArICI8L2E+IC8gIiArIGpiWyJ0aW1lc3RhbXAiXVs6LTNdCiAgICBlbHNlOgogICAgICAgIGRlc2MyICs9IGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJkZXNjcmlwdGlvbiJdICsgIiAvICIgKyBqYlsidGltZXN0YW1wIl1bOi0zXQoKICAgIHByaW50KCJSZXBvcnQgZmlsZW5hbWUgPSAiICsgcmVwb3J0X2ZuKQoKICAgIGRlZiBwcmludGYocyk6CiAgICAgICAgcmVwb3J0X2ZoLndyaXRlKHMpCgogICAgZGVmIGFjdGlvbk5hbWUocyk6CiAgICAgICAgcmV0dXJuIHMuc3BsaXQoIiwiKVswXS5zdHJpcCgpCgogICAgZGVmIGFjdGlvbkRlc2Mocyk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gcy5zcGxpdCgiLCIpWzFdLnN0cmlwKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiAiIgoKICAgIGRlZiBzdHJfZnJvbV9jcHVfdGltZV9ucyh2X25zKToKICAgICAgICByID0gc3RyKGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPXZfbnMvMTAwMDAwMDAwMC4wKSkgICNbOi01XQogICAgICAgIGlmICcuJyBpbiByOgogICAgICAgICAgICByID0gcls6LTVdCiAgICAgICAgcmV0dXJuIHIKCiAgICBkZWYgcHJpbnRfZ2xvYmFsX3N1bW1hcnkoKToKICAgICAgICBnbG9iYWwgbmFtZTJzCiAgICAgICAgZ2xvYmFsIG5hbWUyc19saXN0CiAgICAgICAgZ2xvYmFsIGJlbmNobWFya19pZAoKICAgICAgICBhdmdfYXBzID0gMC4wIGlmIHNtLm5hbWUgaW4gWyJvblN0YXJ0IiwgIm9uU3RvcCJdIGVsc2Ugc20ubnVtX2FjdGlvbnMvc20uZHVyYXRpb24KICAgICAgICBpZiBzbS5uYW1lIGluIFsib25TdGFydCIsICJvblN0b3AiXToKICAgICAgICAgICAgY3B1X3QgPSAiMDowMDowMCIKICAgICAgICAgICAgc20uY3B1ID0gMC4wCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY3B1X3QgPSBzdHJfZnJvbV9jcHVfdGltZV9ucyhzbS5jcHVfdGltZV9ucykKCiAgICAgICAgc3RhdHNGaWxlbmFtZSA9ICclc18lZC5odG1sJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHN0YXRzRmlsZW5hbWVIdG1sID0gJyVzXyVkLmh0bWwnJShvZGlySHRtbChyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHRleHQgPSAiPGEgaHJlZj0nJXMnPiVzPC9hPiIlKHN0YXRzRmlsZW5hbWVIdG1sLCJbU3VtbWFyeV0iKQogICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0oc3RhdHNGaWxlbmFtZSkKICAgICAgICBwcmludFN0cmVhbS5wcmludChzdW1tYXJ5X2h0bWxfMSkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIGZ1bmN0aW9uIGRyYXdJbml0aWFsQ2hhcnQoKSB7JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgICAgICAvLyBDb25uZWN0IHRoZSBjaG9vc2UgZmlsZXMgYnV0dG9uOicpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoIiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgaGFuZGxlRmlsZVNlbGVjdCwgZmFsc2UpOyIpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICAgICAgLy8gTG9hZCBzb21lIHN0YXRpYyBleGFtcGxlIGRhdGE6JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBpZHggPSAwCiAgICAgICAgYWN0aW9uc1N0cmluZyA9ICIiCiAgICAgICAgaGlzdG9zU3RyaW5nID0gIiIKICAgICAgICBmb3Iga2V5IGluIGpzcy5rZXlzKCk6CiAgICAgICAgICAgIGlkeCArPSAxCiAgICAgICAgICAgIHNteCA9IGpzc1trZXldCiAgICAgICAgICAgIGpoeCA9IGpoaFtrZXldCiAgICAgICAgICAgIGlmIGxlbihhY3Rpb25zU3RyaW5nKSA+IDA6CiAgICAgICAgICAgICAgICBhY3Rpb25zU3RyaW5nICs9ICcsICcKICAgICAgICAgICAgICAgIGhpc3Rvc1N0cmluZyArPSAnLCAnCiAgICAgICAgICAgIGFjdGlvbnNTdHJpbmcgKz0gIidBJXMnIiUoa2V5KQogICAgICAgICAgICBoaXN0b3NTdHJpbmcgKz0gImRhdGElZFN0ciIlKGlkeCkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB2YXIgZGF0YSVkU3RyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZGl2I2RhdGFfJWQiKS5pbm5lckhUTUwudHJpbSgpOyclKGlkeCxpZHgpKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBpZiBpZHggPiAxOgogICAgICAgICAgICBhY3Rpb25zU3RyaW5nICs9ICcsICcgKyAiJ1MnIgogICAgICAgICAgICBoaXN0b3NTdHJpbmcgKz0gJywgJyArICJkYXRhJWRTdHIiJSgwKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIHZhciBkYXRhJWRTdHIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJkaXYjZGF0YV8lZCIpLmlubmVySFRNTC50cmltKCk7JyUoMCwwKSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB2YXIgaGlzdG9zID0gWyVzXTsnJShoaXN0b3NTdHJpbmcpKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIHByaW50U3RyZWFtLnByaW50KCcgICAgdmFyIG5hbWVzID0gWyVzXTsnJShhY3Rpb25zU3RyaW5nKSkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICBzZXRDaGFydERhdGEobmFtZXMsIGhpc3Rvcyk7JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnICAgIGRyYXdDaGFydCgpOycpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJyAgICB9JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKICAgICAgICB0Q2hhcnRGaWxlbmFtZSA9ICclc18lZF90LmpzJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHRDaGFydEZpbGVuYW1lSHRtbCA9ICclc18lZF90LmpzJyUob2Rpckh0bWwocmVwb3J0X2ZuLnNwbGl0KCcuJylbMF0pLGJlbmNobWFya19pZCkKICAgICAgICBwQ2hhcnRGaWxlbmFtZSA9ICclc18lZF9wLmpzJyUob2RpcihyZXBvcnRfZm4uc3BsaXQoJy4nKVswXSksYmVuY2htYXJrX2lkKQogICAgICAgIHBDaGFydEZpbGVuYW1lSHRtbCA9ICclc18lZF9wLmpzJyUob2Rpckh0bWwocmVwb3J0X2ZuLnNwbGl0KCcuJylbMF0pLGJlbmNobWFya19pZCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgKICAgICAgICAgICAgc3VtbWFyeV9odG1sXzIKICAgICAgICAgICAgICAgIC5yZXBsYWNlKCJfX0NIQVJUU19URVhUX18iLAogICAgICAgICAgICAgICAgICAgIGNoYXJ0c19odG1sCiAgICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgiX19KU19UX0NIQVJUX18iLG9zLnBhdGguYmFzZW5hbWUodENoYXJ0RmlsZW5hbWVIdG1sKSkKICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCJfX0pTX1BfQ0hBUlRfXyIsb3MucGF0aC5iYXNlbmFtZShwQ2hhcnRGaWxlbmFtZUh0bWwpKSkKICAgICAgICAgICAgICAgICkKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgaWR4ID0gMAogICAgICAgIGZvciBrZXkgaW4ganNzLmtleXMoKToKICAgICAgICAgICAgaWR4ICs9IDEKICAgICAgICAgICAgc214ID0ganNzW2tleV0KICAgICAgICAgICAgamh4ID0gamhoW2tleV0KICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJzxkaXYgaWQ9ImRhdGFfJWQiIGNsYXNzPSJoaXN0byI+JyUoaWR4KSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgICAgIGpoeC5vdXRwdXRQZXJjZW50aWxlRGlzdHJpYnV0aW9uKHByaW50U3RyZWFtLCAxMDAwLjApCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50KCc8L2Rpdj4nKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoJzxkaXYgaWQ9ImRhdGFfMCIgY2xhc3M9Imhpc3RvIj4nKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIGpoLm91dHB1dFBlcmNlbnRpbGVEaXN0cmlidXRpb24ocHJpbnRTdHJlYW0sIDEwMDAuMCkKICAgICAgICBwcmludFN0cmVhbS5wcmludCgnPC9kaXY+JykKICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCkKCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoc3VtbWFyeV9odG1sXzMpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgIHByaW50U3RyZWFtLmNsb3NlKCkKCiAgICAgICAgIyBBY3Rpb25zL3MgY2hhcnQKICAgICAgICAjY2hhcnRfdF9saXN0ID0gWwogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQwOjMzLjEwMCcsIDExMDAsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQwOjUzLjIwMCcsIDEwMDIsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQxOjAzLjMwMCcsIDExMDQsIDBdLAogICAgICAgICMgICAgWycyMDE4LTA0LTEwVDIwOjQ0OjAzLjQwMCcsIDEyMDUuNSwgMF0sCiAgICAgICAgIyAgICBbJzIwMTgtMDQtMTBUMjA6NDU6MDMuNTAwJywgMTMwNiwgMF0KICAgICAgICAjXQogICAgICAgIGNoYXJ0X3BfbGlzdCA9IFsKICAgICAgICAgICAgWycyMDE4LTA0LTEwVDIwOjQwOjMzWicsIDEsIDUsIDEwLCAyMCwgMjUsIDMwIF0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0MDo1M1onLCAyLCA2LCAxNSwgMjUsIDMwLCAzNV0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0MTowM1onLCAyLCA1LCAyMCwgMzAsIDM1LCA0MF0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0NDowM1onLCAzLCA3LCAxMiwgMjIsIDMwLCAzMl0sCiAgICAgICAgICAgIFsnMjAxOC0wNC0xMFQyMDo0NTowM1onLCAyLCAxMCwgMTMsIDIzLCAzMCwgMzNdCiAgICAgICAgXQogICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0odENoYXJ0RmlsZW5hbWUpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnQoY2hhcnRfdF9odG1sLnJlcGxhY2UoIl9fREFUQV9fIiwoIiVzIiUoc20uY2hhcnRfdF9saXN0KSkucmVwbGFjZSgidSciLCInIikpKQogICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oKQogICAgICAgIHByaW50U3RyZWFtLmZsdXNoKCkKICAgICAgICBwcmludFN0cmVhbS5jbG9zZSgpCgogICAgICAgICMgUmVzcG9uc2UgVGltZSAobXMpIGNoYXJ0CiAgICAgICAgcHJpbnRTdHJlYW0gPSBQcmludFN0cmVhbShwQ2hhcnRGaWxlbmFtZSkKICAgICAgICBwcmludFN0cmVhbS5wcmludChjaGFydF9wX2h0bWwucmVwbGFjZSgiX19EQVRBX18iLCgiJXMiJShzbS5jaGFydF9wX2xpc3QpKS5yZXBsYWNlKCJ1JyIsIiciKSkpCiAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigpCiAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgIHByaW50U3RyZWFtLmNsb3NlKCkKCiAgICAgICAgaHRtbCA9IGJlbmNobWFya19zdW1tYXJ5X3JvdyUobmFtZTJzLHRleHQsc20ubnVtX2FjdGlvbnMsc20ubnVtX2ZhaWxlZCxzdHIoZGF0ZXRpbWUudGltZWRlbHRhKHNlY29uZHM9aW50KHNtLmR1cmF0aW9uKSkpLGF2Z19hcHMsamguZ2V0TWVhbigpLzEwMDAuMCxqaC5nZXRTdGREZXZpYXRpb24oKS8xMDAwLjAsc20ubWluX3J0LGpoLmdldFZhbHVlQXRQZXJjZW50aWxlKDkwLjApLzEwMDAuMCxqaC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5OS4wKS8xMDAwLjAsc20ubWF4X3J0LHNtLm1heF9ydF90c1s4Ol0sc20uYXZnX3FzLHNtLm1heF9xcyxzbS5tYXhfYXd0LHNtLm1heF93dCxjcHVfdCxzbS5jcHUsc20ubWVtKQogICAgICAgIGlmIG5vdCBwcmludF9kZXRhaWxfcm93czoKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPGI+IiwiIikKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC9iPiIsIiIpCiAgICAgICAgIyBWYWxpZGF0aW9uOiAjRgogICAgICAgIGlmIHNtLm51bV9mYWlsZWQgPiAwOgogICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8dGFnMT4iLCI8bWFyaz4iKQogICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8L3RhZzE+IiwiPC9tYXJrPiIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPHRhZzE+IiwiIikKICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC90YWcxPiIsIiIpCiAgICAgICAgIyBWYWxpZGF0aW9uOiBBdmdfQVBTCiAgICAgICAgI3ByaW50KHNtLm5hbWUpCiAgICAgICAgaWYgImFwc19yYXRlIiBpbiBqYlsiY29uZmlnIl1bImJlbmNobWFya3MiXVtzbS5uYW1lXS5rZXlzKCk6CiAgICAgICAgICAgIHRhcmdldF9hcHMgPSBqYlsiY29uZmlnIl1bImJlbmNobWFya3MiXVtzbS5uYW1lXVsiYXBzX3JhdGUiXQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRhcmdldF9hcHMgPSAwLjAKICAgICAgICBhcHNfcmF0ZV9zdGVwX2NoYW5nZSA9IDAuMAogICAgICAgIGlmICJhcHNfcmF0ZV9zdGVwX2NoYW5nZSIgaW4gamJbImNvbmZpZyJdWyJiZW5jaG1hcmtzIl1bc20ubmFtZV0ua2V5cygpOgogICAgICAgICAgICBhcHNfcmF0ZV9zdGVwX2NoYW5nZSA9IGpiWyJjb25maWciXVsiYmVuY2htYXJrcyJdW3NtLm5hbWVdWyJhcHNfcmF0ZV9zdGVwX2NoYW5nZSJdCiAgICAgICAgaWYgYXBzX3JhdGVfc3RlcF9jaGFuZ2UgPT0gMC4wIGFuZCB0YXJnZXRfYXBzID4gMC4wOgogICAgICAgICAgICBkZWx0YV9wZXJjZW50YWdlX2FwcyA9IDEwMC4wKmFicyh0YXJnZXRfYXBzLWF2Z19hcHMpL3RhcmdldF9hcHMKICAgICAgICAgICAgaWYgZGVsdGFfcGVyY2VudGFnZV9hcHMgPiAxLjU6CiAgICAgICAgICAgICAgICBodG1sID0gaHRtbC5yZXBsYWNlKCI8dGFnMj4iLCI8bWFyaz4iKQogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPC90YWcyPiIsIjwvbWFyaz4iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPHRhZzI+IiwiIikKICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcyPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQogICAgICAgIHByaW50ZihodG1sKQogICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICBuYW1lMnMgPSBuYW1lMnNfbGlzdFswXQogICAgICAgICAgICBkZWwgbmFtZTJzX2xpc3RbMF0KCiAgICBkZWYgcHJpbnRfYWN0aW9uX3N1bW1hcnkoKToKICAgICAgICBnbG9iYWwgbmFtZTJzCiAgICAgICAgZ2xvYmFsIG5hbWUyc19saXN0CiAgICAgICAgZ2xvYmFsIGJlbmNobWFya19pZAogICAgICAgIHBhZ2VfaWQgPSAwCiAgICAgICAgbnVtX2tleXMgPSBsZW4oanNzLmtleXMoKSkKICAgICAgICBmb3Iga2V5IGluIGpzcy5rZXlzKCk6CiAgICAgICAgICAgIHNteCA9IGpzc1trZXldCiAgICAgICAgICAgIGpoeCA9IGpoaFtrZXldCiAgICAgICAgICAgIGlmIGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJ1c2VyX2FjdGlvbnMiXS5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICB0ZXh0ID0gIlslcy4lc10iJShrZXksIGFjdGlvbk5hbWUoamJbImNvbmZpZyJdWyJhY3Rpb25zIl1bInVzZXJfYWN0aW9ucyJdW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGV4dCA9ICJbJXNdIiUoa2V5KQogICAgICAgICAgICBzdGF0c0ZpbGVuYW1lID0gJyVzXyVkXyVkLmh0bWwnJShvZGlyKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdKSxiZW5jaG1hcmtfaWQscGFnZV9pZCkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZUh0bWwgPSAnJXNfJWRfJWQuaHRtbCclKG9kaXJIdG1sKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdKSxiZW5jaG1hcmtfaWQscGFnZV9pZCkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZVByZXYgPSAnJXNfJWRfJWQuaHRtbCclKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdLGJlbmNobWFya19pZCxhYnMocGFnZV9pZC0xKSkKICAgICAgICAgICAgc3RhdHNGaWxlbmFtZU5leHQgPSAnJXNfJWRfJWQuaHRtbCclKHJlcG9ydF9mbi5zcGxpdCgnLicpWzBdLGJlbmNobWFya19pZCxwYWdlX2lkKzEpCiAgICAgICAgICAgIHRleHQgPSAiPGEgaHJlZj0nJXMnPiVzPC9hPiIlKHN0YXRzRmlsZW5hbWVIdG1sLHRleHQpCiAgICAgICAgICAgIHByaW50U3RyZWFtID0gUHJpbnRTdHJlYW0oc3RhdHNGaWxlbmFtZSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGh0bWw+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPHN0eWxlPiIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oInRhYmxlLCB0aCwgdGQgeyIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIiAgYm9yZGVyOjFweCBzb2xpZCBibGFjazsgZm9udC1zaXplOjE2cHg7IHRleHQtYWxpZ246IGNlbnRlcjsiKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCJ9IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigibWFyayB7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiICBiYWNrZ3JvdW5kLWNvbG9yOiBMaWdodEdyYXk7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiICBjb2xvcjogYmxhY2s7IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigifSIpCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIjwvc3R5bGU+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGJvZHk+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iLi4vJXMiPlVwPC9hPiclKHJlcG9ydF9mbikpCiAgICAgICAgICAgIGlmIChwYWdlX2lkID09IDApIGFuZCAobnVtX2tleXMgPT0gMSk6CiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCc8YSBocmVmPSIjIj5QcmV2PC9hPicpCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCc8YSBocmVmPSIjIj5OZXh0PC9hPicpCiAgICAgICAgICAgIGVsaWYgKHBhZ2VfaWQgPT0gMCkgYW5kIChudW1fa2V5cyA+IDEpOgogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iIyI+UHJldjwvYT4nKQogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignPGEgaHJlZj0iJXMiPk5leHQ8L2E+JyUoc3RhdHNGaWxlbmFtZU5leHQpKQogICAgICAgICAgICBlbGlmIHBhZ2VfaWQrMSA9PSBudW1fa2V5czoKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5QcmV2PC9hPiclKHN0YXRzRmlsZW5hbWVQcmV2KSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiMiPk5leHQ8L2E+JykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5QcmV2PC9hPiclKHN0YXRzRmlsZW5hbWVQcmV2KSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzxhIGhyZWY9IiVzIj5OZXh0PC9hPiclKHN0YXRzRmlsZW5hbWVOZXh0KSkKCiAgICAgICAgICAgIGlmIGpiWyJjb25maWciXVsiYWN0aW9ucyJdWyJ1c2VyX2FjdGlvbnMiXS5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICBkZXNjID0gIlslcy4lc10iJShrZXksIGFjdGlvbk5hbWUoamJbImNvbmZpZyJdWyJhY3Rpb25zIl1bInVzZXJfYWN0aW9ucyJdW2tleV0pKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZGVzYyA9ICJbQSVzXSIlKGtleSkKICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbigiPGgyPiVzIFBlcmNlbnRpbGUgUmVzcG9uc2UgVGltZSBEaXN0cmlidXRpb248L2gyPiIlKGRlc2MpKQoKICAgICAgICAgICAgI3ByaW50U3RyZWFtLnByaW50bG4oIjxwcmU+IikKICAgICAgICAgICAgI2poeC5vdXRwdXRQZXJjZW50aWxlRGlzdHJpYnV0aW9uKHByaW50U3RyZWFtLCAxMDAwLjApCgogICAgICAgICAgICBib3MgPSBCeXRlQXJyYXlPdXRwdXRTdHJlYW0oKQogICAgICAgICAgICBveCA9IFByaW50U3RyZWFtKGJvcykKICAgICAgICAgICAgamh4Lm91dHB1dFBlcmNlbnRpbGVEaXN0cmlidXRpb24ob3gsIDEwMDAuMCkKICAgICAgICAgICAgb3guZmx1c2goKQogICAgICAgICAgICBveC5jbG9zZSgpCiAgICAgICAgICAgIHB0ZXh0ID0gYm9zLnRvU3RyaW5nKCkKICAgICAgICAgICAgbGluZXMgPSBwdGV4dC5zcGxpdCgnXG4nKQogICAgICAgICAgICB0Y291bnQgPSBqaHguZ2V0VG90YWxDb3VudCgpCiAgICAgICAgICAgIGhlYWRlciA9IFRydWUKICAgICAgICAgICAgcmxpc3QgPSBbXQogICAgICAgICAgICBmb3IgbGluZSBpbiBsaW5lczoKICAgICAgICAgICAgICBpZiBsZW4obGluZSkgPT0gMDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgaWYgbGluZVswXSAhPSAiIyI6CiAgICAgICAgICAgICAgICBlID0gbGluZS5zcGxpdCgpCiAgICAgICAgICAgICAgICBpZiBoZWFkZXI6CiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJzx0YWJsZSBzdHlsZT0id2lkdGg6NjAwcHgiPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPHRyPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGg+JXM8L3RoPiclKGVbMF0pKQogICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRoPiVzPC90aD4nJShlWzFdKSkKICAgICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0aD4lczwvdGg+JyUoZVsyXSkpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGg+JXM8L3RoPiclKGVbM10pKQogICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRoPkFib3ZlQ291bnQ8L3RoPicpCiAgICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPC90cj4nKQogICAgICAgICAgICAgICAgICBoZWFkZXIgPSBGYWxzZQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgaWYgbGVuKGUpID09IDM6CiAgICAgICAgICAgICAgICAgICAgZS5hcHBlbmQoJycpCiAgICAgICAgICAgICAgICAgIHJsaXN0LmFwcGVuZChlKQogICAgICAgICAgICBybGlzdC5yZXZlcnNlKCkKICAgICAgICAgICAgZm9yIGUgaW4gcmxpc3Q6CiAgICAgICAgICAgICAgICBtYXJrID0gRmFsc2UKICAgICAgICAgICAgICAgIGlmIGVbMV0uc3RhcnRzd2l0aCgiMC45OTkwIik6CiAgICAgICAgICAgICAgICAgICAgbWFyayA9IFRydWUKICAgICAgICAgICAgICAgIGlmIGVbMV0uc3RhcnRzd2l0aCgiMC45OTAiKToKICAgICAgICAgICAgICAgICAgICBtYXJrID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgZVsxXSA9PSAiMC45NTAwMDAwMDAwMDAiOgogICAgICAgICAgICAgICAgICAgIG1hcmsgPSBUcnVlCiAgICAgICAgICAgICAgICBpZiBlWzFdID09ICIwLjkwMDAwMDAwMDAwMCI6CiAgICAgICAgICAgICAgICAgICAgbWFyayA9IFRydWUKICAgICAgICAgICAgICAgIGlmIGVbMV0gPT0gIjAuODAwMDAwMDAwMDAwIjoKICAgICAgICAgICAgICAgICAgICBtYXJrID0gVHJ1ZQogICAgICAgICAgICAgICAgaWYgZVsxXSA9PSAiMC41MDAwMDAwMDAwMDAiOgogICAgICAgICAgICAgICAgICAgIG1hcmsgPSBUcnVlCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgIDx0cj4nKQogICAgICAgICAgICAgICAgaWYgbWFyazoKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPjxtYXJrPiVzPC9tYXJrPjwvdGQ+JyUoZVswXSkpCiAgICAgICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0ZD48bWFyaz4lczwvbWFyaz48L3RkPiclKGVbMV0pKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJShlWzBdKSkKICAgICAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJShlWzFdKSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgICA8dGQ+JXM8L3RkPiclKGVbMl0pKQogICAgICAgICAgICAgICAgcHJpbnRTdHJlYW0ucHJpbnRsbignICAgIDx0ZD4lczwvdGQ+JyUoZVszXSkpCiAgICAgICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCcgICAgPHRkPiVzPC90ZD4nJSh0Y291bnQtaW50KGVbMl0pKSkKICAgICAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oJyAgPC90cj4nKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCI8L3RhYmxlPiIpCgogICAgICAgICAgICAjcHJpbnRTdHJlYW0ucHJpbnRsbigiPC9wcmU+IikKCiAgICAgICAgICAgIHByaW50U3RyZWFtLnByaW50bG4oIjwvYm9keT4iKQogICAgICAgICAgICBwcmludFN0cmVhbS5wcmludGxuKCI8L2h0bWw+IikKICAgICAgICAgICAgcHJpbnRTdHJlYW0uZmx1c2goKQogICAgICAgICAgICBwcmludFN0cmVhbS5jbG9zZSgpCiAgICAgICAgICAgIGF2Z19hcHMgPSAwLjAgaWYgc214Lm5hbWUgaW4gWyJvblN0YXJ0IiwgIm9uU3RvcCJdIGVsc2Ugc214Lm51bV9hY3Rpb25zL3NteC5kdXJhdGlvbgogICAgICAgICAgICBpZiBzbXgubmFtZSBpbiBbIm9uU3RhcnQiLCAib25TdG9wIl06CiAgICAgICAgICAgICAgICBjcHVfdCA9ICIwOjAwOjAwIgogICAgICAgICAgICAgICAgc214LmNwdSA9IDAuMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgY3B1X3QgPSBzdHJfZnJvbV9jcHVfdGltZV9ucyhzbXguY3B1X3RpbWVfbnMpCiAgICAgICAgICAgIGh0bWwgPSBiZW5jaG1hcmtfc3VtbWFyeV9yb3clKG5hbWUycyx0ZXh0LHNteC5udW1fYWN0aW9ucyxzbXgubnVtX2ZhaWxlZCxzdHIoZGF0ZXRpbWUudGltZWRlbHRhKHNlY29uZHM9aW50KHNtLmR1cmF0aW9uKSkpLGF2Z19hcHMsamh4LmdldE1lYW4oKS8xMDAwLjAsamh4LmdldFN0ZERldmlhdGlvbigpLzEwMDAuMCxzbXgubWluX3J0LGpoeC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5MC4wKS8xMDAwLjAsamh4LmdldFZhbHVlQXRQZXJjZW50aWxlKDk5LjApLzEwMDAuMCxzbXgubWF4X3J0LHNteC5tYXhfcnRfdHNbODpdLHNteC5hdmdfcXMsc214Lm1heF9xcyxzbXgubWF4X2F3dCxzbXgubWF4X3d0LGNwdV90LHNteC5jcHUsc214Lm1lbSkKICAgICAgICAgICAgaWYgbm90IHByaW50X2RldGFpbF9yb3dzOgogICAgICAgICAgICAgICAgaHRtbCA9IGh0bWwucmVwbGFjZSgiPGI+IiwiIikKICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvYj4iLCIiKQogICAgICAgICAgICAjIFJlbW92ZSB0YWcxCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcxPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMT4iLCIiKQogICAgICAgICAgICAjIFJlbW92ZSB0YWcyCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjx0YWcyPiIsIiIpCiAgICAgICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoIjwvdGFnMj4iLCIiKQoKICAgICAgICAgICAgcHJpbnRmKGh0bWwpCiAgICAgICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICAgICAgbmFtZTJzID0gbmFtZTJzX2xpc3RbMF0KICAgICAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQoKICAgICAgICAgICAgcGFnZV9pZCArPSAxCgogICAgcHJpbnRmKGhlYWRlci5yZXBsYWNlKCJfX0RFU0MxX18iLCBkZXNjMSkucmVwbGFjZSgiX19ERVNDMl9fIiwgZGVzYzIpKQoKICAgIHByZXZfcm93X2lkID0gMAogICAgZm9yIGUgaW4gcmI6CiAgICAgICAgY3VycmVudF9yb3dfaWQgPSBpbnQoZVsicm93X2lkIl0pCiAgICAgICAgaWYgY3VycmVudF9yb3dfaWQgPD0gcHJldl9yb3dfaWQ6CiAgICAgICAgICAgIGlmIHNtIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgICAgcHJpbnRfYWN0aW9uX3N1bW1hcnkoKQogICAgICAgICAgICAgICAgcHJpbnRfZ2xvYmFsX3N1bW1hcnkoKQogICAgICAgICAgICAgICAgcHJpbnRmKGJlbmNobWFya19lbXB0eV9yb3cpCiAgICAgICAgICAgICAgICBwcmludGYoYmVuY2htYXJrX2NvbHVtbnMpCiAgICAgICAgICAgIHNtID0gU3VtbWFyeSgpCiAgICAgICAgICAgIHNtLm5hbWUgPSBlWyJibV9uYW1lIl0KICAgICAgICAgICAgamgucmVzZXQoKQogICAgICAgICAgICBiZW5jaG1hcmtfaWQgKz0gMQogICAgICAgICAgICBqaGggPSB7fQogICAgICAgICAgICBqc3MgPSB7fQogICAgICAgICAgICBwcmludGYoYmVuY2htYXJrX2hlYWRlciUobmFtZV90b19ocmVmKGVbImJtX25hbWUiXSkpKQogICAgICAgICAgICBpZiBsZW4oZVsid29ya2Zsb3dfbmFtZSJdKSA+IDA6CiAgICAgICAgICAgICAgICBuYW1lMnNfbGlzdCA9IFsidTolZCwgdDolZCIlKGVbIm51bV91c2VycyJdLGVbIm51bV90aHJlYWRzIl0pLCAidzolcyIlKGVbIndvcmtmbG93X25hbWUiXSksICJjOiVkIiUoZVsiY29udGV4dF9pZCJdKSAsIiJdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lMnNfbGlzdCA9IFsidTolZCwgdDolZCIlKGVbIm51bV91c2VycyJdLGVbIm51bV90aHJlYWRzIl0pLCAiYzolZCIlKGVbImNvbnRleHRfaWQiXSksIiJdCiAgICAgICAgICAgIG5hbWUycyA9IG5hbWUyc19saXN0WzBdCiAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQogICAgICAgIGh0ID0gSGlzdG9ncmFtLmZyb21TdHJpbmcoZVsiaGlzdG9ncmFtX3J0Il0pCiAgICAgICAgamguYWRkKGh0KQogICAgICAgIHBfbWVtID0gMTAwLjAgKiBlWyJqdm1fbWVtb3J5X3VzZWQiXSAvIGVbImp2bV9tZW1vcnlfbWF4aW11bSJdCiAgICAgICAgcF9jcHUgPSBlWyJwcm9jZXNzX2NwdV91dGlsaXphdGlvbiJdCiAgICAgICAgaWYgZVsiYm1fbmFtZSJdIGluIFsib25TdGFydCIsICJvblN0b3AiXToKICAgICAgICAgICAgY3B1X3QgPSAiMDowMDowMCIKICAgICAgICAgICAgcF9jcHUgPSAwLjAKICAgICAgICBlbHNlOgogICAgICAgICAgICBjcHVfdCA9IHN0cl9mcm9tX2NwdV90aW1lX25zKGVbInByb2Nlc3NfY3B1X3RpbWVfbnMiXSkKICAgICAgICAgICAgcF9jcHUgPSBlWyJwcm9jZXNzX2NwdV91dGlsaXphdGlvbiJdCiAgICAgICAgaWYgcHJpbnRfZGV0YWlsX3Jvd3M6CiAgICAgICAgICAgIHByaW50ZihiZW5jaG1hcmtfZGV0YWlsX3JvdyUoIFwKICAgICAgICAgICAgICAgIG5hbWUycywKICAgICAgICAgICAgICAgIGVbInJvd19pZCJdKzEsCiAgICAgICAgICAgICAgICBlWyJudW1fYWN0aW9ucyJdLAogICAgICAgICAgICAgICAgZVsibnVtX2ZhaWxlZCJdLAogICAgICAgICAgICAgICAgc3RyKGRhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzPWludChlWyJkdXJhdGlvbiJdKSkpLAogICAgICAgICAgICAgICAgMC4wIGlmIGVbImJtX25hbWUiXSBpbiBbIm9uU3RhcnQiLCAib25TdG9wIl0gZWxzZSBlWyJhdmdfYXBzIl0sCiAgICAgICAgICAgICAgICBlWyJhdmdfcnQiXSwKICAgICAgICAgICAgICAgIGh0LmdldFN0ZERldmlhdGlvbigpLzEwMDAuMCwKICAgICAgICAgICAgICAgIGVbIm1pbl9ydCJdLAogICAgICAgICAgICAgICAgZVsicGVyY2VudGlsZXNfcnQiXVsiOTAuMCJdLAogICAgICAgICAgICAgICAgZVsicGVyY2VudGlsZXNfcnQiXVsiOTkuMCJdLAogICAgICAgICAgICAgICAgZVsibWF4X3J0Il0sCiAgICAgICAgICAgICAgICBlWyJtYXhfcnRfdHMiXVs4Ol0sCiAgICAgICAgICAgICAgICBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdLAogICAgICAgICAgICAgICAgZVsibWF4X3d0aHJlYWRfcXNpemUiXSwKICAgICAgICAgICAgICAgIGVbImF2Z193dCJdLAogICAgICAgICAgICAgICAgZVsibWF4X3d0Il0sCiAgICAgICAgICAgICAgICBjcHVfdCwKICAgICAgICAgICAgICAgIHBfY3B1LAogICAgICAgICAgICAgICAgcF9tZW0KICAgICAgICAgICAgICAgICkpCiAgICAgICAgICAgIGlmIGxlbihuYW1lMnNfbGlzdCkgPiAwOgogICAgICAgICAgICAgICAgbmFtZTJzID0gbmFtZTJzX2xpc3RbMF0KICAgICAgICAgICAgICAgIGRlbCBuYW1lMnNfbGlzdFswXQogICAgICAgIGlmIHNtLm1pbl9ydCA+IGVbIm1pbl9ydCJdOgogICAgICAgICAgICBzbS5taW5fcnQgPSBlWyJtaW5fcnQiXQogICAgICAgIGlmIHNtLm1heF9ydCA8IGVbIm1heF9ydCJdOgogICAgICAgICAgICBzbS5tYXhfcnQgPSBlWyJtYXhfcnQiXQogICAgICAgICAgICBzbS5tYXhfcnRfdHMgPSBlWyJtYXhfcnRfdHMiXQogICAgICAgIHNtLm51bV9hY3Rpb25zICs9IGVbIm51bV9hY3Rpb25zIl0KICAgICAgICBzbS5udW1fZmFpbGVkICs9IGVbIm51bV9mYWlsZWQiXQogICAgICAgIHNtLmR1cmF0aW9uICs9IGVbImR1cmF0aW9uIl0KICAgICAgICBpZiBzbS5hdmdfcXMgPCBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdOgogICAgICAgICAgICBzbS5hdmdfcXMgPSBlWyJhdmdfd3RocmVhZF9xc2l6ZSJdCiAgICAgICAgaWYgc20ubWF4X3FzIDwgZVsibWF4X3d0aHJlYWRfcXNpemUiXToKICAgICAgICAgICAgc20ubWF4X3FzID0gZVsibWF4X3d0aHJlYWRfcXNpemUiXQogICAgICAgIGlmIHNtLm1heF9hd3QgPCBlWyJhdmdfd3QiXToKICAgICAgICAgICAgc20ubWF4X2F3dCA9IGVbImF2Z193dCJdCiAgICAgICAgaWYgc20ubWF4X3d0IDwgZVsibWF4X3d0Il06CiAgICAgICAgICAgIHNtLm1heF93dCA9IGVbIm1heF93dCJdCiAgICAgICAgaWYgc20ubWVtIDwgcF9tZW06CiAgICAgICAgICAgIHNtLm1lbSA9IHBfbWVtCiAgICAgICAgaWYgc20uY3B1IDwgcF9jcHU6CiAgICAgICAgICAgIHNtLmNwdSA9IHBfY3B1CiAgICAgICAgc20uY3B1X3RpbWVfbnMgKz0gZVsicHJvY2Vzc19jcHVfdGltZV9ucyJdCgogICAgICAgIGlmIGxlbihzbS5jaGFydF90X2xpc3QpID09IC0xOgogICAgICAgICAgICBzbS5jaGFydF90X2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2JlZ2luIl0ucmVwbGFjZSgiXyIsICJUIikpLAogICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShlWyJhdmdfYXBzIl0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjNmIiUoZVsibnVtX2ZhaWxlZCJdL2VbImR1cmF0aW9uIl0pKQogICAgICAgICAgICBdKQoKICAgICAgICBzbS5jaGFydF90X2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2VuZCJdLnJlcGxhY2UoIl8iLCAiVCIpKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsiYXZnX2FwcyJdKSksCiAgICAgICAgICAgICAgICBmbG9hdCgiJS4zZiIlKGVbIm51bV9mYWlsZWQiXS9lWyJkdXJhdGlvbiJdKSkKICAgICAgICAgICAgIF0pCgogICAgICAgICMgWycyMDE4LTA0LTEwVDIwOjQwOjMzWicsIDEsIDUsIDEwLCAyMCwgMjUsIDMwIF0KICAgICAgICBpZiBsZW4oc20uY2hhcnRfcF9saXN0KSA9PSAtMToKICAgICAgICAgICAgc20uY2hhcnRfcF9saXN0LmFwcGVuZCgKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2JlZ2luIl0ucmVwbGFjZSgiXyIsICJUIikpLAogICAgICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWluX3J0Il0pKSwKICAgICAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGVbImF2Z19ydCJdKSksCiAgICAgICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShodC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5MC4wKS8xMDAwLjApKSwKICAgICAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGh0LmdldFZhbHVlQXRQZXJjZW50aWxlKDk1LjApLzEwMDAuMCkpLAogICAgICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoaHQuZ2V0VmFsdWVBdFBlcmNlbnRpbGUoOTkuMCkvMTAwMC4wKSksCiAgICAgICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShlWyJtYXhfcnQiXSkpCiAgICAgICAgICAgICAgICBdKQoKICAgICAgICBzbS5jaGFydF9wX2xpc3QuYXBwZW5kKAogICAgICAgICAgICBbCiAgICAgICAgICAgICAgICAnJXMnJShlWyJ0ZXN0X2VuZCJdLnJlcGxhY2UoIl8iLCAiVCIpKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWluX3J0Il0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsiYXZnX3J0Il0pKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoaHQuZ2V0VmFsdWVBdFBlcmNlbnRpbGUoOTAuMCkvMTAwMC4wKSksCiAgICAgICAgICAgICAgICBmbG9hdCgiJS4xZiIlKGh0LmdldFZhbHVlQXRQZXJjZW50aWxlKDk1LjApLzEwMDAuMCkpLAogICAgICAgICAgICAgICAgZmxvYXQoIiUuMWYiJShodC5nZXRWYWx1ZUF0UGVyY2VudGlsZSg5OS4wKS8xMDAwLjApKSwKICAgICAgICAgICAgICAgIGZsb2F0KCIlLjFmIiUoZVsibWF4X3J0Il0pKQogICAgICAgICAgICBdKQoKICAgICAgICAjIGpoaCAuLi4KICAgICAgICBmb3Iga2V5IGluIGVbInVzZXJfYWN0aW9ucyJdLmtleXMoKToKICAgICAgICAgICAgYXIgPSBlWyJ1c2VyX2FjdGlvbnMiXVtrZXldCiAgICAgICAgICAgIGh0dCA9IEhpc3RvZ3JhbS5mcm9tU3RyaW5nKGFyWyJoaXN0b2dyYW1fcnQiXSkKICAgICAgICAgICAgI3ByaW50KGFyWyJuYW1lIl0gKyAiIC0gIiArICIlLjNmIiUoaHR0LmdldE1lYW4oKS8xMDAwLjApKQogICAgICAgICAgICBpZiBqaGguaGFzX2tleShrZXkpOgogICAgICAgICAgICAgICAgamhoW2tleV0uYWRkKGh0dCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGpoaFtrZXldID0gSGlzdG9ncmFtKDEsIDM2MDAqMTAwMCoxMDAwLCAzKQogICAgICAgICAgICAgICAgamhoW2tleV0uYWRkKGh0dCkKICAgICAgICAgICAgI3ByaW50KGFyWyJuYW1lIl0gKyAiIC0gIiArICIlLjNmIiUoamhoW2tleV0uZ2V0TWVhbigpLzEwMDAuMCkgKyAiIC0gJWQiJShqaGhba2V5XS5nZXRUb3RhbENvdW50KCkpKQoKICAgICAgICAjIGpzcyAuLi4KICAgICAgICBmb3Iga2V5IGluIGVbInVzZXJfYWN0aW9ucyJdLmtleXMoKToKICAgICAgICAgICAgYXIgPSBlWyJ1c2VyX2FjdGlvbnMiXVtrZXldCiAgICAgICAgICAgIGlmIGpzcy5oYXNfa2V5KGtleSk6CiAgICAgICAgICAgICAgICBzbXggPSBqc3Nba2V5XQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc214ID0ganNzW2tleV0gPSBTdW1tYXJ5KCkKICAgICAgICAgICAgICAgIHNteC5uYW1lID0gZVsiYm1fbmFtZSJdCgogICAgICAgICAgICBpZiBzbXgubWluX3J0ID4gYXJbIm1pbl9ydCJdOgogICAgICAgICAgICAgICAgc214Lm1pbl9ydCA9IGFyWyJtaW5fcnQiXQogICAgICAgICAgICBpZiBzbXgubWF4X3J0IDwgYXJbIm1heF9ydCJdOgogICAgICAgICAgICAgICAgc214Lm1heF9ydCA9IGFyWyJtYXhfcnQiXQogICAgICAgICAgICAgICAgc214Lm1heF9ydF90cyA9IGFyWyJtYXhfcnRfdHMiXQogICAgICAgICAgICBzbXgubnVtX2FjdGlvbnMgKz0gYXJbIm51bV9hY3Rpb25zIl0KICAgICAgICAgICAgc214Lm51bV9mYWlsZWQgKz0gYXJbIm51bV9mYWlsZWQiXQoKICAgICAgICAgICAgc214LmR1cmF0aW9uICs9IGVbImR1cmF0aW9uIl0KICAgICAgICAgICAgaWYgc214LmF2Z19xcyA8IGVbImF2Z193dGhyZWFkX3FzaXplIl06CiAgICAgICAgICAgICAgICBzbXguYXZnX3FzID0gZVsiYXZnX3d0aHJlYWRfcXNpemUiXQogICAgICAgICAgICBpZiBzbXgubWF4X3FzIDwgZVsibWF4X3d0aHJlYWRfcXNpemUiXToKICAgICAgICAgICAgICAgIHNteC5tYXhfcXMgPSBlWyJtYXhfd3RocmVhZF9xc2l6ZSJdCiAgICAgICAgICAgIGlmIHNteC5tYXhfYXd0IDwgZVsiYXZnX3d0Il06CiAgICAgICAgICAgICAgICBzbXgubWF4X2F3dCA9IGVbImF2Z193dCJdCiAgICAgICAgICAgIGlmIHNteC5tYXhfd3QgPCBlWyJtYXhfd3QiXToKICAgICAgICAgICAgICAgIHNteC5tYXhfd3QgPSBlWyJtYXhfd3QiXQogICAgICAgICAgICBpZiBzbXgubWVtIDwgcF9tZW06CiAgICAgICAgICAgICAgICBzbXgubWVtID0gcF9tZW0KICAgICAgICAgICAgaWYgc214LmNwdSA8IHBfY3B1OgogICAgICAgICAgICAgICAgc214LmNwdSA9IHBfY3B1CiAgICAgICAgICAgIHNteC5jcHVfdGltZV9ucyArPSBlWyJwcm9jZXNzX2NwdV90aW1lX25zIl0KCiAgICBwcmludF9hY3Rpb25fc3VtbWFyeSgpCiAgICBwcmludF9nbG9iYWxfc3VtbWFyeSgpCiAgICBwcmludGYodHJhaWxlcikKCiAgICByZXBvcnRfZmguY2xvc2UoKQoKICAgIG9zLmNoZGlyKGN3ZCkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBpZiBsZW4oc3lzLmFyZ3YpID49IDM6CiAgICAgICAgZmlsZW5hbWUgPSBzeXMuYXJndlsxXQogICAgICAgIGNvbmZpZ0ZpbGVuYW1lID0gc3lzLmFyZ3ZbMl0KICAgICAgICBjcmVhdGVSZXBvcnQoZmlsZW5hbWUsIGNvbmZpZ0ZpbGVuYW1lKQo=";

    public static void main(String... args) {
        String mainScriptFilename = "report.py";
        String mainScript = "";
        String pythonArgsScript = "";
        for (String arg : args) {
            if (pythonArgsScript.length() == 0) {
                if (!arg.equals(mainScriptFilename)) {
                    pythonArgsScript += "'" + mainScriptFilename + "', ";
                }
            } else {
                pythonArgsScript += ", ";
            }
            pythonArgsScript += "'" + arg + "'";
        }
        if (pythonArgsScript.length() == 0) {
            pythonArgsScript = "'" + mainScriptFilename + "'";
        }
        pythonArgsScript = "import sys; sys.argv = [" + pythonArgsScript + "]";
        {
            byte[] decodedBytes = Base64.getDecoder().decode(mainScriptTextBase64);
            String text = new String(decodedBytes);
            mainScript = text;
        }
        {
            // create Python interpreter object
            PythonInterpreter pyInterp = new PythonInterpreter();
            // initialize command-line args
            pyInterp.exec(pythonArgsScript);
            // run script
            pyInterp.exec(mainScript);
        }
    }
}
